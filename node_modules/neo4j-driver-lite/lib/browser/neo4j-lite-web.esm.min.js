var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var lib$2={},version$1={},logging=(Object.defineProperty(version$1,"__esModule",{value:!0}),version$1.default="5.26.0",{}),lib$1=(Object.defineProperty(logging,"__esModule",{value:!0}),logging.logging=void 0,logging.logging={console:function(e){return{level:e,logger:function(e,t){return console.log("".concat(Date.now()," ").concat(e.toUpperCase()," ").concat(t))}}}},{}),error={},json$3={},objectUtil$2={},__isBrokenObject__=(Object.defineProperty(objectUtil$2,"__esModule",{value:!0}),objectUtil$2.getBrokenObjectReason=objectUtil$2.isBrokenObject=objectUtil$2.createBrokenObject=void 0,"__isBrokenObject__"),__reason__="__reason__";function createBrokenObject(r,e){void 0===e&&(e={});function o(){throw r}return new Proxy(e,{get:function(e,t){return t===__isBrokenObject__||(t===__reason__?r:void("toJSON"!==t&&o()))},set:o,apply:o,construct:o,defineProperty:o,deleteProperty:o,getOwnPropertyDescriptor:o,getPrototypeOf:o,has:o,isExtensible:o,ownKeys:o,preventExtensions:o,setPrototypeOf:o})}function isBrokenObject(e){return null!==e&&"object"==typeof e&&!0===e[__isBrokenObject__]}function getBrokenObjectReason(e){return e[__reason__]}objectUtil$2.createBrokenObject=createBrokenObject,objectUtil$2.isBrokenObject=isBrokenObject,objectUtil$2.getBrokenObjectReason=getBrokenObjectReason,Object.defineProperty(json$3,"__esModule",{value:!0}),json$3.stringify=void 0;var object_util_1=objectUtil$2;function stringify(e,r){return JSON.stringify(e,function(e,t){return(0,object_util_1.isBrokenObject)(t)?{__isBrokenObject__:!0,__reason__:(0,object_util_1.getBrokenObjectReason)(t)}:"bigint"==typeof t?"".concat(t,"n"):!0!==(null==r?void 0:r.useCustomToString)||"object"!=typeof t||Array.isArray(t)||"function"!=typeof t.toString||t.toString===Object.prototype.toString?t:null==t?void 0:t.toString()})}json$3.stringify=stringify;var gqlConstants={},__extends$A=(!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.rawPolyfilledDiagnosticRecord=void 0,e.rawPolyfilledDiagnosticRecord={OPERATION:"",OPERATION_CODE:"0",CURRENT_SCHEMA:"/"},Object.freeze(e.rawPolyfilledDiagnosticRecord)}(gqlConstants),commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}()),__createBinding$d=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&("get"in n?t.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){e[o=void 0===o?r:o]=t[r]}),__setModuleDefault$d=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar$d=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding$d(t,e,r);return __setModuleDefault$d(t,e),t},json$2=(Object.defineProperty(error,"__esModule",{value:!0}),error.PROTOCOL_ERROR=error.SESSION_EXPIRED=error.SERVICE_UNAVAILABLE=error.GQLError=error.Neo4jError=error.isRetriableError=error.newGQLError=error.newError=void 0,__importStar$d(json$3)),gql_constants_1$1=gqlConstants,errorClassification={DATABASE_ERROR:"DATABASE_ERROR",CLIENT_ERROR:"CLIENT_ERROR",TRANSIENT_ERROR:"TRANSIENT_ERROR",UNKNOWN:"UNKNOWN"},classifications=(Object.freeze(errorClassification),Object.values(errorClassification)),SERVICE_UNAVAILABLE$5="ServiceUnavailable",SESSION_EXPIRED$2=(error.SERVICE_UNAVAILABLE=SERVICE_UNAVAILABLE$5,"SessionExpired"),PROTOCOL_ERROR$6=(error.SESSION_EXPIRED=SESSION_EXPIRED$2,"ProtocolError"),NOT_AVAILABLE$1=(error.PROTOCOL_ERROR=PROTOCOL_ERROR$6,"N/A"),GQLError=function(a){function s(e,t,r,o,n){var i=this;return(i=a.call(this,e,null!=n?{cause:n}:void 0)||this).constructor=s,i.__proto__=s.prototype,i.cause=null!=n?n:void 0,i.gqlStatus=t,i.gqlStatusDescription=r,i.diagnosticRecord=o,i.classification=_extractClassification(i.diagnosticRecord),i.rawClassification=null!=(e=null==o?void 0:o._classification)?e:void 0,i.name="GQLError",i}return __extends$A(s,a),Object.defineProperty(s.prototype,"diagnosticRecordAsJsonString",{get:function(){return json$2.stringify(this.diagnosticRecord,{useCustomToString:!0})},enumerable:!1,configurable:!0}),s}(Error),Neo4jError=function(a){function s(e,t,r,o,n,i){e=a.call(this,e,r,o,n,i)||this;return e.constructor=s,e.__proto__=s.prototype,e.code=t,e.name="Neo4jError",e.retriable=_isRetriableCode(t),e}return __extends$A(s,a),s.isRetriable=function(e){return null!=e&&e instanceof s&&e.retriable},s}(error.GQLError=GQLError);function newError(e,t,r,o,n,i){return new Neo4jError(e,null!=t?t:NOT_AVAILABLE$1,null!=o?o:"50N42",null!=n?n:"error: general processing exception - unexpected error. "+e,null!=i?i:gql_constants_1$1.rawPolyfilledDiagnosticRecord,r)}function newGQLError(e,t,r,o,n){return new GQLError(e,null!=r?r:"50N42",null!=o?o:"error: general processing exception - unexpected error. "+e,null!=n?n:gql_constants_1$1.rawPolyfilledDiagnosticRecord,t)}error.Neo4jError=Neo4jError,error.newError=newError,error.newGQLError=newGQLError;var isRetriableError=Neo4jError.isRetriable;function _isRetriableCode(e){return e===SERVICE_UNAVAILABLE$5||e===SESSION_EXPIRED$2||_isAuthorizationExpired(e)||_isTransientError(e)}function _isTransientError(e){return!0===(null==e?void 0:e.includes("TransientError"))}function _isAuthorizationExpired(e){return"Neo.ClientError.Security.AuthorizationExpired"===e}function _extractClassification(e){return void 0!==e&&void 0!==e._classification&&classifications.includes(e._classification)?null==e?void 0:e._classification:"UNKNOWN"}error.isRetriableError=isRetriableError;var integer={},error_1$c=(Object.defineProperty(integer,"__esModule",{value:!0}),integer.toString=integer.toNumber=integer.inSafeRange=integer.isInt=integer.int=void 0,error),INT_CACHE=new Map,Integer=function(){function f(e,t){this.low=null!=e?e:0,this.high=null!=t?t:0}return f.prototype.inSafeRange=function(){return this.greaterThanOrEqual(f.MIN_SAFE_VALUE)&&this.lessThanOrEqual(f.MAX_SAFE_VALUE)},f.prototype.toInt=function(){return this.low},f.prototype.toNumber=function(){return this.high*TWO_PWR_32_DBL+(this.low>>>0)},f.prototype.toBigInt=function(){var e;return this.isZero()?BigInt(0):this.isPositive()?BigInt(this.high>>>0)*BigInt(TWO_PWR_32_DBL)+BigInt(this.low>>>0):(e=this.negate(),BigInt(-1)*(BigInt(e.high>>>0)*BigInt(TWO_PWR_32_DBL)+BigInt(e.low>>>0)))},f.prototype.toNumberOrInfinity=function(){return this.lessThan(f.MIN_SAFE_VALUE)?Number.NEGATIVE_INFINITY:this.greaterThan(f.MAX_SAFE_VALUE)?Number.POSITIVE_INFINITY:this.toNumber()},f.prototype.toString=function(e){if((e=null!=e?e:10)<2||36<e)throw RangeError("radix out of range: "+e.toString());if(this.isZero())return"0";var t,r,o;if(this.isNegative())return this.equals(f.MIN_VALUE)?(t=f.fromNumber(e),o=(r=this.div(t)).multiply(t).subtract(this),r.toString(e)+o.toInt().toString(e)):"-"+this.negate().toString(e);for(var n=f.fromNumber(Math.pow(e,6)),i=(o=this,"");;){var a=o.div(n),s=(o.subtract(a.multiply(n)).toInt()>>>0).toString(e);if((o=a).isZero())return s+i;for(;s.length<6;)s="0"+s;i=""+s+i}},f.prototype.valueOf=function(){return this.toBigInt()},f.prototype.getHighBits=function(){return this.high},f.prototype.getLowBits=function(){return this.low},f.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.equals(f.MIN_VALUE)?64:this.negate().getNumBitsAbs();for(var e=0!==this.high?this.high:this.low,t=0,t=31;0<t&&0==(e&1<<t);t--);return 0!==this.high?t+33:t+1},f.prototype.isZero=function(){return 0===this.high&&0===this.low},f.prototype.isNegative=function(){return this.high<0},f.prototype.isPositive=function(){return 0<=this.high},f.prototype.isOdd=function(){return 1==(1&this.low)},f.prototype.isEven=function(){return 0==(1&this.low)},f.prototype.equals=function(e){e=f.fromValue(e);return this.high===e.high&&this.low===e.low},f.prototype.notEquals=function(e){return!this.equals(e)},f.prototype.lessThan=function(e){return this.compare(e)<0},f.prototype.lessThanOrEqual=function(e){return this.compare(e)<=0},f.prototype.greaterThan=function(e){return 0<this.compare(e)},f.prototype.greaterThanOrEqual=function(e){return 0<=this.compare(e)},f.prototype.compare=function(e){var t,r,e=f.fromValue(e);return this.equals(e)?0:(t=this.isNegative(),r=e.isNegative(),t&&!r||(t||!r)&&this.subtract(e).isNegative()?-1:1)},f.prototype.negate=function(){return this.equals(f.MIN_VALUE)?f.MIN_VALUE:this.not().add(f.ONE)},f.prototype.add=function(e){var e=f.fromValue(e),t=this.high>>>16,r=65535&this.high,o=this.low>>>16,n=65535&this.low,i=e.high>>>16,a=65535&e.high,s=e.low>>>16,u=0,c=0,l=0,_=0;return c+=(l=l+((_+=n+(65535&e.low))>>>16)+(o+s))>>>16,f.fromBits((l&=65535)<<16|(_&=65535),((u+=(c+=r+a)>>>16)+(t+i)&65535)<<16|(c&=65535))},f.prototype.subtract=function(e){e=f.fromValue(e);return this.add(e.negate())},f.prototype.multiply=function(e){var t,r,o,n,i,a,s,u,c,l,_;return this.isZero()||(e=f.fromValue(e)).isZero()?f.ZERO:this.equals(f.MIN_VALUE)?e.isOdd()?f.MIN_VALUE:f.ZERO:e.equals(f.MIN_VALUE)?this.isOdd()?f.MIN_VALUE:f.ZERO:this.isNegative()?e.isNegative()?this.negate().multiply(e.negate()):this.negate().multiply(e).negate():e.isNegative()?this.multiply(e.negate()).negate():this.lessThan(TWO_PWR_24)&&e.lessThan(TWO_PWR_24)?f.fromNumber(this.toNumber()*e.toNumber()):(t=this.high>>>16,r=65535&this.high,o=this.low>>>16,n=65535&this.low,i=e.high>>>16,a=65535&e.high,s=e.low>>>16,_=(_=l=c=u=0)+((c=c+((l+=n*(e=65535&e.low))>>>16)+o*e)>>>16)+((c=(c&65535)+n*s)>>>16),f.fromBits((c&=65535)<<16|(l&=65535),(u=(u=(u+=(_+=r*e)>>>16)+((_=(_&65535)+o*s)>>>16)+((_=(_&65535)+n*a)>>>16))+(t*e+r*s+o*a+n*i)&65535)<<16|(_&=65535)))},f.prototype.div=function(e){var t,r,o,n=f.fromValue(e);if(n.isZero())throw(0,error_1$c.newError)("division by zero");if(this.isZero())return f.ZERO;if(this.equals(f.MIN_VALUE))return n.equals(f.ONE)||n.equals(f.NEG_ONE)?f.MIN_VALUE:n.equals(f.MIN_VALUE)?f.ONE:(o=this.shiftRight(1).div(n).shiftLeft(1)).equals(f.ZERO)?n.isNegative()?f.ONE:f.NEG_ONE:(t=this.subtract(n.multiply(o)),o.add(t.div(n)));if(n.equals(f.MIN_VALUE))return f.ZERO;if(this.isNegative())return n.isNegative()?this.negate().div(n.negate()):this.negate().div(n).negate();if(n.isNegative())return this.div(n.negate()).negate();for(r=f.ZERO,t=this;t.greaterThanOrEqual(n);){o=Math.max(1,Math.floor(t.toNumber()/n.toNumber()));for(var i=Math.ceil(Math.log(o)/Math.LN2),a=i<=48?1:Math.pow(2,i-48),s=f.fromNumber(o),u=s.multiply(n);u.isNegative()||u.greaterThan(t);)u=(s=f.fromNumber(o-=a)).multiply(n);s.isZero()&&(s=f.ONE),r=r.add(s),t=t.subtract(u)}return r},f.prototype.modulo=function(e){e=f.fromValue(e);return this.subtract(this.div(e).multiply(e))},f.prototype.not=function(){return f.fromBits(~this.low,~this.high)},f.prototype.and=function(e){e=f.fromValue(e);return f.fromBits(this.low&e.low,this.high&e.high)},f.prototype.or=function(e){e=f.fromValue(e);return f.fromBits(this.low|e.low,this.high|e.high)},f.prototype.xor=function(e){e=f.fromValue(e);return f.fromBits(this.low^e.low,this.high^e.high)},f.prototype.shiftLeft=function(e){e=f.toNumber(e);return 0==(e&=63)?f.ZERO:e<32?f.fromBits(this.low<<e,this.high<<e|this.low>>>32-e):f.fromBits(0,this.low<<e-32)},f.prototype.shiftRight=function(e){var t=f.toNumber(e),e=f.toNumber(e);return 0==(t&=63)?f.ZERO:e<32?f.fromBits(this.low>>>t|this.high<<32-t,this.high>>t):f.fromBits(this.high>>t-32,0<=this.high?0:-1)},f.isInteger=function(e){return!0===(null==e?void 0:e.__isInteger__)},f.fromInt=function(e){var t;return-128<=(e|=0)&&e<128&&null!=(t=INT_CACHE.get(e))||(t=new f(e,e<0?-1:0),-128<=e&&e<128&&INT_CACHE.set(e,t)),t},f.fromBits=function(e,t){return new f(e,t)},f.fromNumber=function(e){return isNaN(e)||!isFinite(e)?f.ZERO:e<=-TWO_PWR_63_DBL?f.MIN_VALUE:TWO_PWR_63_DBL<=e+1?f.MAX_VALUE:e<0?f.fromNumber(-e).negate():new f(e%TWO_PWR_32_DBL|0,e/TWO_PWR_32_DBL|0)},f.fromString=function(e,t,r){var o=(void 0===r?{}:r).strictStringValidation;if(0===e.length)throw(0,error_1$c.newError)("number format error: empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return f.ZERO;if((t=null!=t?t:10)<2||36<t)throw(0,error_1$c.newError)("radix out of range: "+t.toString());if(0<(r=e.indexOf("-")))throw(0,error_1$c.newError)('number format error: interior "-" character: '+e);if(0===r)return f.fromString(e.substring(1),t).negate();for(var n=f.fromNumber(Math.pow(t,8)),i=f.ZERO,a=0;a<e.length;a+=8){var s=Math.min(8,e.length-a),u=e.substring(a,a+s),c=parseInt(u,t);if(!0===o&&!_isValidNumberFromString(u,c,t))throw(0,error_1$c.newError)('number format error: "'.concat(u,'" is NaN in radix ').concat(t,": ").concat(e));i=(s<8?(u=f.fromNumber(Math.pow(t,s)),i.multiply(u)):i=i.multiply(n)).add(f.fromNumber(c))}return i},f.fromValue=function(e,t){return void 0===t&&(t={}),e instanceof f?e:"number"==typeof e?(!0===t.ceilFloat&&(e=Math.ceil(e)),f.fromNumber(e)):"string"==typeof e?f.fromString(e,void 0,t):"bigint"==typeof e?f.fromString(e.toString()):new f(e.low,e.high)},f.toNumber=function(e){switch(typeof e){case"number":return e;case"bigint":return Number(e);default:return f.fromValue(e).toNumber()}},f.toString=function(e,t){return f.fromValue(e).toString(t)},f.inSafeRange=function(e){return f.fromValue(e).inSafeRange()},f.ZERO=f.fromInt(0),f.ONE=f.fromInt(1),f.NEG_ONE=f.fromInt(-1),f.MAX_VALUE=f.fromBits(-1,2147483647),f.MIN_VALUE=f.fromBits(0,-2147483648),f.MIN_SAFE_VALUE=f.fromBits(1,-2097152),f.MAX_SAFE_VALUE=f.fromBits(-1,2097151),f.__isInteger__=!0,f}();function _convertNumberToString(e,t,r){e=e.toString(t),t=Math.max(r-e.length,0),r="0".repeat(t);return"".concat(r).concat(e)}function _isValidNumberFromString(e,t,r){return!Number.isNaN(e)&&!Number.isNaN(t)&&_convertNumberToString(t,r,e.length)===e.toLowerCase()}Object.defineProperty(Integer.prototype,"__isInteger__",{value:!0,enumerable:!1,configurable:!1});var TWO_PWR_16_DBL=65536,TWO_PWR_24_DBL=1<<24,TWO_PWR_32_DBL=TWO_PWR_16_DBL*TWO_PWR_16_DBL,TWO_PWR_64_DBL=TWO_PWR_32_DBL*TWO_PWR_32_DBL,TWO_PWR_63_DBL=TWO_PWR_64_DBL/2,TWO_PWR_24=Integer.fromInt(TWO_PWR_24_DBL),int=Integer.fromValue,isInt=(integer.int=int,Integer.isInteger),inSafeRange=(integer.isInt=isInt,Integer.inSafeRange),toNumber$1=(integer.inSafeRange=inSafeRange,Integer.toNumber),toString=(integer.toNumber=toNumber$1,Integer.toString),temporalTypes=(integer.toString=toString,integer.default=Integer,{}),temporalUtil$1={},util$4={},__createBinding$c=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&("get"in n?t.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){e[o=void 0===o?r:o]=t[r]}),__setModuleDefault$c=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar$c=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding$c(t,e,r);return __setModuleDefault$c(t,e),t},__values$4=commonjsGlobal&&commonjsGlobal.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],o=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&o>=e.length?void 0:e)&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},integer_1$2=(Object.defineProperty(util$4,"__esModule",{value:!0}),util$4.ENCRYPTION_OFF=util$4.ENCRYPTION_ON=util$4.equals=util$4.validateQueryAndParameters=util$4.toNumber=util$4.assertValidDate=util$4.assertNumberOrInteger=util$4.assertNumber=util$4.assertString=util$4.assertObject=util$4.isString=util$4.isObject=util$4.isEmptyObjectOrNull=void 0,__importStar$c(integer)),json_1$1=json$3,ENCRYPTION_ON$2="ENCRYPTION_ON",ENCRYPTION_OFF$2=(util$4.ENCRYPTION_ON=ENCRYPTION_ON$2,"ENCRYPTION_OFF");function isEmptyObjectOrNull(e){if(null!==e){if(!isObject(e))return!1;for(var t in e)if(void 0!==e[t])return!1}return!0}function isObject(e){return"object"==typeof e&&!Array.isArray(e)&&null!==e}function validateQueryAndParameters(e,t,r){var o="",t=null!=t?t:{},r=null!=(r=null==r?void 0:r.skipAsserts)&&r;return"string"==typeof e?o=e:e instanceof String?o=e.toString():"object"==typeof e&&null!=e.text&&(o=e.text,t=null!=(e=e.parameters)?e:{}),r||(assertCypherQuery(o),assertQueryParameters(t)),{validatedQuery:o,params:t}}function assertObject(e,t){if(isObject(e))return e;throw new TypeError(t+" expected to be an object but was: "+(0,json_1$1.stringify)(e))}function assertString$1(e,t){if(isString$1(e))return e;throw new TypeError((0,json_1$1.stringify)(t)+" expected to be string but was: "+(0,json_1$1.stringify)(e))}function assertNumber(e,t){if("number"!=typeof e)throw new TypeError(t+" expected to be a number but was: "+(0,json_1$1.stringify)(e));return e}function assertNumberOrInteger(e,t){if("number"==typeof e||"bigint"==typeof e||(0,integer_1$2.isInt)(e))return e;throw new TypeError(t+" expected to be either a number or an Integer object but was: "+(0,json_1$1.stringify)(e))}function assertValidDate(e,t){if("[object Date]"!==Object.prototype.toString.call(e))throw new TypeError(t+" expected to be a standard JavaScript Date but was: "+(0,json_1$1.stringify)(e));if(Number.isNaN(e.getTime()))throw new TypeError(t+" expected to be valid JavaScript Date but its time was NaN: "+(0,json_1$1.stringify)(e));return e}function assertCypherQuery(e){if(assertString$1(e,"Cypher query"),0===e.trim().length)throw new TypeError("Cypher query is expected to be a non-empty string.")}function assertQueryParameters(e){var t;if(!isObject(e))throw t=null!=e.constructor?" "+e.constructor.name:"",new TypeError("Query parameters are expected to either be undefined/null or an object, given:".concat(t," ").concat(JSON.stringify(e)))}function isString$1(e){return"[object String]"===Object.prototype.toString.call(e)}function equals$1(e,t){var r,o;if(e!==t){if(null===e||null===t)return!1;if("object"!=typeof e||"object"!=typeof t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;try{for(var a=__values$4(n),s=a.next();!s.done;s=a.next()){var u=s.value;if(!equals$1(e[u],t[u]))return!1}}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}}return!0}function toNumber(e){return e instanceof integer_1$2.default?e.toNumber():"bigint"==typeof e?(0,integer_1$2.int)(e).toNumber():e}util$4.ENCRYPTION_OFF=ENCRYPTION_OFF$2,util$4.isEmptyObjectOrNull=isEmptyObjectOrNull,util$4.isObject=isObject,util$4.validateQueryAndParameters=validateQueryAndParameters,util$4.assertObject=assertObject,util$4.assertString=assertString$1,util$4.assertNumber=assertNumber,util$4.assertNumberOrInteger=assertNumberOrInteger,util$4.assertValidDate=assertValidDate,util$4.isString=isString$1,util$4.equals=equals$1,util$4.toNumber=toNumber,function(s){var o=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&("get"in n?t.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){e[o=void 0===o?r:o]=t[r]}),n=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),e=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&o(t,e,r);return n(t,e),t},u=(Object.defineProperty(s,"__esModule",{value:!0}),s.floorMod=s.floorDiv=s.assertValidZoneId=s.assertValidNanosecond=s.assertValidSecond=s.assertValidMinute=s.assertValidHour=s.assertValidDay=s.assertValidMonth=s.assertValidYear=s.timeZoneOffsetInSeconds=s.totalNanoseconds=s.newDate=s.toStandardDate=s.isoStringToStandardDate=s.dateToIsoString=s.timeZoneOffsetToIsoString=s.timeToIsoString=s.durationToIsoString=s.dateToEpochDay=s.localDateTimeToEpochSecond=s.localTimeToNanoOfDay=s.normalizeNanosecondsForDuration=s.normalizeSecondsForDuration=s.SECONDS_PER_DAY=s.DAYS_PER_400_YEAR_CYCLE=s.DAYS_0000_TO_1970=s.NANOS_PER_HOUR=s.NANOS_PER_MINUTE=s.NANOS_PER_MILLISECOND=s.NANOS_PER_SECOND=s.SECONDS_PER_HOUR=s.SECONDS_PER_MINUTE=s.MINUTES_PER_HOUR=s.NANOSECOND_OF_SECOND_RANGE=s.SECOND_OF_MINUTE_RANGE=s.MINUTE_OF_HOUR_RANGE=s.HOUR_OF_DAY_RANGE=s.DAY_OF_MONTH_RANGE=s.MONTH_OF_YEAR_RANGE=s.YEAR_RANGE=void 0,e(integer)),i=error,a=util$4,e=(t.prototype.contains=function(e){var t;return(0,u.isInt)(e)&&e instanceof u.default?e.greaterThanOrEqual(this._minInteger)&&e.lessThanOrEqual(this._maxInteger):"bigint"==typeof e?(t=(0,u.int)(e)).greaterThanOrEqual(this._minInteger)&&t.lessThanOrEqual(this._maxInteger):e>=this._minNumber&&e<=this._maxNumber},t.prototype.toString=function(){return"[".concat(this._minNumber,", ").concat(this._maxNumber,"]")},t);function t(e,t){this._minNumber=e,this._maxNumber=t,this._minInteger=(0,u.int)(e),this._maxInteger=(0,u.int)(t)}function c(e,t,r){e=(0,u.int)(e),t=(0,u.int)(t),r=(0,u.int)(r);var o=e.multiply(365);return o=(o=(o=e.greaterThanOrEqual(0)?o.add(e.add(3).div(4).subtract(e.add(99).div(100)).add(e.add(399).div(400))):o.subtract(e.div(-4).subtract(e.div(-100)).add(e.div(-400)))).add(t.multiply(367).subtract(362).div(12))).add(r.subtract(1)),(o=t.greaterThan(2)&&(o=o.subtract(1),!function(e){if((e=(0,u.int)(e)).modulo(4).equals(0)){if(e.modulo(100).equals(0))return!!e.modulo(400).equals(0);return 1}}(e))?o.subtract(1):o).subtract(s.DAYS_0000_TO_1970)}s.YEAR_RANGE=new e(-999999999,999999999),s.MONTH_OF_YEAR_RANGE=new e(1,12),s.DAY_OF_MONTH_RANGE=new e(1,31),s.HOUR_OF_DAY_RANGE=new e(0,23),s.MINUTE_OF_HOUR_RANGE=new e(0,59),s.SECOND_OF_MINUTE_RANGE=new e(0,59),s.NANOSECOND_OF_SECOND_RANGE=new e(0,999999999),s.MINUTES_PER_HOUR=60,s.SECONDS_PER_MINUTE=60,s.SECONDS_PER_HOUR=s.SECONDS_PER_MINUTE*s.MINUTES_PER_HOUR,s.NANOS_PER_SECOND=1e9,s.NANOS_PER_MILLISECOND=1e6,s.NANOS_PER_MINUTE=s.NANOS_PER_SECOND*s.SECONDS_PER_MINUTE,s.NANOS_PER_HOUR=s.NANOS_PER_MINUTE*s.MINUTES_PER_HOUR,s.DAYS_0000_TO_1970=719528,s.DAYS_PER_400_YEAR_CYCLE=146097,s.SECONDS_PER_DAY=86400,s.normalizeSecondsForDuration=function(e,t){return(0,u.int)(e).add(f(t,s.NANOS_PER_SECOND))},s.normalizeNanosecondsForDuration=function(e){return d(e,s.NANOS_PER_SECOND)},s.localTimeToNanoOfDay=function(e,t,r,o){return e=(0,u.int)(e),t=(0,u.int)(t),r=(0,u.int)(r),o=(0,u.int)(o),(e=(e=(e=e.multiply(s.NANOS_PER_HOUR)).add(t.multiply(s.NANOS_PER_MINUTE))).add(r.multiply(s.NANOS_PER_SECOND))).add(o)},s.localDateTimeToEpochSecond=function(e,t,r,o,n,i,a){return e=c(e,t,r),t=function(e,t,r){e=(0,u.int)(e),t=(0,u.int)(t),r=(0,u.int)(r);e=e.multiply(s.SECONDS_PER_HOUR);return(e=e.add(t.multiply(s.SECONDS_PER_MINUTE))).add(r)}(o,n,i),e.multiply(s.SECONDS_PER_DAY).add(t)},s.dateToEpochDay=c,s.durationToIsoString=function(e,t,r,o){return e=h(e),t=h(t),r=function(e,t){e=(0,u.int)(e),t=(0,u.int)(t);var r,o=e.isNegative(),n=t.greaterThan(0);e=o&&n?e.equals(-1)?"-0":e.add(1).toString():e.toString();n&&(r=p((o?t.negate().add(2*s.NANOS_PER_SECOND):t.add(s.NANOS_PER_SECOND)).modulo(s.NANOS_PER_SECOND)));return null!=r?e+r:e}(r,o),"P".concat(e,"M").concat(t,"DT").concat(r,"S")},s.timeToIsoString=function(e,t,r,o){return e=h(e,2),t=h(t,2),r=h(r,2),o=p(o),"".concat(e,":").concat(t,":").concat(r).concat(o)},s.timeZoneOffsetToIsoString=function(e){var t,r,o;return(e=(0,u.int)(e)).equals(0)?"Z":(t=(r=e.isNegative())?"-":"+",r=h((e=r?e.multiply(-1):e).div(s.SECONDS_PER_HOUR),2),o=h(e.div(s.SECONDS_PER_MINUTE).modulo(s.MINUTES_PER_HOUR),2),null!=(e=(e=e.modulo(s.SECONDS_PER_MINUTE)).equals(0)?null:h(e,2))?"".concat(t).concat(r,":").concat(o,":").concat(e):"".concat(t).concat(r,":").concat(o))},s.dateToIsoString=function(e,t,r){return e=function(e){e=(0,u.int)(e);if(e.isNegative()||e.greaterThan(9999))return h(e,6,{usePositiveSign:!0});return h(e,4)}(e),t=h(t,2),r=h(r,2),"".concat(e,"-").concat(t,"-").concat(r)},s.isoStringToStandardDate=function(e){return new Date(e)},s.toStandardDate=function(e){return new Date(e)},s.newDate=function(e){return new Date(e)},s.totalNanoseconds=function(e,t){return t=null!=t?t:0,e=e.getMilliseconds()*s.NANOS_PER_MILLISECOND,t instanceof u.default?t.add(e):"bigint"==typeof t?t+BigInt(e):t+e},s.timeZoneOffsetInSeconds=function(e){var t=e.getSeconds()>=e.getUTCSeconds()?e.getSeconds()-e.getUTCSeconds():e.getSeconds()-e.getUTCSeconds()+60;return 0===(e=e.getTimezoneOffset())?0+t:-1*e*s.SECONDS_PER_MINUTE+t},s.assertValidYear=function(e){return r(e,s.YEAR_RANGE,"Year")},s.assertValidMonth=function(e){return r(e,s.MONTH_OF_YEAR_RANGE,"Month")},s.assertValidDay=function(e){return r(e,s.DAY_OF_MONTH_RANGE,"Day")},s.assertValidHour=function(e){return r(e,s.HOUR_OF_DAY_RANGE,"Hour")},s.assertValidMinute=function(e){return r(e,s.MINUTE_OF_HOUR_RANGE,"Minute")},s.assertValidSecond=function(e){return r(e,s.SECOND_OF_MINUTE_RANGE,"Second")},s.assertValidNanosecond=function(e){return r(e,s.NANOSECOND_OF_SECOND_RANGE,"Nanosecond")};function l(e,t){return(0,i.newError)("".concat(t,' is expected to be a valid ZoneId but was: "').concat(e,'"'))}var _=new Map;function r(e,t,r){if((0,a.assertNumberOrInteger)(e,r),t.contains(e))return e;throw(0,i.newError)("".concat(r," is expected to be in range ").concat(t.toString()," but was: ").concat(e.toString()))}function f(e,t){e=(0,u.int)(e),t=(0,u.int)(t);var r=e.div(t);return r=e.isPositive()!==t.isPositive()&&r.multiply(t).notEquals(e)?r.subtract(1):r}function d(e,t){return e=(0,u.int)(e),t=(0,u.int)(t),e.subtract(f(e,t).multiply(t))}function p(e){return(e=(0,u.int)(e)).equals(0)?"":"."+h(e,9)}function h(e,t,r){var o=(e=(0,u.int)(e)).isNegative(),n=(e=o?e.negate():e).toString();if(null!=t)for(;n.length<t;)n="0"+n;return o?"-"+n:!0===(null==r?void 0:r.usePositiveSign)?"+"+n:n}s.assertValidZoneId=function(t,r){var e=_.get(r);if(!0!==e){if(!1===e)throw l(r,t);try{Intl.DateTimeFormat(void 0,{timeZone:r}),_.set(r,!0)}catch(e){throw _.set(r,!1),l(r,t)}}},s.floorDiv=f,s.floorMod=d}(temporalUtil$1);var __createBinding$b=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&("get"in n?t.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){e[o=void 0===o?r:o]=t[r]}),__setModuleDefault$b=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar$b=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding$b(t,e,r);return __setModuleDefault$b(t,e),t},__read$e=commonjsGlobal&&commonjsGlobal.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(o=i.next()).done;)a.push(o.value)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},util$3=(Object.defineProperty(temporalTypes,"__esModule",{value:!0}),temporalTypes.isDateTime=temporalTypes.DateTime=temporalTypes.isLocalDateTime=temporalTypes.LocalDateTime=temporalTypes.isDate=temporalTypes.Date=temporalTypes.isTime=temporalTypes.Time=temporalTypes.isLocalTime=temporalTypes.LocalTime=temporalTypes.isDuration=temporalTypes.Duration=void 0,__importStar$b(temporalUtil$1)),util_1$7=util$4,error_1$b=error,integer_1$1=__importStar$b(integer),IDENTIFIER_PROPERTY_ATTRIBUTES$1={value:!0,enumerable:!1,configurable:!1,writable:!1},DURATION_IDENTIFIER_PROPERTY="__isDuration__",LOCAL_TIME_IDENTIFIER_PROPERTY="__isLocalTime__",TIME_IDENTIFIER_PROPERTY="__isTime__",DATE_IDENTIFIER_PROPERTY="__isDate__",LOCAL_DATE_TIME_IDENTIFIER_PROPERTY="__isLocalDateTime__",DATE_TIME_IDENTIFIER_PROPERTY="__isDateTime__",Duration=function(){function e(e,t,r,o){this.months=(0,util_1$7.assertNumberOrInteger)(e,"Months"),this.days=(0,util_1$7.assertNumberOrInteger)(t,"Days"),(0,util_1$7.assertNumberOrInteger)(r,"Seconds"),(0,util_1$7.assertNumberOrInteger)(o,"Nanoseconds"),this.seconds=util$3.normalizeSecondsForDuration(r,o),this.nanoseconds=util$3.normalizeNanosecondsForDuration(o),Object.freeze(this)}return e.prototype.toString=function(){return util$3.durationToIsoString(this.months,this.days,this.seconds,this.nanoseconds)},e}();function isDuration(e){return hasIdentifierProperty$1(e,DURATION_IDENTIFIER_PROPERTY)}temporalTypes.Duration=Duration,Object.defineProperty(Duration.prototype,DURATION_IDENTIFIER_PROPERTY,IDENTIFIER_PROPERTY_ATTRIBUTES$1),temporalTypes.isDuration=isDuration;var LocalTime=function(){function r(e,t,r,o){this.hour=util$3.assertValidHour(e),this.minute=util$3.assertValidMinute(t),this.second=util$3.assertValidSecond(r),this.nanosecond=util$3.assertValidNanosecond(o),Object.freeze(this)}return r.fromStandardDate=function(e,t){verifyStandardDateAndNanos(e,t);t=util$3.totalNanoseconds(e,t);return new r(e.getHours(),e.getMinutes(),e.getSeconds(),t instanceof integer_1$1.default?t.toInt():"bigint"==typeof t?(0,integer_1$1.int)(t).toInt():t)},r.prototype.toString=function(){return util$3.timeToIsoString(this.hour,this.minute,this.second,this.nanosecond)},r}();function isLocalTime(e){return hasIdentifierProperty$1(e,LOCAL_TIME_IDENTIFIER_PROPERTY)}temporalTypes.LocalTime=LocalTime,Object.defineProperty(LocalTime.prototype,LOCAL_TIME_IDENTIFIER_PROPERTY,IDENTIFIER_PROPERTY_ATTRIBUTES$1),temporalTypes.isLocalTime=isLocalTime;var Time=function(){function r(e,t,r,o,n){this.hour=util$3.assertValidHour(e),this.minute=util$3.assertValidMinute(t),this.second=util$3.assertValidSecond(r),this.nanosecond=util$3.assertValidNanosecond(o),this.timeZoneOffsetSeconds=(0,util_1$7.assertNumberOrInteger)(n,"Time zone offset in seconds"),Object.freeze(this)}return r.fromStandardDate=function(e,t){return verifyStandardDateAndNanos(e,t),new r(e.getHours(),e.getMinutes(),e.getSeconds(),(0,integer_1$1.toNumber)(util$3.totalNanoseconds(e,t)),util$3.timeZoneOffsetInSeconds(e))},r.prototype.toString=function(){return util$3.timeToIsoString(this.hour,this.minute,this.second,this.nanosecond)+util$3.timeZoneOffsetToIsoString(this.timeZoneOffsetSeconds)},r}();function isTime(e){return hasIdentifierProperty$1(e,TIME_IDENTIFIER_PROPERTY)}temporalTypes.Time=Time,Object.defineProperty(Time.prototype,TIME_IDENTIFIER_PROPERTY,IDENTIFIER_PROPERTY_ATTRIBUTES$1),temporalTypes.isTime=isTime;var Date$1=function(){function t(e,t,r){this.year=util$3.assertValidYear(e),this.month=util$3.assertValidMonth(t),this.day=util$3.assertValidDay(r),Object.freeze(this)}return t.fromStandardDate=function(e){return verifyStandardDateAndNanos(e),new t(e.getFullYear(),e.getMonth()+1,e.getDate())},t.prototype.toStandardDate=function(){return util$3.isoStringToStandardDate(this.toString())},t.prototype.toString=function(){return util$3.dateToIsoString(this.year,this.month,this.day)},t}();function isDate(e){return hasIdentifierProperty$1(e,DATE_IDENTIFIER_PROPERTY)}temporalTypes.Date=Date$1,Object.defineProperty(Date$1.prototype,DATE_IDENTIFIER_PROPERTY,IDENTIFIER_PROPERTY_ATTRIBUTES$1),temporalTypes.isDate=isDate;var LocalDateTime=function(){function r(e,t,r,o,n,i,a){this.year=util$3.assertValidYear(e),this.month=util$3.assertValidMonth(t),this.day=util$3.assertValidDay(r),this.hour=util$3.assertValidHour(o),this.minute=util$3.assertValidMinute(n),this.second=util$3.assertValidSecond(i),this.nanosecond=util$3.assertValidNanosecond(a),Object.freeze(this)}return r.fromStandardDate=function(e,t){return verifyStandardDateAndNanos(e,t),new r(e.getFullYear(),e.getMonth()+1,e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),(0,integer_1$1.toNumber)(util$3.totalNanoseconds(e,t)))},r.prototype.toStandardDate=function(){return util$3.isoStringToStandardDate(this.toString())},r.prototype.toString=function(){return localDateTimeToString(this.year,this.month,this.day,this.hour,this.minute,this.second,this.nanosecond)},r}();function isLocalDateTime(e){return hasIdentifierProperty$1(e,LOCAL_DATE_TIME_IDENTIFIER_PROPERTY)}temporalTypes.LocalDateTime=LocalDateTime,Object.defineProperty(LocalDateTime.prototype,LOCAL_DATE_TIME_IDENTIFIER_PROPERTY,IDENTIFIER_PROPERTY_ATTRIBUTES$1),temporalTypes.isLocalDateTime=isLocalDateTime;var DateTime=function(){function r(e,t,r,o,n,i,a,s,u){this.year=util$3.assertValidYear(e),this.month=util$3.assertValidMonth(t),this.day=util$3.assertValidDay(r),this.hour=util$3.assertValidHour(o),this.minute=util$3.assertValidMinute(n),this.second=util$3.assertValidSecond(i),this.nanosecond=util$3.assertValidNanosecond(a);e=__read$e(verifyTimeZoneArguments(s,u),2),t=e[0],r=e[1];this.timeZoneOffsetSeconds=t,this.timeZoneId=null!=r?r:void 0,Object.freeze(this)}return r.fromStandardDate=function(e,t){return verifyStandardDateAndNanos(e,t),new r(e.getFullYear(),e.getMonth()+1,e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),(0,integer_1$1.toNumber)(util$3.totalNanoseconds(e,t)),util$3.timeZoneOffsetInSeconds(e),null)},r.prototype.toStandardDate=function(){return util$3.toStandardDate(this._toUTC())},r.prototype.toString=function(){var e;return localDateTimeToString(this.year,this.month,this.day,this.hour,this.minute,this.second,this.nanosecond)+(null!=this.timeZoneOffsetSeconds?util$3.timeZoneOffsetToIsoString(null!=(e=this.timeZoneOffsetSeconds)?e:0):"")+(null!=this.timeZoneId?"[".concat(this.timeZoneId,"]"):"")},r.prototype._toUTC=function(){if(void 0===this.timeZoneOffsetSeconds)throw new Error("Requires DateTime created with time zone offset");var e=util$3.localDateTimeToEpochSecond(this.year,this.month,this.day,this.hour,this.minute,this.second,this.nanosecond).subtract(null!=(e=this.timeZoneOffsetSeconds)?e:0);return(0,integer_1$1.int)(e).multiply(1e3).add((0,integer_1$1.int)(this.nanosecond).div(1e6)).toNumber()},r}();function isDateTime(e){return hasIdentifierProperty$1(e,DATE_TIME_IDENTIFIER_PROPERTY)}function hasIdentifierProperty$1(e,t){return null!=e&&!0===e[t]}function localDateTimeToString(e,t,r,o,n,i,a){return util$3.dateToIsoString(e,t,r)+"T"+util$3.timeToIsoString(o,n,i,a)}function verifyTimeZoneArguments(e,t){var r,o=null!=e,n=null!=t&&""!==t;if(o||n)return r=[void 0,void 0],o&&((0,util_1$7.assertNumberOrInteger)(e,"Time zone offset in seconds"),r[0]=e),n&&((0,util_1$7.assertString)(t,"Time zone ID"),util$3.assertValidZoneId("Time zone ID",t),r[1]=t),r;throw(0,error_1$b.newError)("Unable to create DateTime without either time zone offset or id. Please specify either of them. Given offset: ".concat(e," and id: ").concat(t))}function verifyStandardDateAndNanos(e,t){(0,util_1$7.assertValidDate)(e,"Standard date"),null!=t&&(0,util_1$7.assertNumberOrInteger)(t,"Nanosecond")}temporalTypes.DateTime=DateTime,Object.defineProperty(DateTime.prototype,DATE_TIME_IDENTIFIER_PROPERTY,IDENTIFIER_PROPERTY_ATTRIBUTES$1),temporalTypes.isDateTime=isDateTime;var graphTypes={},json_1=(Object.defineProperty(graphTypes,"__esModule",{value:!0}),graphTypes.isPathSegment=graphTypes.PathSegment=graphTypes.isPath=graphTypes.Path=graphTypes.isUnboundRelationship=graphTypes.UnboundRelationship=graphTypes.isRelationship=graphTypes.Relationship=graphTypes.isNode=graphTypes.Node=void 0,json$3),IDENTIFIER_PROPERTY_ATTRIBUTES={value:!0,enumerable:!1,configurable:!1,writable:!1},NODE_IDENTIFIER_PROPERTY="__isNode__",RELATIONSHIP_IDENTIFIER_PROPERTY="__isRelationship__",UNBOUND_RELATIONSHIP_IDENTIFIER_PROPERTY="__isUnboundRelationship__",PATH_IDENTIFIER_PROPERTY="__isPath__",PATH_SEGMENT_IDENTIFIER_PROPERTY="__isPathSegment__";function hasIdentifierProperty(e,t){return null!=e&&!0===e[t]}var Node=function(){function e(e,t,r,o){this.identity=e,this.labels=t,this.properties=r,this.elementId=_valueOrGetDefault(o,function(){return e.toString()})}return e.prototype.toString=function(){for(var e="("+this.elementId,t=0;t<this.labels.length;t++)e+=":"+this.labels[t];var r=Object.keys(this.properties);if(0<r.length){e+=" {";for(t=0;t<r.length;t++)0<t&&(e+=","),e+=r[t]+":"+(0,json_1.stringify)(this.properties[r[t]]);e+="}"}return e+=")"},e}();function isNode(e){return hasIdentifierProperty(e,NODE_IDENTIFIER_PROPERTY)}graphTypes.Node=Node,Object.defineProperty(Node.prototype,NODE_IDENTIFIER_PROPERTY,IDENTIFIER_PROPERTY_ATTRIBUTES),graphTypes.isNode=isNode;var Relationship=function(){function e(e,t,r,o,n,i,a,s){this.identity=e,this.start=t,this.end=r,this.type=o,this.properties=n,this.elementId=_valueOrGetDefault(i,function(){return e.toString()}),this.startNodeElementId=_valueOrGetDefault(a,function(){return t.toString()}),this.endNodeElementId=_valueOrGetDefault(s,function(){return r.toString()})}return e.prototype.toString=function(){var e="("+this.startNodeElementId+")-[:"+this.type,t=Object.keys(this.properties);if(0<t.length){e+=" {";for(var r=0;r<t.length;r++)0<r&&(e+=","),e+=t[r]+":"+(0,json_1.stringify)(this.properties[t[r]]);e+="}"}return e+="]->("+this.endNodeElementId+")"},e}();function isRelationship(e){return hasIdentifierProperty(e,RELATIONSHIP_IDENTIFIER_PROPERTY)}graphTypes.Relationship=Relationship,Object.defineProperty(Relationship.prototype,RELATIONSHIP_IDENTIFIER_PROPERTY,IDENTIFIER_PROPERTY_ATTRIBUTES),graphTypes.isRelationship=isRelationship;var UnboundRelationship=function(){function e(e,t,r,o){this.identity=e,this.type=t,this.properties=r,this.elementId=_valueOrGetDefault(o,function(){return e.toString()})}return e.prototype.bind=function(e,t){return new Relationship(this.identity,e,t,this.type,this.properties,this.elementId)},e.prototype.bindTo=function(e,t){return new Relationship(this.identity,e.identity,t.identity,this.type,this.properties,this.elementId,e.elementId,t.elementId)},e.prototype.toString=function(){var e="-[:"+this.type,t=Object.keys(this.properties);if(0<t.length){e+=" {";for(var r=0;r<t.length;r++)0<r&&(e+=","),e+=t[r]+":"+(0,json_1.stringify)(this.properties[t[r]]);e+="}"}return e+="]->"},e}();function isUnboundRelationship(e){return hasIdentifierProperty(e,UNBOUND_RELATIONSHIP_IDENTIFIER_PROPERTY)}graphTypes.UnboundRelationship=UnboundRelationship,Object.defineProperty(UnboundRelationship.prototype,UNBOUND_RELATIONSHIP_IDENTIFIER_PROPERTY,IDENTIFIER_PROPERTY_ATTRIBUTES),graphTypes.isUnboundRelationship=isUnboundRelationship;var PathSegment=function(e,t,r){this.start=e,this.relationship=t,this.end=r};function isPathSegment(e){return hasIdentifierProperty(e,PATH_SEGMENT_IDENTIFIER_PROPERTY)}graphTypes.PathSegment=PathSegment,Object.defineProperty(PathSegment.prototype,PATH_SEGMENT_IDENTIFIER_PROPERTY,IDENTIFIER_PROPERTY_ATTRIBUTES),graphTypes.isPathSegment=isPathSegment;var Path=function(e,t,r){this.start=e,this.end=t,this.segments=r,this.length=r.length};function isPath(e){return hasIdentifierProperty(e,PATH_IDENTIFIER_PROPERTY)}function _valueOrGetDefault(e,t){return null==e?t():e}graphTypes.Path=Path,Object.defineProperty(Path.prototype,PATH_IDENTIFIER_PROPERTY,IDENTIFIER_PROPERTY_ATTRIBUTES),graphTypes.isPath=isPath;var record={},__generator$j=commonjsGlobal&&commonjsGlobal.__generator||function(o,n){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=n.call(o,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__values$3=commonjsGlobal&&commonjsGlobal.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],o=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&o>=e.length?void 0:e)&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},__read$d=commonjsGlobal&&commonjsGlobal.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(o=i.next()).done;)a.push(o.value)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},error_1$a=(Object.defineProperty(record,"__esModule",{value:!0}),error);function generateFieldLookup(e){var r={};return e.forEach(function(e,t){r[e]=t}),r}var Record=function(){function e(e,t,r){this.keys=e,this.length=e.length,this._fields=t,this._fieldLookup=null!=r?r:generateFieldLookup(e)}return e.prototype.forEach=function(e){var t,r;try{for(var o=__values$3(this.entries()),n=o.next();!n.done;n=o.next()){var i=__read$d(n.value,2),a=i[0];e(i[1],a,this)}}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}},e.prototype.map=function(e){var t,r,o=[];try{for(var n=__values$3(this.entries()),i=n.next();!i.done;i=n.next()){var a=__read$d(i.value,2),s=a[0],u=a[1];o.push(e(u,s,this))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return o},e.prototype.entries=function(){var t;return __generator$j(this,function(e){switch(e.label){case 0:t=0,e.label=1;case 1:return t<this.keys.length?[4,[this.keys[t],this._fields[t]]]:[3,4];case 2:e.sent(),e.label=3;case 3:return t++,[3,1];case 4:return[2]}})},e.prototype.values=function(){var t;return __generator$j(this,function(e){switch(e.label){case 0:t=0,e.label=1;case 1:return t<this.keys.length?[4,this._fields[t]]:[3,4];case 2:e.sent(),e.label=3;case 3:return t++,[3,1];case 4:return[2]}})},e.prototype[Symbol.iterator]=function(){var t;return __generator$j(this,function(e){switch(e.label){case 0:t=0,e.label=1;case 1:return t<this.keys.length?[4,this._fields[t]]:[3,4];case 2:e.sent(),e.label=3;case 3:return t++,[3,1];case 4:return[2]}})},e.prototype.toObject=function(){var t,e,r={};try{for(var o=__values$3(this.entries()),n=o.next();!n.done;n=o.next()){var i=__read$d(n.value,2),a=i[0],s=i[1];r[a]=s}}catch(e){t={error:e}}finally{try{n&&!n.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return r},e.prototype.get=function(e){var t;if("number"!=typeof e){if(void 0===(t=this._fieldLookup[e]))throw(0,error_1$a.newError)("This record has no field with key '".concat(e.toString(),"', available keys are: [")+this.keys.toString()+"].")}else t=e;if(t>this._fields.length-1||t<0)throw(0,error_1$a.newError)("This record has no field with index '"+t.toString()+"'. Remember that indexes start at `0`, and make sure your query returns records in the shape you meant it to.");return this._fields[t]},e.prototype.has=function(e){return"number"==typeof e?0<=e&&e<this._fields.length:void 0!==this._fieldLookup[e]},e}(),spatialTypes=(record.default=Record,{}),util_1$6=(Object.defineProperty(spatialTypes,"__esModule",{value:!0}),spatialTypes.isPoint=spatialTypes.Point=void 0,util$4),POINT_IDENTIFIER_PROPERTY="__isPoint__",Point=function(){function e(e,t,r,o){this.srid=(0,util_1$6.assertNumberOrInteger)(e,"SRID"),this.x=(0,util_1$6.assertNumber)(t,"X coordinate"),this.y=(0,util_1$6.assertNumber)(r,"Y coordinate"),this.z=null==o?o:(0,util_1$6.assertNumber)(o,"Z coordinate"),Object.freeze(this)}return e.prototype.toString=function(){return null==this.z||isNaN(this.z)?"Point{srid=".concat(formatAsFloat(this.srid),", x=").concat(formatAsFloat(this.x),", y=").concat(formatAsFloat(this.y),"}"):"Point{srid=".concat(formatAsFloat(this.srid),", x=").concat(formatAsFloat(this.x),", y=").concat(formatAsFloat(this.y),", z=").concat(formatAsFloat(this.z),"}")},e}();function formatAsFloat(e){return Number.isInteger(e)?e.toString()+".0":e.toString()}function isPoint(e){return null!=e&&!0===e[POINT_IDENTIFIER_PROPERTY]}spatialTypes.Point=Point,Object.defineProperty(Point.prototype,POINT_IDENTIFIER_PROPERTY,{value:!0,enumerable:!1,configurable:!1,writable:!1}),spatialTypes.isPoint=isPoint;var resultSummary={},internal={},observers={},CompletedObserver$1=(Object.defineProperty(observers,"__esModule",{value:!0}),observers.FailedObserver=observers.CompletedObserver=void 0,function(){function e(){}return e.prototype.subscribe=function(e){apply(e,e.onKeys,[]),apply(e,e.onCompleted,{})},e.prototype.cancel=function(){},e.prototype.pause=function(){},e.prototype.resume=function(){},e.prototype.prepareToHandleSingleResponse=function(){},e.prototype.markCompleted=function(){},e.prototype.onError=function(e){throw new Error("CompletedObserver not supposed to call onError",{cause:e})},e}()),FailedObserver$1=(observers.CompletedObserver=CompletedObserver$1,function(){function e(e){var t=e.error,e=e.onError;this._error=t,this._beforeError=e,this._observers=[],this.onError(t)}return e.prototype.subscribe=function(e){apply(e,e.onError,this._error),this._observers.push(e)},e.prototype.onError=function(t){apply(this,this._beforeError,t),this._observers.forEach(function(e){return apply(e,e.onError,t)})},e.prototype.cancel=function(){},e.prototype.pause=function(){},e.prototype.resume=function(){},e.prototype.markCompleted=function(){},e.prototype.prepareToHandleSingleResponse=function(){},e}());function apply(e,t,r){null!=t&&t.bind(e)(r)}observers.FailedObserver=FailedObserver$1;var bookmarks$1={},__createBinding$a=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&("get"in n?t.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){e[o=void 0===o?r:o]=t[r]}),__setModuleDefault$a=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar$a=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding$a(t,e,r);return __setModuleDefault$a(t,e),t},__read$c=commonjsGlobal&&commonjsGlobal.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(o=i.next()).done;)a.push(o.value)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},__spreadArray$6=commonjsGlobal&&commonjsGlobal.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var o,n=0,i=t.length;n<i;n++)!o&&n in t||((o=o||Array.prototype.slice.call(t,0,n))[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))},util$2=(Object.defineProperty(bookmarks$1,"__esModule",{value:!0}),bookmarks$1.Bookmarks=void 0,__importStar$a(util$4)),BOOKMARKS_KEY="bookmarks",Bookmarks$4=function(){function e(e){this._values=asStringArray(e)}return e.empty=function(){return EMPTY_BOOKMARK},e.prototype.isEmpty=function(){return 0===this._values.length},e.prototype.values=function(){return this._values},e.prototype[Symbol.iterator]=function(){return this._values[Symbol.iterator]()},e.prototype.asBeginTransactionParameters=function(){var e;return this.isEmpty()?{}:((e={})[BOOKMARKS_KEY]=this._values,e)},e}(),EMPTY_BOOKMARK=new(bookmarks$1.Bookmarks=Bookmarks$4)(null);function asStringArray(e){if(null==e||""===e)return[];if(util$2.isString(e))return[e];if(Array.isArray(e)){for(var t=new Set,r=flattenArray(e),o=0;o<r.length;o++){var n=r[o];if(null!=n){if(!util$2.isString(n))throw new TypeError("Bookmark value should be a string, given: '".concat(n,"'"));t.add(n)}}return __spreadArray$6([],__read$c(t),!1)}throw new TypeError("Bookmarks should either be a string or a string array, given: '".concat(e,"'"))}function flattenArray(e){return e.reduce(function(e,t){return Array.isArray(t)?e.concat(flattenArray(t)):e.concat(t)},[])}var _a$g,constants$1={},FETCH_ALL$6=(Object.defineProperty(constants$1,"__esModule",{value:!0}),constants$1.TELEMETRY_APIS=constants$1.BOLT_PROTOCOL_V5_7=constants$1.BOLT_PROTOCOL_V5_6=constants$1.BOLT_PROTOCOL_V5_5=constants$1.BOLT_PROTOCOL_V5_4=constants$1.BOLT_PROTOCOL_V5_3=constants$1.BOLT_PROTOCOL_V5_2=constants$1.BOLT_PROTOCOL_V5_1=constants$1.BOLT_PROTOCOL_V5_0=constants$1.BOLT_PROTOCOL_V4_4=constants$1.BOLT_PROTOCOL_V4_3=constants$1.BOLT_PROTOCOL_V4_2=constants$1.BOLT_PROTOCOL_V4_1=constants$1.BOLT_PROTOCOL_V4_0=constants$1.BOLT_PROTOCOL_V3=constants$1.BOLT_PROTOCOL_V2=constants$1.BOLT_PROTOCOL_V1=constants$1.DEFAULT_POOL_MAX_SIZE=constants$1.DEFAULT_POOL_ACQUISITION_TIMEOUT=constants$1.DEFAULT_CONNECTION_TIMEOUT_MILLIS=constants$1.ACCESS_MODE_WRITE=constants$1.ACCESS_MODE_READ=constants$1.FETCH_ALL=void 0,-1),DEFAULT_POOL_ACQUISITION_TIMEOUT=(constants$1.FETCH_ALL=FETCH_ALL$6,6e4),DEFAULT_POOL_MAX_SIZE=(constants$1.DEFAULT_POOL_ACQUISITION_TIMEOUT=DEFAULT_POOL_ACQUISITION_TIMEOUT,100),DEFAULT_CONNECTION_TIMEOUT_MILLIS=(constants$1.DEFAULT_POOL_MAX_SIZE=DEFAULT_POOL_MAX_SIZE,3e4),ACCESS_MODE_READ$1=(constants$1.DEFAULT_CONNECTION_TIMEOUT_MILLIS=DEFAULT_CONNECTION_TIMEOUT_MILLIS,"READ"),ACCESS_MODE_WRITE$1=(constants$1.ACCESS_MODE_READ=ACCESS_MODE_READ$1,"WRITE"),BOLT_PROTOCOL_V1$1=(constants$1.ACCESS_MODE_WRITE=ACCESS_MODE_WRITE$1,1),BOLT_PROTOCOL_V2$1=(constants$1.BOLT_PROTOCOL_V1=BOLT_PROTOCOL_V1$1,2),BOLT_PROTOCOL_V3$3=(constants$1.BOLT_PROTOCOL_V2=BOLT_PROTOCOL_V2$1,3),BOLT_PROTOCOL_V4_0$3=(constants$1.BOLT_PROTOCOL_V3=BOLT_PROTOCOL_V3$3,4),BOLT_PROTOCOL_V4_1$1=(constants$1.BOLT_PROTOCOL_V4_0=BOLT_PROTOCOL_V4_0$3,4.1),BOLT_PROTOCOL_V4_2$1=(constants$1.BOLT_PROTOCOL_V4_1=BOLT_PROTOCOL_V4_1$1,4.2),BOLT_PROTOCOL_V4_3$1=(constants$1.BOLT_PROTOCOL_V4_2=BOLT_PROTOCOL_V4_2$1,4.3),BOLT_PROTOCOL_V4_4$3=(constants$1.BOLT_PROTOCOL_V4_3=BOLT_PROTOCOL_V4_3$1,4.4),BOLT_PROTOCOL_V5_0$1=(constants$1.BOLT_PROTOCOL_V4_4=BOLT_PROTOCOL_V4_4$3,5),BOLT_PROTOCOL_V5_1$3=(constants$1.BOLT_PROTOCOL_V5_0=BOLT_PROTOCOL_V5_0$1,5.1),BOLT_PROTOCOL_V5_2$1=(constants$1.BOLT_PROTOCOL_V5_1=BOLT_PROTOCOL_V5_1$3,5.2),BOLT_PROTOCOL_V5_3$1=(constants$1.BOLT_PROTOCOL_V5_2=BOLT_PROTOCOL_V5_2$1,5.3),BOLT_PROTOCOL_V5_4$1=(constants$1.BOLT_PROTOCOL_V5_3=BOLT_PROTOCOL_V5_3$1,5.4),BOLT_PROTOCOL_V5_5$1=(constants$1.BOLT_PROTOCOL_V5_4=BOLT_PROTOCOL_V5_4$1,5.5),BOLT_PROTOCOL_V5_6$1=(constants$1.BOLT_PROTOCOL_V5_5=BOLT_PROTOCOL_V5_5$1,5.6),BOLT_PROTOCOL_V5_7$1=(constants$1.BOLT_PROTOCOL_V5_6=BOLT_PROTOCOL_V5_6$1,5.7),TELEMETRY_APIS=(constants$1.BOLT_PROTOCOL_V5_7=BOLT_PROTOCOL_V5_7$1,{MANAGED_TRANSACTION:0,UNMANAGED_TRANSACTION:1,AUTO_COMMIT_TRANSACTION:2,EXECUTE_QUERY:3}),connectionHolder$1=(constants$1.TELEMETRY_APIS=TELEMETRY_APIS,{}),logger$1={},__extends$z=commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),error_1$9=(Object.defineProperty(logger$1,"__esModule",{value:!0}),logger$1.Logger=void 0,error),ERROR="error",WARN="warn",INFO="info",DEBUG="debug",DEFAULT_LEVEL=INFO,levels=((_a$g={})[ERROR]=0,_a$g[WARN]=1,_a$g[INFO]=2,_a$g[DEBUG]=3,_a$g),Logger$1=function(){function t(e,t){this._level=e,this._loggerFunction=t}return t.create=function(e){return null!=(null==e?void 0:e.logging)?new t(extractConfiguredLevel(e=e.logging),extractConfiguredLogger(e)):this.noOp()},t.noOp=function(){return noOpLogger},t.prototype.isErrorEnabled=function(){return isLevelEnabled(this._level,ERROR)},t.prototype.error=function(e){this.isErrorEnabled()&&this._loggerFunction(ERROR,e)},t.prototype.isWarnEnabled=function(){return isLevelEnabled(this._level,WARN)},t.prototype.warn=function(e){this.isWarnEnabled()&&this._loggerFunction(WARN,e)},t.prototype.isInfoEnabled=function(){return isLevelEnabled(this._level,INFO)},t.prototype.info=function(e){this.isInfoEnabled()&&this._loggerFunction(INFO,e)},t.prototype.isDebugEnabled=function(){return isLevelEnabled(this._level,DEBUG)},t.prototype.debug=function(e){this.isDebugEnabled()&&this._loggerFunction(DEBUG,e)},t}(),NoOpLogger=function(e){function t(){return e.call(this,INFO,function(e,t){})||this}return __extends$z(t,e),t.prototype.isErrorEnabled=function(){return!1},t.prototype.error=function(e){},t.prototype.isWarnEnabled=function(){return!1},t.prototype.warn=function(e){},t.prototype.isInfoEnabled=function(){return!1},t.prototype.info=function(e){},t.prototype.isDebugEnabled=function(){return!1},t.prototype.debug=function(e){},t}(logger$1.Logger=Logger$1),noOpLogger=new NoOpLogger;function isLevelEnabled(e,t){return levels[e]>=levels[t]}function extractConfiguredLevel(e){if(null==(null==e?void 0:e.level))return DEFAULT_LEVEL;var e=e.level,t=levels[e];if(null==t&&0!==t)throw(0,error_1$9.newError)("Illegal logging level: ".concat(e,". Supported levels are: ").concat(Object.keys(levels).toString()));return e}function extractConfiguredLogger(e){if(null!=(null==e?void 0:e.logger)){var t=e.logger;if(null!=t&&"function"==typeof t)return t}throw(0,error_1$9.newError)("Illegal logger function: ".concat(null!=(e=null==(t=null==e?void 0:e.logger)?void 0:t.toString())?e:"undefined"))}var __extends$y=commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),__awaiter$i=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function o(e){try{i(u.next(e))}catch(e){t(e)}}function n(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(o,n)}i((u=u.apply(e,a||[])).next())})},__generator$i=commonjsGlobal&&commonjsGlobal.__generator||function(o,n){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=n.call(o,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},error_1$8=(Object.defineProperty(connectionHolder$1,"__esModule",{value:!0}),connectionHolder$1.EMPTY_CONNECTION_HOLDER=connectionHolder$1.ReadOnlyConnectionHolder=connectionHolder$1.ConnectionHolder=void 0,error),util_1$5=util$4,constants_1$4=constants$1,bookmarks_1$3=bookmarks$1,logger_1$2=logger$1,ConnectionHolder=function(){function e(e){var t=e.mode,r=e.database,r=void 0===r?"":r,o=e.bookmarks,n=e.connectionProvider,i=e.impersonatedUser,a=e.onDatabaseNameResolved,s=e.getConnectionAcquistionBookmarks,u=e.auth,e=e.log;this._mode=null!=t?t:constants_1$4.ACCESS_MODE_WRITE,this._closed=!1,this._database=null!=r?(0,util_1$5.assertString)(r,"database"):"",this._bookmarks=null!=o?o:bookmarks_1$3.Bookmarks.empty(),this._connectionProvider=n,this._impersonatedUser=i,this._referenceCount=0,this._connectionPromise=Promise.resolve(null),this._onDatabaseNameResolved=a,this._auth=u,this._log=e,this._logError=this._logError.bind(this),this._getConnectionAcquistionBookmarks=null!=s?s:function(){return Promise.resolve(bookmarks_1$3.Bookmarks.empty())}}return e.prototype.mode=function(){return this._mode},e.prototype.database=function(){return this._database},e.prototype.setDatabase=function(e){this._database=e},e.prototype.bookmarks=function(){return this._bookmarks},e.prototype.connectionProvider=function(){return this._connectionProvider},e.prototype.referenceCount=function(){return this._referenceCount},e.prototype.initializeConnection=function(){return 0!==this._referenceCount||null==this._connectionProvider?(this._referenceCount++,!1):(this._connectionPromise=this._createConnectionPromise(this._connectionProvider),this._referenceCount++,!0)},e.prototype._createConnectionPromise=function(n){return __awaiter$i(this,void 0,void 0,function(){var t,r,o;return __generator$i(this,function(e){switch(e.label){case 0:return r=(t=n).acquireConnection,o={accessMode:this._mode,database:this._database},[4,this._getBookmarks()];case 1:return[4,r.apply(t,[(o.bookmarks=e.sent(),o.impersonatedUser=this._impersonatedUser,o.onDatabaseNameResolved=this._onDatabaseNameResolved,o.auth=this._auth,o)])];case 2:return[2,e.sent()]}})})},e.prototype._getBookmarks=function(){return __awaiter$i(this,void 0,void 0,function(){return __generator$i(this,function(e){switch(e.label){case 0:return[4,this._getConnectionAcquistionBookmarks()];case 1:return[2,e.sent()]}})})},e.prototype.getConnection=function(){return this._connectionPromise},e.prototype.releaseConnection=function(){return 0!==this._referenceCount&&(this._referenceCount--,0===this._referenceCount)?this._releaseConnection():this._connectionPromise},e.prototype.close=function(e){return this._closed=!0,0===this._referenceCount?this._connectionPromise:(this._referenceCount=0,this._releaseConnection(e))},e.prototype.log=function(){return this._log},e.prototype._releaseConnection=function(t){return this._connectionPromise=this._connectionPromise.then(function(e){return null!=e?e.isOpen()&&(e.hasOngoingObservableRequests()||!0===t)?e.resetAndFlush().catch(ignoreError).then(function(){return e.release().then(function(){return null})}):e.release().then(function(){return null}):Promise.resolve(null)}).catch(this._logError),this._connectionPromise},e.prototype._logError=function(e){return this._log.isWarnEnabled()&&this._log.warn("ConnectionHolder got an error while releasing the connection. Error ".concat(e,". Stacktrace: ").concat(e.stack)),null},e}(),ReadOnlyConnectionHolder=function(r){function e(e){var t=r.call(this,{mode:e.mode(),database:e.database(),bookmarks:e.bookmarks(),getConnectionAcquistionBookmarks:e._getConnectionAcquistionBookmarks,connectionProvider:e.connectionProvider(),log:e.log()})||this;return t._connectionHolder=e,t}return __extends$y(e,r),e.prototype.initializeConnection=function(){return 0!==this._connectionHolder.referenceCount()},e.prototype.getConnection=function(){return this._connectionHolder.getConnection()},e.prototype.releaseConnection=function(){return this._connectionHolder.getConnection().catch(function(){return Promise.resolve(null)})},e.prototype.close=function(){return this._connectionHolder.getConnection().catch(function(){return Promise.resolve(null)})},e}(connectionHolder$1.ConnectionHolder=ConnectionHolder),EmptyConnectionHolder=(connectionHolder$1.ReadOnlyConnectionHolder=ReadOnlyConnectionHolder,connectionHolder$1.default=ReadOnlyConnectionHolder,function(e){function t(){return e.call(this,{log:logger_1$2.Logger.create({})})||this}return __extends$y(t,e),t.prototype.mode=function(){},t.prototype.database=function(){},t.prototype.initializeConnection=function(){return!0},t.prototype.getConnection=function(){return __awaiter$i(this,void 0,void 0,function(){return __generator$i(this,function(e){switch(e.label){case 0:return[4,Promise.reject((0,error_1$8.newError)("This connection holder does not serve connections"))];case 1:return[2,e.sent()]}})})},t.prototype.releaseConnection=function(){return __awaiter$i(this,void 0,void 0,function(){return __generator$i(this,function(e){switch(e.label){case 0:return[4,Promise.resolve(null)];case 1:return[2,e.sent()]}})})},t.prototype.close=function(){return __awaiter$i(this,void 0,void 0,function(){return __generator$i(this,function(e){switch(e.label){case 0:return[4,Promise.resolve(null)];case 1:return[2,e.sent()]}})})},t}(ConnectionHolder)),EMPTY_CONNECTION_HOLDER$1=new EmptyConnectionHolder;function ignoreError(e){return null}connectionHolder$1.EMPTY_CONNECTION_HOLDER=EMPTY_CONNECTION_HOLDER$1;var txConfig$1={},__createBinding$9=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&("get"in n?t.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){e[o=void 0===o?r:o]=t[r]}),__setModuleDefault$9=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar$9=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding$9(t,e,r);return __setModuleDefault$9(t,e),t},util$1=(Object.defineProperty(txConfig$1,"__esModule",{value:!0}),txConfig$1.TxConfig=void 0,__importStar$9(util$4)),error_1$7=error,integer_1=integer,TxConfig$3=function(){function e(e,t){assertValidConfig(e),this.timeout=extractTimeout(e,t),this.metadata=extractMetadata(e)}return e.empty=function(){return EMPTY_CONFIG},e.prototype.isEmpty=function(){return Object.values(this).every(function(e){return null==e})},e}(),EMPTY_CONFIG=new(txConfig$1.TxConfig=TxConfig$3)({});function extractTimeout(e,t){if(util$1.isObject(e)&&null!=e.timeout){util$1.assertNumberOrInteger(e.timeout,"Transaction timeout"),isTimeoutFloat(e)&&!0===(null==t?void 0:t.isInfoEnabled())&&null!=t&&t.info("Transaction timeout expected to be an integer, got: ".concat(e.timeout,". The value will be rounded up."));t=(0,integer_1.int)(e.timeout,{ceilFloat:!0});if(t.isNegative())throw(0,error_1$7.newError)("Transaction timeout should not be negative");return t}return null}function isTimeoutFloat(e){return"number"==typeof e.timeout&&!Number.isInteger(e.timeout)}function extractMetadata(e){if(util$1.isObject(e)&&null!=e.metadata){e=e.metadata;if(util$1.assertObject(e,"config.metadata"),0!==Object.keys(e).length)return e}return null}function assertValidConfig(e){null!=e&&util$1.assertObject(e,"Transaction config")}var transactionExecutor$1={},__assign$t=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$t=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__awaiter$h=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function o(e){try{i(u.next(e))}catch(e){t(e)}}function n(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(o,n)}i((u=u.apply(e,a||[])).next())})},__generator$h=commonjsGlobal&&commonjsGlobal.__generator||function(o,n){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=n.call(o,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__read$b=commonjsGlobal&&commonjsGlobal.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(o=i.next()).done;)a.push(o.value)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},__spreadArray$5=commonjsGlobal&&commonjsGlobal.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var o,n=0,i=t.length;n<i;n++)!o&&n in t||((o=o||Array.prototype.slice.call(t,0,n))[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))},error_1$6=(Object.defineProperty(transactionExecutor$1,"__esModule",{value:!0}),transactionExecutor$1.TransactionExecutor=void 0,error),constants_1$3=constants$1,DEFAULT_MAX_RETRY_TIME_MS=3e4,DEFAULT_INITIAL_RETRY_DELAY_MS=1e3,DEFAULT_RETRY_DELAY_MULTIPLIER=2,DEFAULT_RETRY_DELAY_JITTER_FACTOR=.2;function setTimeoutWrapper(e,t){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];return setTimeout.apply(void 0,__spreadArray$5([e,t],__read$b(r),!1))}function clearTimeoutWrapper(e){return clearTimeout(e)}var TransactionExecutor=function(){function e(e,t,r,o,n){void 0===n&&(n={setTimeout:setTimeoutWrapper,clearTimeout:clearTimeoutWrapper}),this._maxRetryTimeMs=_valueOrDefault(e,DEFAULT_MAX_RETRY_TIME_MS),this._initialRetryDelayMs=_valueOrDefault(t,DEFAULT_INITIAL_RETRY_DELAY_MS),this._multiplier=_valueOrDefault(r,DEFAULT_RETRY_DELAY_MULTIPLIER),this._jitterFactor=_valueOrDefault(o,DEFAULT_RETRY_DELAY_JITTER_FACTOR),this._setTimeout=n.setTimeout,this._clearTimeout=n.clearTimeout,this._inFlightTimeoutIds=[],this.pipelineBegin=!1,this.telemetryApi=constants_1$3.TELEMETRY_APIS.MANAGED_TRANSACTION,this._verifyAfterConstruction()}return e.prototype.execute=function(o,n,i){var a=this,s={apiTransactionConfig:{api:this.telemetryApi,onTelemetrySuccess:function(){s.apiTransactionConfig=void 0}}};return new Promise(function(e,t){a._executeTransactionInsidePromise(o,n,e,t,i,s).catch(t)}).catch(function(e){var t=Date.now(),r=a._initialRetryDelayMs;return a._retryTransactionPromise(o,n,e,t,r,i,s)})},e.prototype.close=function(){var t=this;this._inFlightTimeoutIds.forEach(function(e){return t._clearTimeout(e)}),this._inFlightTimeoutIds=[]},e.prototype._retryTransactionPromise=function(n,i,e,r,a,s,u){var c=this;return Date.now()-r>this._maxRetryTimeMs||!(0,error_1$6.isRetriableError)(e)?Promise.reject(e):new Promise(function(e,t){var r=c._computeDelayWithJitter(a),o=c._setTimeout(function(){c._inFlightTimeoutIds=c._inFlightTimeoutIds.filter(function(e){return e!==o}),c._executeTransactionInsidePromise(n,i,e,t,s,u).catch(t)},r);c._inFlightTimeoutIds.push(o)}).catch(function(e){var t=a*c._multiplier;return c._retryTransactionPromise(n,i,e,r,t,s,u)})},e.prototype._executeTransactionInsidePromise=function(a,s,u,c,l,_){return __awaiter$h(this,void 0,void 0,function(){var t,r,o,n,i=this;return __generator$h(this,function(e){switch(e.label){case 0:return(e.trys.push([0,4,,5]),r=a(null!=(null==_?void 0:_.apiTransactionConfig)?__assign$t({},null==_?void 0:_.apiTransactionConfig):void 0),this.pipelineBegin)?(o=r,[3,3]):[3,1];case 1:return[4,r];case 2:o=e.sent(),e.label=3;case 3:return t=o,[3,5];case 4:return n=e.sent(),c(n),[2];case 5:return n=(null!=l?l:function(e){return e})(t),this._safeExecuteTransactionWork(n,s).then(function(e){return i._handleTransactionWorkSuccess(e,t,u,c)}).catch(function(e){return i._handleTransactionWorkFailure(e,t,c)}),[2]}})})},e.prototype._safeExecuteTransactionWork=function(e,t){try{var r=t(e);return Promise.resolve(r)}catch(e){return Promise.reject(e)}},e.prototype._handleTransactionWorkSuccess=function(e,t,r,o){t.isOpen()?t.commit().then(function(){r(e)}).catch(function(e){o(e)}):r(e)},e.prototype._handleTransactionWorkFailure=function(e,t,r){t.isOpen()?t.rollback().catch(function(e){}).then(function(){return r(e)}).catch(r):r(e)},e.prototype._computeDelayWithJitter=function(e){var t=e*this._jitterFactor,r=e-t,e=e+t;return Math.random()*(e-r)+r},e.prototype._verifyAfterConstruction=function(){if(this._maxRetryTimeMs<0)throw(0,error_1$6.newError)("Max retry time should be >= 0: "+this._maxRetryTimeMs.toString());if(this._initialRetryDelayMs<0)throw(0,error_1$6.newError)("Initial retry delay should >= 0: "+this._initialRetryDelayMs.toString());if(this._multiplier<1)throw(0,error_1$6.newError)("Multiplier should be >= 1.0: "+this._multiplier.toString());if(this._jitterFactor<0||1<this._jitterFactor)throw(0,error_1$6.newError)("Jitter factor should be in [0.0, 1.0]: "+this._jitterFactor.toFixed())},e}();function _valueOrDefault(e,t){return null!=e?e:t}transactionExecutor$1.TransactionExecutor=TransactionExecutor;var urlUtil$2={},__assign$s=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$s=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__read$a=commonjsGlobal&&commonjsGlobal.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(o=i.next()).done;)a.push(o.value)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},util_1$4=(Object.defineProperty(urlUtil$2,"__esModule",{value:!0}),urlUtil$2.Url=urlUtil$2.formatIPv6Address=urlUtil$2.formatIPv4Address=urlUtil$2.defaultPortForScheme=urlUtil$2.parseDatabaseUrl=void 0,util$4),DEFAULT_BOLT_PORT=7687,DEFAULT_HTTP_PORT=7474,DEFAULT_HTTPS_PORT=7473,Url=function(e,t,r,o,n){this.scheme=e,this.host=t,this.port=r,this.hostAndPort=o,this.query=n};function parseDatabaseUrl(e){(0,util_1$4.assertString)(e,"URL");var t=sanitizeUrl(e),r=uriJsParse(t.url),t=t.schemeMissing?null:extractScheme(r.scheme),o=extractHost(r.host),n=formatHost(o),i=extractPort(r.port,t),n="".concat(n,":").concat(i),a=extractQuery(null!=(a=r.query)?a:extractResourceQueryString(r.resourceName),e);return new Url(t,o,i,n,a)}function extractResourceQueryString(e){return"string"!=typeof e?null:__read$a(e.split("?"),2)[1]}function sanitizeUrl(e){return(e=e.trim()).includes("://")?{schemeMissing:!1,url:e}:{schemeMissing:!0,url:"none://".concat(e)}}function extractScheme(e){return null!=e?":"===(e=e.trim()).charAt(e.length-1)?e.substring(0,e.length-1):e:null}function extractHost(e,t){if(null==e)throw new Error("Unable to extract host from null or undefined URL");return e.trim()}function extractPort(e,t){e="string"==typeof e?parseInt(e,10):e;return null==e||isNaN(e)?defaultPortForScheme(t):e}function extractQuery(e,r){var e=null!=e?trimAndSanitizeQuery(e):null,o={};return null!=e&&e.split("&").forEach(function(e){e=e.split("=");if(2!==e.length)throw new Error("Invalid parameters: '".concat(e.toString(),"' in URL '").concat(r,"'."));var t=trimAndVerifyQueryElement(e[0],"key",r),e=trimAndVerifyQueryElement(e[1],"value",r);if(void 0!==o[t])throw new Error("Duplicated query parameters with key '".concat(t,"' in URL '").concat(r,"'"));o[t]=e}),o}function trimAndSanitizeQuery(e){return e="?"===(null==(e=(null!=e?e:"").trim())?void 0:e.charAt(0))?e.substring(1,e.length):e}function trimAndVerifyQueryElement(e,t,r){if(""===(e=(null!=e?e:"").trim()))throw new Error("Illegal empty ".concat(t," in URL query '").concat(r,"'"));return e}function escapeIPv6Address(e){var t="["===e.charAt(0),r="]"===e.charAt(e.length-1);if(t||r){if(t&&r)return e;throw new Error("Illegal IPv6 address ".concat(e))}return"[".concat(e,"]")}function formatHost(e){if(""===e||null==e)throw new Error("Illegal host ".concat(e));return e.includes(":")?escapeIPv6Address(e):e}function formatIPv4Address(e,t){return"".concat(e,":").concat(t)}function formatIPv6Address(e,t){e=escapeIPv6Address(e);return"".concat(e,":").concat(t)}function defaultPortForScheme(e){return"http"===e?DEFAULT_HTTP_PORT:"https"===e?DEFAULT_HTTPS_PORT:DEFAULT_BOLT_PORT}function uriJsParse(e){function a(e,t){t=e.indexOf(t);return 0<=t?[e.substring(0,t),e[t],e.substring(t+1)]:[e,"",""]}function t(e){var t,r={},o=((t="@")===(t=0<=(t=(n=e).lastIndexOf(t))?[n.substring(0,t),n[t],n.substring(t+1)]:["","",n])[1]&&(r.userInfo=decodeURIComponent(t[0]),e=t[2]),__read$a((n="]",o=a(o=e,i="["),[(i=a(o[2],n))[0],i[2]]),2)),n=o[0],i=o[1];return""!==n?(r.host=n,t=a(i,":")):(t=a(e,":"),r.host=t[0]),":"===t[1]&&(r.port=t[2]),r}var r={},o=a(e,":");return":"===o[1]&&(r.scheme=decodeURIComponent(o[0]),e=o[2]),"#"===(o=a(e,"#"))[1]&&(r.fragment=decodeURIComponent(o[2]),e=o[0]),"?"===(o=a(e,"?"))[1]&&(r.query=o[2],e=o[0]),e.startsWith("//")?(o=a(e.substr(2),"/"),(r=__assign$s(__assign$s({},r),t(o[0]))).path=o[1]+o[2]):r.path=e,r}urlUtil$2.Url=Url,urlUtil$2.parseDatabaseUrl=parseDatabaseUrl,urlUtil$2.formatIPv4Address=formatIPv4Address,urlUtil$2.formatIPv6Address=formatIPv6Address,urlUtil$2.defaultPortForScheme=defaultPortForScheme;var serverAddress$1={},__createBinding$8=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&("get"in n?t.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){e[o=void 0===o?r:o]=t[r]}),__setModuleDefault$8=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar$8=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding$8(t,e,r);return __setModuleDefault$8(t,e),t},util_1$3=(Object.defineProperty(serverAddress$1,"__esModule",{value:!0}),serverAddress$1.ServerAddress=void 0,util$4),urlUtil$1=__importStar$8(urlUtil$2),ServerAddress$1=function(){function t(e,t,r,o){this._host=(0,util_1$3.assertString)(e,"host"),this._resolved=null!=t?(0,util_1$3.assertString)(t,"resolved"):null,this._port=(0,util_1$3.assertNumber)(r,"port"),this._hostPort=o,this._stringValue=null!=t?"".concat(o,"(").concat(t,")"):"".concat(o)}return t.prototype.host=function(){return this._host},t.prototype.resolvedHost=function(){return null!=this._resolved?this._resolved:this._host},t.prototype.port=function(){return this._port},t.prototype.resolveWith=function(e){return new t(this._host,e,this._port,this._hostPort)},t.prototype.asHostPort=function(){return this._hostPort},t.prototype.asKey=function(){return this._hostPort},t.prototype.toString=function(){return this._stringValue},t.fromUrl=function(e){e=urlUtil$1.parseDatabaseUrl(e);return new t(e.host,null,e.port,e.hostAndPort)},t}(),resolver$1=(serverAddress$1.ServerAddress=ServerAddress$1,{}),baseHostNameResolver={},BaseHostNameResolver$1=(Object.defineProperty(baseHostNameResolver,"__esModule",{value:!0}),function(){function e(){}return e.prototype.resolve=function(){throw new Error("Abstract function")},e.prototype._resolveToItself=function(e){return Promise.resolve([e])},e}()),configuredCustomResolver=(baseHostNameResolver.default=BaseHostNameResolver$1,{}),server_address_1=(Object.defineProperty(configuredCustomResolver,"__esModule",{value:!0}),serverAddress$1);function resolveToSelf(e){return Promise.resolve([e])}var ConfiguredCustomResolver=function(){function e(e){this._resolverFunction=null!=e?e:resolveToSelf}return e.prototype.resolve=function(t){var r=this;return new Promise(function(e){return e(r._resolverFunction(t.asHostPort()))}).then(function(e){if(Array.isArray(e))return e.map(function(e){return server_address_1.ServerAddress.fromUrl(e)});throw new TypeError("Configured resolver function should either return an array of addresses or a Promise resolved with an array of addresses."+"Each address is '<host>:<port>'. Got: ".concat(e))})},e}(),__importDefault$U=(configuredCustomResolver.default=ConfiguredCustomResolver,commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}}),base_host_name_resolver_1=(Object.defineProperty(resolver$1,"__esModule",{value:!0}),resolver$1.ConfiguredCustomResolver=resolver$1.BaseHostNameResolver=void 0,__importDefault$U(baseHostNameResolver)),configured_custom_resolver_1$1=(resolver$1.BaseHostNameResolver=base_host_name_resolver_1.default,__importDefault$U(configuredCustomResolver)),browser$1=(resolver$1.ConfiguredCustomResolver=configured_custom_resolver_1$1.default,{}),boltAgent$1={};function fromVersion(e,t){var t=(t=void 0===t?function(){return{get userAgent(){}}}:t)(),r=null!=t.userAgent?t.userAgent.split("(")[1].split(")")[0]:void 0,t=t.userAgent||void 0;return{product:"neo4j-javascript/".concat(e),platform:r,languageDetails:t}}Object.defineProperty(boltAgent$1,"__esModule",{value:!0}),boltAgent$1.fromVersion=void 0,boltAgent$1.fromVersion=fromVersion,function(e){var o=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&("get"in n?t.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){e[o=void 0===o?r:o]=t[r]}),t=commonjsGlobal&&commonjsGlobal.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),t(boltAgent$1,e)}(browser$1);var pool$2={},poolConfig={},DEFAULT_MAX_SIZE=(Object.defineProperty(poolConfig,"__esModule",{value:!0}),poolConfig.DEFAULT_ACQUISITION_TIMEOUT=poolConfig.DEFAULT_MAX_SIZE=void 0,100),DEFAULT_ACQUISITION_TIMEOUT=(poolConfig.DEFAULT_MAX_SIZE=DEFAULT_MAX_SIZE,6e4),PoolConfig$1=(poolConfig.DEFAULT_ACQUISITION_TIMEOUT=DEFAULT_ACQUISITION_TIMEOUT,function(){function t(e,t){this.maxSize=valueOrDefault$1(e,DEFAULT_MAX_SIZE),this.acquisitionTimeout=valueOrDefault$1(t,DEFAULT_ACQUISITION_TIMEOUT)}return t.defaultConfig=function(){return new t(DEFAULT_MAX_SIZE,DEFAULT_ACQUISITION_TIMEOUT)},t.fromDriverConfig=function(e){return new t(isConfigured(e.maxConnectionPoolSize)?e.maxConnectionPoolSize:DEFAULT_MAX_SIZE,isConfigured(e.connectionAcquisitionTimeout)?e.connectionAcquisitionTimeout:DEFAULT_ACQUISITION_TIMEOUT)},t}());function valueOrDefault$1(e,t){return isConfigured(e)?e:t}function isConfigured(e){return 0===e||null!=e}poolConfig.default=PoolConfig$1;var pool$1={},__awaiter$g=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function o(e){try{i(u.next(e))}catch(e){t(e)}}function n(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(o,n)}i((u=u.apply(e,a||[])).next())})},__generator$g=commonjsGlobal&&commonjsGlobal.__generator||function(o,n){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=n.call(o,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__importDefault$T=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},pool_config_1=(Object.defineProperty(pool$1,"__esModule",{value:!0}),__importDefault$T(poolConfig)),error_1$5=error,logger_1$1=logger$1,Pool$1=function(){function e(e){var t=e.create,t=void 0===t?function(e,t,r){return __awaiter$g(u,void 0,void 0,function(){return __generator$g(this,function(e){switch(e.label){case 0:return[4,Promise.reject(new Error("Not implemented"))];case 1:return[2,e.sent()]}})})}:t,r=e.destroy,r=void 0===r?function(e){return __awaiter$g(u,void 0,void 0,function(){return __generator$g(this,function(e){switch(e.label){case 0:return[4,Promise.resolve()];case 1:return[2,e.sent()]}})})}:r,o=e.validateOnAcquire,o=void 0===o?function(e,t){return!0}:o,n=e.validateOnRelease,n=void 0===n?function(e){return!0}:n,i=e.installIdleObserver,i=void 0===i?function(e,t){}:i,a=e.removeIdleObserver,a=void 0===a?function(e){}:a,s=e.config,s=void 0===s?pool_config_1.default.defaultConfig():s,e=e.log,e=void 0===e?logger_1$1.Logger.noOp():e,u=this;this._create=t,this._destroy=r,this._validateOnAcquire=o,this._validateOnRelease=n,this._installIdleObserver=i,this._removeIdleObserver=a,this._maxSize=s.maxSize,this._acquisitionTimeout=s.acquisitionTimeout,this._pools={},this._pendingCreates={},this._acquireRequests={},this._activeResourceCounts={},this._release=this._release.bind(this),this._log=e,this._closed=!1}return e.prototype.acquire=function(s,u,c){return __awaiter$g(this,void 0,void 0,function(){var n,i,a=this;return __generator$g(this,function(e){switch(e.label){case 0:return n=u.asKey(),i=this._acquireRequests,null==i[n]&&(i[n]=[]),[4,new Promise(function(e,t){var r=setTimeout(function(){var e,t=i[n];null!=t&&(i[n]=t.filter(function(e){return e!==o})),o.isCompleted()||(t=a.activeResourceCount(u),e=a.has(u)?a._pools[n].length:0,o.reject((0,error_1$5.newError)("Connection acquisition timed out in ".concat(a._acquisitionTimeout," ms. Pool status: Active conn count = ").concat(t,", Idle conn count = ").concat(e,"."))))},a._acquisitionTimeout),o=("object"==typeof r&&r.unref(),new PendingRequest(n,s,c,e,t,r,a._log));i[n].push(o),a._processPendingAcquireRequests(u)})];case 1:return[2,e.sent()]}})})},e.prototype.purge=function(t){return __awaiter$g(this,void 0,void 0,function(){return __generator$g(this,function(e){switch(e.label){case 0:return[4,this._purgeKey(t.asKey())];case 1:return[2,e.sent()]}})})},e.prototype.apply=function(e,t){e=e.asKey();e in this._pools&&this._pools[e].apply(t)},e.prototype.close=function(){return __awaiter$g(this,void 0,void 0,function(){var r=this;return __generator$g(this,function(e){switch(e.label){case 0:return this._closed=!0,[4,Promise.all(Object.keys(this._pools).map(function(t){return __awaiter$g(r,void 0,void 0,function(){return __generator$g(this,function(e){switch(e.label){case 0:return[4,this._purgeKey(t)];case 1:return[2,e.sent()]}})})})).then()];case 1:return[2,e.sent()]}})})},e.prototype.keepAll=function(n){return __awaiter$g(this,void 0,void 0,function(){var t,r,o=this;return __generator$g(this,function(e){switch(e.label){case 0:return t=n.map(function(e){return e.asKey()}),r=Object.keys(this._pools),r=r.filter(function(e){return!t.includes(e)}),[4,Promise.all(r.map(function(t){return __awaiter$g(o,void 0,void 0,function(){return __generator$g(this,function(e){switch(e.label){case 0:return[4,this._purgeKey(t)];case 1:return[2,e.sent()]}})})})).then()];case 1:return[2,e.sent()]}})})},e.prototype.has=function(e){return e.asKey()in this._pools},e.prototype.activeResourceCount=function(e){return null!=(e=this._activeResourceCounts[e.asKey()])?e:0},e.prototype._getOrInitializePoolFor=function(e){var t=this._pools[e];return null==t&&(t=new SingleAddressPool,this._pools[e]=t,this._pendingCreates[e]=0),t},e.prototype._acquire=function(c,l,_){return __awaiter$g(this,void 0,void 0,function(){var t,o,r,n,i,a,s,u=this;return __generator$g(this,function(e){switch(e.label){case 0:if(this._closed)throw(0,error_1$5.newError)("Pool is closed, it is no more able to serve requests.");if(t=l.asKey(),o=this._getOrInitializePoolFor(t),_)return[3,10];e.label=1;case 1:if(!(0<o.length))return[3,10];if(null==(r=o.pop()))return[3,1];resourceAcquired(t,this._activeResourceCounts),null!=this._removeIdleObserver&&this._removeIdleObserver(r),n=!1,e.label=2;case 2:return e.trys.push([2,4,,6]),[4,this._validateOnAcquire(c,r)];case 3:return n=e.sent(),[3,6];case 4:return i=e.sent(),resourceReleased(t,this._activeResourceCounts),o.removeInUse(r),[4,this._destroy(r)];case 5:throw e.sent(),i;case 6:return n?(this._log.isDebugEnabled()&&this._log.debug("".concat(r," acquired from the pool ").concat(t)),[2,{resource:r,pool:o}]):[3,7];case 7:return resourceReleased(t,this._activeResourceCounts),o.removeInUse(r),[4,this._destroy(r)];case 8:e.sent(),e.label=9;case 9:return[3,1];case 10:if(0<this._maxSize&&this.activeResourceCount(l)+this._pendingCreates[t]>=this._maxSize)return[2,{resource:null,pool:o}];this._pendingCreates[t]=this._pendingCreates[t]+1,e.label=11;case 11:return(e.trys.push([11,,15,16]),this.activeResourceCount(l)+o.length>=this._maxSize&&_)?null==(s=o.pop())?[3,13]:(null!=this._removeIdleObserver&&this._removeIdleObserver(s),o.removeInUse(s),[4,this._destroy(s)]):[3,13];case 12:e.sent(),e.label=13;case 13:return[4,this._create(c,l,function(t,r){return __awaiter$g(u,void 0,void 0,function(){return __generator$g(this,function(e){switch(e.label){case 0:return[4,this._release(t,r,o)];case 1:return[2,e.sent()]}})})})];case 14:return a=e.sent(),o.pushInUse(a),resourceAcquired(t,this._activeResourceCounts),this._log.isDebugEnabled()&&this._log.debug("".concat(a," created for the pool ").concat(t)),[3,16];case 15:return this._pendingCreates[t]=this._pendingCreates[t]-1,[7];case 16:return[2,{resource:a,pool:o}]}})})},e.prototype._release=function(o,n,i){return __awaiter$g(this,void 0,void 0,function(){var t,r=this;return __generator$g(this,function(e){switch(e.label){case 0:t=o.asKey(),e.label=1;case 1:return(e.trys.push([1,,9,10]),i.isActive())?[4,this._validateOnRelease(n)]:[3,6];case 2:return e.sent()?[3,4]:(this._log.isDebugEnabled()&&this._log.debug("".concat(n," destroyed and can't be released to the pool ").concat(t," because it is not functional")),i.removeInUse(n),[4,this._destroy(n)]);case 3:return e.sent(),[3,5];case 4:null!=this._installIdleObserver&&this._installIdleObserver(n,{onError:function(e){r._log.debug("Idle connection ".concat(n," destroyed because of error: ").concat(e));e=r._pools[t];null!=e&&(r._pools[t]=e.filter(function(e){return e!==n}),e.removeInUse(n)),r._destroy(n).catch(function(){})}}),i.push(n),this._log.isDebugEnabled()&&this._log.debug("".concat(n," released to the pool ").concat(t)),e.label=5;case 5:return[3,8];case 6:return this._log.isDebugEnabled()&&this._log.debug("".concat(n," destroyed and can't be released to the pool ").concat(t," because pool has been purged")),i.removeInUse(n),[4,this._destroy(n)];case 7:e.sent(),e.label=8;case 8:return[3,10];case 9:return resourceReleased(t,this._activeResourceCounts),this._processPendingAcquireRequests(o),[7];case 10:return[2]}})})},e.prototype._purgeKey=function(n){return __awaiter$g(this,void 0,void 0,function(){var t,r,o;return __generator$g(this,function(e){switch(e.label){case 0:if(t=this._pools[n],r=[],null==t)return[3,2];for(;0<t.length;)null!=(o=t.pop())&&(null!=this._removeIdleObserver&&this._removeIdleObserver(o),r.push(this._destroy(o)));return t.close(),delete this._pools[n],[4,Promise.all(r)];case 1:e.sent(),e.label=2;case 2:return[2]}})})},e.prototype._processPendingAcquireRequests=function(r){var o,n=this,i=r.asKey(),e=this._acquireRequests[i];null!=e&&(null!=(o=e.shift())?this._acquire(o.context,r,o.requireNew).catch(function(e){return o.reject(e),{resource:null,pool:null}}).then(function(e){var t=e.resource,e=e.pool;null!=t&&null!=e?o.isCompleted()?n._release(r,t,e).catch(function(e){n._log.isDebugEnabled()&&n._log.debug("".concat(t," could not be release back to the pool. Cause: ").concat(e))}):o.resolve(t):o.isCompleted()||(null==n._acquireRequests[i]&&(n._acquireRequests[i]=[]),n._acquireRequests[i].unshift(o))}).catch(function(e){return o.reject(e)}):delete this._acquireRequests[i])},e}();function resourceAcquired(e,t){var r=null!=(r=t[e])?r:0;t[e]=r+1}function resourceReleased(e,t){var r=(null!=(r=t[e])?r:0)-1;0<r?t[e]=r:delete t[e]}var PendingRequest=function(){function e(e,t,r,o,n,i,a){this._key=e,this._context=t,this._resolve=o,this._reject=n,this._timeoutId=i,this._log=a,this._completed=!1,this._config=null!=r?r:{}}return Object.defineProperty(e.prototype,"context",{get:function(){return this._context},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"requireNew",{get:function(){var e;return null!=(e=this._config.requireNew)&&e},enumerable:!1,configurable:!0}),e.prototype.isCompleted=function(){return this._completed},e.prototype.resolve=function(e){this._completed||(this._completed=!0,clearTimeout(this._timeoutId),this._log.isDebugEnabled()&&this._log.debug("".concat(e," acquired from the pool ").concat(this._key)),this._resolve(e))},e.prototype.reject=function(e){this._completed||(this._completed=!0,clearTimeout(this._timeoutId),this._reject(e))},e}(),SingleAddressPool=function(){function e(){this._active=!0,this._elements=[],this._elementsInUse=new Set}return e.prototype.isActive=function(){return this._active},e.prototype.close=function(){this._active=!1,this._elements=[],this._elementsInUse=new Set},e.prototype.filter=function(e){return this._elements=this._elements.filter(e),this},e.prototype.apply=function(e){this._elements.forEach(e),this._elementsInUse.forEach(e)},Object.defineProperty(e.prototype,"length",{get:function(){return this._elements.length},enumerable:!1,configurable:!0}),e.prototype.pop=function(){var e=this._elements.pop();return null!=e&&this._elementsInUse.add(e),e},e.prototype.push=function(e){return this._elementsInUse.delete(e),this._elements.push(e)},e.prototype.pushInUse=function(e){this._elementsInUse.add(e)},e.prototype.removeInUse=function(e){this._elementsInUse.delete(e)},e}(),__createBinding$7=(pool$1.default=Pool$1,!function(e){var o=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&("get"in n?t.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){e[o=void 0===o?r:o]=t[r]}),n=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),t=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&o(t,e,r);return n(t,e),t},r=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},i=(Object.defineProperty(e,"__esModule",{value:!0}),e.DEFAULT_MAX_SIZE=e.DEFAULT_ACQUISITION_TIMEOUT=e.PoolConfig=e.Pool=void 0,t(poolConfig)),t=(e.PoolConfig=i.default,Object.defineProperty(e,"DEFAULT_ACQUISITION_TIMEOUT",{enumerable:!0,get:function(){return i.DEFAULT_ACQUISITION_TIMEOUT}}),Object.defineProperty(e,"DEFAULT_MAX_SIZE",{enumerable:!0,get:function(){return i.DEFAULT_MAX_SIZE}}),r(pool$1));e.Pool=t.default,e.default=t.default}(pool$2),commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&("get"in n?t.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){e[o=void 0===o?r:o]=t[r]})),__setModuleDefault$7=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar$7=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding$7(t,e,r);return __setModuleDefault$7(t,e),t},util=(Object.defineProperty(internal,"__esModule",{value:!0}),internal.pool=internal.boltAgent=internal.objectUtil=internal.resolver=internal.serverAddress=internal.urlUtil=internal.logger=internal.transactionExecutor=internal.txConfig=internal.connectionHolder=internal.constants=internal.bookmarks=internal.observer=internal.temporalUtil=internal.util=void 0,__importStar$7(util$4)),temporalUtil=(internal.util=util,__importStar$7(temporalUtil$1)),observer=(internal.temporalUtil=temporalUtil,__importStar$7(observers)),bookmarks=(internal.observer=observer,__importStar$7(bookmarks$1)),constants=(internal.bookmarks=bookmarks,__importStar$7(constants$1)),connectionHolder=(internal.constants=constants,__importStar$7(connectionHolder$1)),txConfig=(internal.connectionHolder=connectionHolder,__importStar$7(txConfig$1)),transactionExecutor=(internal.txConfig=txConfig,__importStar$7(transactionExecutor$1)),logger=(internal.transactionExecutor=transactionExecutor,__importStar$7(logger$1)),urlUtil=(internal.logger=logger,__importStar$7(urlUtil$2)),serverAddress=(internal.urlUtil=urlUtil,__importStar$7(serverAddress$1)),resolver=(internal.serverAddress=serverAddress,__importStar$7(resolver$1)),objectUtil$1=(internal.resolver=resolver,__importStar$7(objectUtil$2)),boltAgent=(internal.objectUtil=objectUtil$1,__importStar$7(browser$1)),pool=(internal.boltAgent=boltAgent,__importStar$7(pool$2)),notification=(internal.pool=pool,{}),__assign$r=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$r=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__createBinding$6=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&("get"in n?t.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){e[o=void 0===o?r:o]=t[r]}),__setModuleDefault$6=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar$6=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding$6(t,e,r);return __setModuleDefault$6(t,e),t},__read$9=commonjsGlobal&&commonjsGlobal.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(o=i.next()).done;)a.push(o.value)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},__spreadArray$4=commonjsGlobal&&commonjsGlobal.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var o,n=0,i=t.length;n<i;n++)!o&&n in t||((o=o||Array.prototype.slice.call(t,0,n))[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))},json$1=(Object.defineProperty(notification,"__esModule",{value:!0}),notification.buildNotificationsFromMetadata=notification.buildGqlStatusObjectFromMetadata=notification.polyfillNotification=notification.polyfillGqlStatusObject=notification.GqlStatusObject=notification.Notification=notification.notificationClassification=notification.notificationCategory=notification.notificationSeverityLevel=void 0,__importStar$6(json$3)),internal_1$3=internal,gql_constants_1=gqlConstants,unknownGqlStatus={WARNING:{gql_status:"01N42",status_description:"warn: unknown warning"},NO_DATA:{gql_status:"02N42",status_description:"note: no data - unknown subcondition"},INFORMATION:{gql_status:"03N42",status_description:"info: unknown notification"},ERROR:{gql_status:"50N42",status_description:"error: general processing exception - unexpected error"}},notificationSeverityLevel={WARNING:"WARNING",INFORMATION:"INFORMATION",UNKNOWN:"UNKNOWN"},severityLevels=(notification.notificationSeverityLevel=notificationSeverityLevel,Object.freeze(notificationSeverityLevel),Object.values(notificationSeverityLevel)),notificationCategory={HINT:"HINT",UNRECOGNIZED:"UNRECOGNIZED",UNSUPPORTED:"UNSUPPORTED",PERFORMANCE:"PERFORMANCE",DEPRECATION:"DEPRECATION",TOPOLOGY:"TOPOLOGY",SECURITY:"SECURITY",GENERIC:"GENERIC",SCHEMA:"SCHEMA",UNKNOWN:"UNKNOWN"},categories=(notification.notificationCategory=notificationCategory,Object.freeze(notificationCategory),Object.values(notificationCategory)),notificationClassification=notificationCategory,Notification=(notification.notificationClassification=notificationClassification,function(e){this.code=e.code,this.title=e.title,this.description=e.description,this.severity=e.severity,this.position=_constructPosition(e.position),this.severityLevel=_asEnumerableSeverity(e.severity),this.rawSeverityLevel=e.severity,this.category=_asEnumerableClassification(e.category),this.rawCategory=e.category}),GqlStatusObject=(notification.Notification=Notification,function(){function e(e){var t;this.gqlStatus=e.gql_status,this.statusDescription=e.status_description,this.diagnosticRecord=null!=(t=e.diagnostic_record)?t:{},this.position=null!=this.diagnosticRecord._position?_constructPosition(this.diagnosticRecord._position):void 0,this.severity=_asEnumerableSeverity(this.diagnosticRecord._severity),this.rawSeverity=this.diagnosticRecord._severity,this.classification=_asEnumerableClassification(this.diagnosticRecord._classification),this.rawClassification=this.diagnosticRecord._classification,this.isNotification=null!=e.neo4j_code,Object.freeze(this)}return Object.defineProperty(e.prototype,"diagnosticRecordAsJsonString",{get:function(){return json$1.stringify(this.diagnosticRecord,{useCustomToString:!0})},enumerable:!1,configurable:!0}),e}());function polyfillNotification(e){var t;if(null!=e.neo4j_code)return new Notification({code:e.neo4j_code,title:e.title,description:e.description,severity:null==(t=e.diagnostic_record)?void 0:t._severity,category:null==(t=e.diagnostic_record)?void 0:t._classification,position:null==(t=e.diagnostic_record)?void 0:t._position})}function polyfillGqlStatusObject(e){var t=e.severity===notificationSeverityLevel.WARNING?unknownGqlStatus.WARNING:unknownGqlStatus.INFORMATION,r={gql_status:t.gql_status,status_description:null!=(r=e.description)?r:t.status_description,neo4j_code:e.code,title:e.title,diagnostic_record:__assign$r({},gql_constants_1.rawPolyfilledDiagnosticRecord)};return null!=e.severity&&(r.diagnostic_record._severity=e.severity),null!=e.category&&(r.diagnostic_record._classification=e.category),null!=e.position&&(r.diagnostic_record._position=e.position),new GqlStatusObject(r)}notification.GqlStatusObject=GqlStatusObject,notification.polyfillNotification=polyfillNotification,notification.polyfillGqlStatusObject=polyfillGqlStatusObject;var staticGqlStatusObjects={SUCCESS:new GqlStatusObject({gql_status:"00000",status_description:"note: successful completion",diagnostic_record:gql_constants_1.rawPolyfilledDiagnosticRecord}),NO_DATA:new GqlStatusObject({gql_status:"02000",status_description:"note: no data",diagnostic_record:gql_constants_1.rawPolyfilledDiagnosticRecord}),NO_DATA_UNKNOWN_SUBCONDITION:new GqlStatusObject(__assign$r(__assign$r({},unknownGqlStatus.NO_DATA),{diagnostic_record:gql_constants_1.rawPolyfilledDiagnosticRecord})),OMITTED_RESULT:new GqlStatusObject({gql_status:"00001",status_description:"note: successful completion - omitted result",diagnostic_record:gql_constants_1.rawPolyfilledDiagnosticRecord})};function buildGqlStatusObjectFromMetadata(e){var t;return null!=e.statuses?e.statuses.map(function(e){return new GqlStatusObject(e)}):(t=!0===(null==(t=e.stream_summary)?void 0:t.have_records_streamed)?staticGqlStatusObjects.SUCCESS:!1===(null==t?void 0:t.has_keys)?staticGqlStatusObjects.OMITTED_RESULT:!0===(null==t?void 0:t.pulled)?staticGqlStatusObjects.NO_DATA:staticGqlStatusObjects.NO_DATA_UNKNOWN_SUBCONDITION,__spreadArray$4([t],__read$9(null!=(e=null==(t=e.notifications)?void 0:t.map(polyfillGqlStatusObject))?e:[]),!1).sort(function(e,t){return calculateWeight(e)-calculateWeight(t)}))}Object.freeze(staticGqlStatusObjects),notification.buildGqlStatusObjectFromMetadata=buildGqlStatusObjectFromMetadata;var gqlStatusWeightByClass=Object.freeze({"02":0,"01":1,"00":2});function calculateWeight(e){var e=null==(e=e.gqlStatus)?void 0:e.slice(0,2);return null!=(e=gqlStatusWeightByClass[e])?e:9999}function buildNotificationsFromMetadata(e){return null!=e.notifications?e.notifications.map(function(e){return new Notification(e)}):null!=e.statuses?e.statuses.map(polyfillNotification).filter(function(e){return null!=e}):[]}function _constructPosition(e){return null==e?{}:{offset:internal_1$3.util.toNumber(e.offset),line:internal_1$3.util.toNumber(e.line),column:internal_1$3.util.toNumber(e.column)}}function _asEnumerableSeverity(e){return severityLevels.includes(e)?e:notificationSeverityLevel.UNKNOWN}function _asEnumerableClassification(e){return categories.includes(e)?e:notificationClassification.UNKNOWN}notification.buildNotificationsFromMetadata=buildNotificationsFromMetadata,notification.default=Notification,Object.defineProperty(resultSummary,"__esModule",{value:!0}),resultSummary.Stats=resultSummary.QueryStatistics=resultSummary.ProfiledPlan=resultSummary.Plan=resultSummary.ServerInfo=resultSummary.queryType=void 0;var internal_1$2=internal,notification_1=notification,ResultSummary=function(){function e(e,t,r,o){this.query={text:e,parameters:t},this.queryType=r.type,this.counters=new QueryStatistics(null!=(e=r.stats)?e:{}),this.updateStatistics=this.counters,this.plan=(null!=r.plan||null!=r.profile)&&new Plan(null!=(t=r.plan)?t:r.profile),this.profile=null!=r.profile&&new ProfiledPlan(r.profile),this.notifications=(0,notification_1.buildNotificationsFromMetadata)(r),this.gqlStatusObjects=(0,notification_1.buildGqlStatusObjectFromMetadata)(r),this.server=new ServerInfo(r.server,o),this.resultConsumedAfter=r.result_consumed_after,this.resultAvailableAfter=r.result_available_after,this.database={name:null!=(e=r.db)?e:null}}return e.prototype.hasPlan=function(){return this.plan instanceof Plan},e.prototype.hasProfile=function(){return this.profile instanceof ProfiledPlan},e}(),Plan=function t(e){this.operatorType=e.operatorType,this.identifiers=e.identifiers,this.arguments=e.args,this.children=null!=e.children?e.children.map(function(e){return new t(e)}):[]},ProfiledPlan=(resultSummary.Plan=Plan,function(){function t(e){this.operatorType=e.operatorType,this.identifiers=e.identifiers,this.arguments=e.args,this.dbHits=valueOrDefault("dbHits",e),this.rows=valueOrDefault("rows",e),this.pageCacheMisses=valueOrDefault("pageCacheMisses",e),this.pageCacheHits=valueOrDefault("pageCacheHits",e),this.pageCacheHitRatio=valueOrDefault("pageCacheHitRatio",e),this.time=valueOrDefault("time",e),this.children=null!=e.children?e.children.map(function(e){return new t(e)}):[]}return t.prototype.hasPageCacheStats=function(){return 0<this.pageCacheMisses||0<this.pageCacheHits||0<this.pageCacheHitRatio},t}()),Stats=(resultSummary.ProfiledPlan=ProfiledPlan,function(){this.nodesCreated=0,this.nodesDeleted=0,this.relationshipsCreated=0,this.relationshipsDeleted=0,this.propertiesSet=0,this.labelsAdded=0,this.labelsRemoved=0,this.indexesAdded=0,this.indexesRemoved=0,this.constraintsAdded=0,this.constraintsRemoved=0}),QueryStatistics=(resultSummary.Stats=Stats,function(){function e(r){var o=this;this._stats={nodesCreated:0,nodesDeleted:0,relationshipsCreated:0,relationshipsDeleted:0,propertiesSet:0,labelsAdded:0,labelsRemoved:0,indexesAdded:0,indexesRemoved:0,constraintsAdded:0,constraintsRemoved:0},this._systemUpdates=0,Object.keys(r).forEach(function(e){var t=e.replace(/(-\w)/g,function(e){return e[1].toUpperCase()});t in o._stats?o._stats[t]=internal_1$2.util.toNumber(r[e]):"systemUpdates"===t?o._systemUpdates=internal_1$2.util.toNumber(r[e]):"containsSystemUpdates"===t?o._containsSystemUpdates=r[e]:"containsUpdates"===t&&(o._containsUpdates=r[e])}),this._stats=Object.freeze(this._stats)}return e.prototype.containsUpdates=function(){var r=this;return void 0!==this._containsUpdates?this._containsUpdates:0<Object.keys(this._stats).reduce(function(e,t){return e+r._stats[t]},0)},e.prototype.updates=function(){return this._stats},e.prototype.containsSystemUpdates=function(){return void 0!==this._containsSystemUpdates?this._containsSystemUpdates:0<this._systemUpdates},e.prototype.systemUpdates=function(){return this._systemUpdates},e}()),ServerInfo=(resultSummary.QueryStatistics=QueryStatistics,function(e,t){null!=e&&(this.address=e.address,this.agent=e.version),this.protocolVersion=t});function valueOrDefault(e,t,r){return void 0===r&&(r=0),!1!==t&&e in t?(t=t[e],internal_1$2.util.toNumber(t)):r}resultSummary.ServerInfo=ServerInfo;var _a$f,queryType={READ_ONLY:"r",READ_WRITE:"rw",WRITE_ONLY:"w",SCHEMA_WRITE:"s"},notificationFilter=(resultSummary.queryType=queryType,resultSummary.default=ResultSummary,{}),notificationFilterMinimumSeverityLevel=(Object.defineProperty(notificationFilter,"__esModule",{value:!0}),notificationFilter.notificationFilterDisabledClassification=notificationFilter.notificationFilterDisabledCategory=notificationFilter.notificationFilterMinimumSeverityLevel=void 0,{OFF:"OFF",WARNING:"WARNING",INFORMATION:"INFORMATION"}),notificationFilterDisabledCategory=(notificationFilter.notificationFilterMinimumSeverityLevel=notificationFilterMinimumSeverityLevel,Object.freeze(notificationFilterMinimumSeverityLevel),{HINT:"HINT",UNRECOGNIZED:"UNRECOGNIZED",UNSUPPORTED:"UNSUPPORTED",PERFORMANCE:"PERFORMANCE",TOPOLOGY:"TOPOLOGY",SECURITY:"SECURITY",DEPRECATION:"DEPRECATION",GENERIC:"GENERIC",SCHEMA:"SCHEMA"}),notificationFilterDisabledClassification=(notificationFilter.notificationFilterDisabledCategory=notificationFilterDisabledCategory,Object.freeze(notificationFilterDisabledCategory),notificationFilterDisabledCategory),NotificationFilter=(notificationFilter.notificationFilterDisabledClassification=notificationFilterDisabledClassification,function(){throw this.minimumSeverityLevel=void 0,this.disabledCategories=void 0,this.disabledClassifications=void 0,new Error("Not implemented")}),result=(notificationFilter.default=NotificationFilter,{}),__awaiter$f=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function o(e){try{i(u.next(e))}catch(e){t(e)}}function n(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(o,n)}i((u=u.apply(e,a||[])).next())})},__generator$f=commonjsGlobal&&commonjsGlobal.__generator||function(o,n){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=n.call(o,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__importDefault$S=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},result_summary_1=(Object.defineProperty(result,"__esModule",{value:!0}),__importDefault$S(resultSummary)),internal_1$1=internal,error_1$4=error,EMPTY_CONNECTION_HOLDER=internal_1$1.connectionHolder.EMPTY_CONNECTION_HOLDER,DEFAULT_ON_ERROR=function(e){console.log("Uncaught error when processing result: "+e)},DEFAULT_ON_COMPLETED=function(e){},DEFAULT_ON_KEYS=function(e){},Result=function(){function e(e,t,r,o,n){void 0===n&&(n={high:Number.MAX_VALUE,low:Number.MAX_VALUE}),this[_a$f]="Result",this._stack=captureStacktrace(),this._streamObserverPromise=e,this._p=null,this._query=t,this._parameters=null!=r?r:{},this._connectionHolder=null!=o?o:EMPTY_CONNECTION_HOLDER,this._keys=null,this._summary=null,this._error=null,this._watermarks=n}return e.prototype.keys=function(){var o=this;return null!==this._keys?Promise.resolve(this._keys):null!==this._error?Promise.reject(this._error):new Promise(function(t,r){o._streamObserverPromise.then(function(e){return e.subscribe(o._decorateObserver({onKeys:function(e){return t(e)},onError:function(e){return r(e)}}))}).catch(r)})},e.prototype.summary=function(){var o=this;return null!==this._summary?Promise.resolve(this._summary):null!==this._error?Promise.reject(this._error):new Promise(function(t,r){o._streamObserverPromise.then(function(e){e.cancel(),e.subscribe(o._decorateObserver({onCompleted:function(e){return t(e)},onError:function(e){return r(e)}}))}).catch(r)})},e.prototype._getOrCreatePromise=function(){var e=this;return null==this._p&&(this._p=new Promise(function(t,r){var o=[];e.subscribe({onNext:function(e){o.push(e)},onCompleted:function(e){t({records:o,summary:e})},onError:function(e){r(e)}})})),this._p},e.prototype[Symbol.asyncIterator]=function(){var e,o,r,n,i,a=this;return this.isOpen()?(o={paused:!0,firstRun:!0,finished:!1},r=function(){var e,t;null!=o.streaming&&(e=(t=null!=(t=null==(t=o.queuedObserver)?void 0:t.size)?t:0)>=a._watermarks.high,t=t<=a._watermarks.low,e&&!o.paused?(o.paused=!0,o.streaming.pause()):(t&&o.paused||o.firstRun&&!e)&&(o.firstRun=!1,o.paused=!1,o.streaming.resume()))},n=function(){return __awaiter$f(a,void 0,void 0,function(){var t;return __generator$f(this,function(e){switch(e.label){case 0:return void 0!==o.queuedObserver?[3,2]:(o.queuedObserver=this._createQueuedResultObserver(r),t=o,[4,this._subscribe(o.queuedObserver,!0).catch(function(){})]);case 1:t.streaming=e.sent(),r(),e.label=2;case 2:return[2,o.queuedObserver]}})})},i=function(e){if(void 0===e)throw(0,error_1$4.newError)("InvalidState: Result stream finished without Summary",error_1$4.PROTOCOL_ERROR);return!0},{next:function(){return __awaiter$f(a,void 0,void 0,function(){var t;return __generator$f(this,function(e){switch(e.label){case 0:return o.finished&&i(o.summary)?[2,{done:!0,value:o.summary}]:[4,n()];case 1:return[4,e.sent().dequeue()];case 2:return!0===(t=e.sent()).done&&(o.finished=t.done,o.summary=t.value),[2,t]}})})},return:function(r){return __awaiter$f(a,void 0,void 0,function(){var t;return __generator$f(this,function(e){switch(e.label){case 0:return o.finished&&i(o.summary)?[2,{done:!0,value:null!=r?r:o.summary}]:(null!=(t=o.streaming)&&t.cancel(),[4,n()]);case 1:return[4,e.sent().dequeueUntilDone()];case 2:return t=e.sent(),o.finished=!0,t.value=null!=r?r:t.value,o.summary=t.value,[2,t]}})})},peek:function(){return __awaiter$f(a,void 0,void 0,function(){return __generator$f(this,function(e){switch(e.label){case 0:return o.finished&&i(o.summary)?[2,{done:!0,value:o.summary}]:[4,n()];case 1:return[4,e.sent().head()];case 2:return[2,e.sent()]}})})}}):(e=(0,error_1$4.newError)("Result is already consumed"),{next:function(){return Promise.reject(e)},peek:function(){return Promise.reject(e)}})},e.prototype.then=function(e,t){return this._getOrCreatePromise().then(e,t)},e.prototype.catch=function(e){return this._getOrCreatePromise().catch(e)},e.prototype.finally=function(e){return this._getOrCreatePromise().finally(e)},e.prototype.subscribe=function(e){this._subscribe(e).catch(function(){})},e.prototype.isOpen=function(){return null===this._summary&&null===this._error},e.prototype._subscribe=function(e,t){void 0===t&&(t=!1);var r=this._decorateObserver(e);return this._streamObserverPromise.then(function(e){return t&&e.pause(),e.subscribe(r),e}).catch(function(e){return null!=r.onError&&r.onError(e),Promise.reject(e)})},e.prototype._decorateObserver=function(t){var e,r=this,o=null!=(e=t.onCompleted)?e:DEFAULT_ON_COMPLETED,n=null!=(e=t.onError)?e:DEFAULT_ON_ERROR,i=null!=(e=t.onKeys)?e:DEFAULT_ON_KEYS;return{onNext:null!=t.onNext?t.onNext.bind(t):void 0,onKeys:function(e){return r._keys=e,i.call(t,e)},onCompleted:function(e){r._releaseConnectionAndGetSummary(e).then(function(e){return null!==r._summary?o.call(t,r._summary):(r._summary=e,o.call(t,e))}).catch(n)},onError:function(e){r._connectionHolder.releaseConnection().then(function(){replaceStacktrace(e,r._stack),r._error=e,n.call(t,e)}).catch(n)}}},e.prototype._cancel=function(){null===this._summary&&null===this._error&&this._streamObserverPromise.then(function(e){return e.cancel()}).catch(function(){})},e.prototype._releaseConnectionAndGetSummary=function(t){var e=internal_1$1.util.validateQueryAndParameters(this._query,this._parameters,{skipAsserts:!0}),r=e.validatedQuery,o=e.params,n=this._connectionHolder;return n.getConnection().then(function(e){return n.releaseConnection().then(function(){return null==e?void 0:e.getProtocolVersion()})},function(e){}).then(function(e){return new result_summary_1.default(r,o,t,e)})},e.prototype._createQueuedResultObserver=function(o){var e=this;function n(){var r={};return r.promise=new Promise(function(e,t){r.resolve=e,r.reject=t}),r}function i(e){return e instanceof Error}function r(){var r;return __awaiter$f(this,void 0,void 0,function(){var t;return __generator$f(this,function(e){switch(e.label){case 0:if(0<a.length){if(t=null!=(r=a.shift())?r:(0,error_1$4.newError)("Unexpected empty buffer",error_1$4.PROTOCOL_ERROR),o(),i(t))throw t;return[2,t]}return s.resolvable=n(),[4,s.resolvable.promise];case 1:return[2,e.sent()]}})})}var a=[],s={resolvable:null},t={onNext:function(e){t._push({done:!1,value:e})},onCompleted:function(e){t._push({done:!0,value:e})},onError:function(e){t._push(e)},_push:function(e){var t;null!==s.resolvable?(t=s.resolvable,s.resolvable=null,i(e)?t.reject(e):t.resolve(e)):(a.push(e),o())},dequeue:r,dequeueUntilDone:function(){return __awaiter$f(e,void 0,void 0,function(){var t;return __generator$f(this,function(e){switch(e.label){case 0:return[4,r()];case 1:return!0===(t=e.sent()).done?[2,t]:[3,0];case 2:return[2]}})})},head:function(){return __awaiter$f(e,void 0,void 0,function(){var t,r;return __generator$f(this,function(e){switch(e.label){case 0:if(0<a.length){if(i(t=a[0]))throw t;return[2,t]}s.resolvable=n(),e.label=1;case 1:return e.trys.push([1,3,4,5]),[4,s.resolvable.promise];case 2:return t=e.sent(),a.unshift(t),[2,t];case 3:throw r=e.sent(),a.unshift(r),r;case 4:return o(),[7];case 5:return[2]}})})},get size(){return a.length}};return t},e}();function captureStacktrace(){var e=new Error("");return null!=e.stack?e.stack.replace(/^Error(\n\r)*/,""):null}function replaceStacktrace(e,t){null!=t&&(e.stack=e.toString()+"\n"+t)}_a$f=Symbol.toStringTag,result.default=Result;var resultEager={},EagerResult=(Object.defineProperty(resultEager,"__esModule",{value:!0}),function(e,t,r){this.keys=e,this.records=t,this.summary=r}),connectionProvider$1=(resultEager.default=EagerResult,{}),Releasable=(Object.defineProperty(connectionProvider$1,"__esModule",{value:!0}),connectionProvider$1.Releasable=void 0,function(){function e(){}return e.prototype.release=function(){throw new Error("Not implemented")},e}()),ConnectionProvider=(connectionProvider$1.Releasable=Releasable,function(){function e(){}return e.prototype.acquireConnection=function(e){throw Error("Not implemented")},e.prototype.supportsMultiDb=function(){throw Error("Not implemented")},e.prototype.supportsTransactionConfig=function(){throw Error("Not implemented")},e.prototype.supportsUserImpersonation=function(){throw Error("Not implemented")},e.prototype.supportsSessionAuth=function(){throw Error("Not implemented")},e.prototype.verifyConnectivityAndGetServerInfo=function(e){throw Error("Not implemented")},e.prototype.verifyAuthentication=function(e){throw Error("Not implemented")},e.prototype.getNegotiatedProtocolVersion=function(){throw Error("Not Implemented")},e.prototype.close=function(){throw Error("Not implemented")},e}()),connection$2=(connectionProvider$1.default=ConnectionProvider,{}),Connection$1=(Object.defineProperty(connection$2,"__esModule",{value:!0}),function(){function e(){}return e.prototype.beginTransaction=function(e){throw new Error("Not implemented")},e.prototype.run=function(e,t,r){throw new Error("Not implemented")},e.prototype.commitTransaction=function(e){throw new Error("Not implemented")},e.prototype.rollbackTransaction=function(e){throw new Error("Not implemented")},e.prototype.resetAndFlush=function(){throw new Error("Not implemented")},e.prototype.isOpen=function(){throw new Error("Not implemented")},e.prototype.getProtocolVersion=function(){throw new Error("Not implemented")},e.prototype.hasOngoingObservableRequests=function(){throw new Error("Not implemented")},e}()),transaction=(connection$2.default=Connection$1,{}),__awaiter$e=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function o(e){try{i(u.next(e))}catch(e){t(e)}}function n(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(o,n)}i((u=u.apply(e,a||[])).next())})},__generator$e=commonjsGlobal&&commonjsGlobal.__generator||function(o,n){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=n.call(o,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__importDefault$R=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},util_1$2=(Object.defineProperty(transaction,"__esModule",{value:!0}),util$4),connection_holder_1$1=connectionHolder$1,bookmarks_1$2=bookmarks$1,tx_config_1$1=txConfig$1,observers_1$1=observers,error_1$3=error,result_1$1=__importDefault$R(result),Transaction=function(){function e(e){var t=e.connectionHolder,r=e.onClose,o=e.onBookmarks,n=e.onConnection,i=e.reactive,a=e.fetchSize,s=e.impersonatedUser,u=e.highRecordWatermark,c=e.lowRecordWatermark,l=e.notificationFilter,e=e.apiTelemetryConfig,_=this;this._connectionHolder=t,this._reactive=i,this._state=_states$1.ACTIVE,this._onClose=r,this._onBookmarks=o,this._onConnection=n,this._onError=this._onErrorCallback.bind(this),this._fetchSize=a,this._onComplete=this._onCompleteCallback.bind(this),this._results=[],this._impersonatedUser=s,this._lowRecordWatermak=c,this._highRecordWatermark=u,this._bookmarks=bookmarks_1$2.Bookmarks.empty(),this._notificationFilter=l,this._apiTelemetryConfig=e,this._acceptActive=function(){},this._activePromise=new Promise(function(e,t){_._acceptActive=e})}return e.prototype._begin=function(n,i,a){var t=this;this._connectionHolder.getConnection().then(function(o){return __awaiter$e(t,void 0,void 0,function(){var t,r=this;return __generator$e(this,function(e){switch(e.label){case 0:return(this._onConnection(),null==o)?[3,2]:(t=this,[4,n()]);case 1:return t._bookmarks=e.sent(),[2,o.beginTransaction({bookmarks:this._bookmarks,txConfig:i,mode:this._connectionHolder.mode(),database:this._connectionHolder.database(),impersonatedUser:this._impersonatedUser,notificationFilter:this._notificationFilter,apiTelemetryConfig:this._apiTelemetryConfig,beforeError:function(e){null!=a&&a.onError(e),r._onError(e).catch(function(){})},afterComplete:function(e){null!=a&&a.onComplete(e),r._onComplete(e)}})];case 2:throw(0,error_1$3.newError)("No connection available")}})})}).catch(function(e){null!=a&&a.onError(e),t._onError(e).catch(function(){})}).finally(function(){return t._acceptActive()})},e.prototype.run=function(e,t){e=(0,util_1$2.validateQueryAndParameters)(e,t),t=e.validatedQuery,e=e.params,t=this._state.run(t,e,{connectionHolder:this._connectionHolder,onError:this._onError,onComplete:this._onComplete,onConnection:this._onConnection,reactive:this._reactive,fetchSize:this._fetchSize,highRecordWatermark:this._highRecordWatermark,lowRecordWatermark:this._lowRecordWatermak,preparationJob:this._activePromise});return this._results.push(t),t},e.prototype.commit=function(){var t=this,r=this._state.commit({connectionHolder:this._connectionHolder,onError:this._onError,onComplete:function(e){return t._onCompleteCallback(e,t._bookmarks)},onConnection:this._onConnection,pendingResults:this._results,preparationJob:this._activePromise});return this._state=r.state,this._onClose(),new Promise(function(e,t){r.result.subscribe({onCompleted:function(){return e()},onError:function(e){return t(e)}})})},e.prototype.rollback=function(){var r=this._state.rollback({connectionHolder:this._connectionHolder,onError:this._onError,onComplete:this._onComplete,onConnection:this._onConnection,pendingResults:this._results,preparationJob:this._activePromise});return this._state=r.state,this._onClose(),new Promise(function(e,t){r.result.subscribe({onCompleted:function(){return e()},onError:function(e){return t(e)}})})},e.prototype.isOpen=function(){return this._state===_states$1.ACTIVE},e.prototype.close=function(){return __awaiter$e(this,void 0,void 0,function(){return __generator$e(this,function(e){switch(e.label){case 0:return this.isOpen()?[4,this.rollback()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},e.prototype[Symbol.asyncDispose]=function(){return this.close()},e.prototype._onErrorCallback=function(t){return this._state===_states$1.FAILED?Promise.resolve(null):(this._state=_states$1.FAILED,this._onClose(),this._results.forEach(function(e){e.isOpen()&&e._streamObserverPromise.then(function(e){return e.onError(t)}).catch(function(e){})}),this._connectionHolder.releaseConnection())},e.prototype._onCompleteCallback=function(e,t){this._onBookmarks(new bookmarks_1$2.Bookmarks(null==e?void 0:e.bookmark),null!=t?t:bookmarks_1$2.Bookmarks.empty(),null==e?void 0:e.db)},e}(),_states$1={ACTIVE:{commit:function(e){return{result:finishTransaction(!0,e.connectionHolder,e.onError,e.onComplete,e.onConnection,e.pendingResults,e.preparationJob),state:_states$1.SUCCEEDED}},rollback:function(e){return{result:finishTransaction(!1,e.connectionHolder,e.onError,e.onComplete,e.onConnection,e.pendingResults,e.preparationJob),state:_states$1.ROLLED_BACK}},run:function(t,r,e){var o=e.connectionHolder,n=e.onError,i=e.onComplete,a=e.onConnection,s=e.reactive,u=e.fetchSize,c=e.highRecordWatermark,l=e.lowRecordWatermark,e=e.preparationJob,_=null!=e?e:Promise.resolve();return newCompletedResult(o.getConnection().then(function(e){return _.then(function(){return e})}).then(function(e){if(a(),null!=e)return e.run(t,r,{bookmarks:bookmarks_1$2.Bookmarks.empty(),txConfig:tx_config_1$1.TxConfig.empty(),beforeError:n,afterComplete:i,reactive:s,fetchSize:u,highRecordWatermark:c,lowRecordWatermark:l});throw(0,error_1$3.newError)("No connection available")}).catch(function(e){return new observers_1$1.FailedObserver({error:e,onError:n})}),t,r,o,c,l)}},FAILED:{commit:function(e){var t=e.connectionHolder,r=e.onError;return e.onComplete,{result:newCompletedResult(new observers_1$1.FailedObserver({error:(0,error_1$3.newError)("Cannot commit this transaction, because it has been rolled back either because of an error or explicit termination."),onError:r}),"COMMIT",{},t,0,0),state:_states$1.FAILED}},rollback:function(e){var t=e.connectionHolder;return e.onError,e.onComplete,{result:newCompletedResult(new observers_1$1.CompletedObserver,"ROLLBACK",{},t,0,0),state:_states$1.FAILED}},run:function(e,t,r){var o=r.connectionHolder,n=r.onError;return r.onComplete,newCompletedResult(new observers_1$1.FailedObserver({error:(0,error_1$3.newError)("Cannot run query in this transaction, because it has been rolled back either because of an error or explicit termination."),onError:n}),e,t,o,0,0)}},SUCCEEDED:{commit:function(e){var t=e.connectionHolder,r=e.onError;return e.onComplete,{result:newCompletedResult(new observers_1$1.FailedObserver({error:(0,error_1$3.newError)("Cannot commit this transaction, because it has already been committed."),onError:r}),"COMMIT",{},connection_holder_1$1.EMPTY_CONNECTION_HOLDER,0,0),state:_states$1.SUCCEEDED,connectionHolder:t}},rollback:function(e){var t=e.connectionHolder,r=e.onError;return e.onComplete,{result:newCompletedResult(new observers_1$1.FailedObserver({error:(0,error_1$3.newError)("Cannot rollback this transaction, because it has already been committed."),onError:r}),"ROLLBACK",{},connection_holder_1$1.EMPTY_CONNECTION_HOLDER,0,0),state:_states$1.SUCCEEDED,connectionHolder:t}},run:function(e,t,r){var o=r.connectionHolder,n=r.onError;return r.onComplete,newCompletedResult(new observers_1$1.FailedObserver({error:(0,error_1$3.newError)("Cannot run query in this transaction, because it has already been committed."),onError:n}),e,t,o,0,0)}},ROLLED_BACK:{commit:function(e){var t=e.connectionHolder,r=e.onError;return e.onComplete,{result:newCompletedResult(new observers_1$1.FailedObserver({error:(0,error_1$3.newError)("Cannot commit this transaction, because it has already been rolled back."),onError:r}),"COMMIT",{},t,0,0),state:_states$1.ROLLED_BACK}},rollback:function(e){var t=e.connectionHolder;return e.onError,e.onComplete,{result:newCompletedResult(new observers_1$1.FailedObserver({error:(0,error_1$3.newError)("Cannot rollback this transaction, because it has already been rolled back.")}),"ROLLBACK",{},t,0,0),state:_states$1.ROLLED_BACK}},run:function(e,t,r){var o=r.connectionHolder,n=r.onError;return r.onComplete,newCompletedResult(new observers_1$1.FailedObserver({error:(0,error_1$3.newError)("Cannot run query in this transaction, because it has already been rolled back."),onError:n}),e,t,o,0,0)}}};function finishTransaction(r,e,o,n,i,a,t){var s=null!=t?t:Promise.resolve(),t=e.getConnection().then(function(e){return s.then(function(){return e})}).then(function(t){return i(),a.forEach(function(e){return e._cancel()}),Promise.all(a.map(function(e){return e.summary()})).then(function(e){if(null!=t)return r?t.commitTransaction({beforeError:o,afterComplete:n}):t.rollbackTransaction({beforeError:o,afterComplete:n});throw(0,error_1$3.newError)("No connection available")})}).catch(function(e){return new observers_1$1.FailedObserver({error:e,onError:o})});return new result_1$1.default(t,r?"COMMIT":"ROLLBACK",{},e,{high:Number.MAX_VALUE,low:Number.MAX_VALUE})}function newCompletedResult(e,t,r,o,n,i){return void 0===o&&(o=connection_holder_1$1.EMPTY_CONNECTION_HOLDER),new result_1$1.default(Promise.resolve(e),t,r,new connection_holder_1$1.ReadOnlyConnectionHolder(null!=o?o:connection_holder_1$1.EMPTY_CONNECTION_HOLDER),{low:i,high:n})}transaction.default=Transaction;var transactionManaged={},ManagedTransaction=(Object.defineProperty(transactionManaged,"__esModule",{value:!0}),function(){function t(e){e=e.run;this._run=e}return t.fromTransaction=function(e){return new t({run:e.run.bind(e)})},t.prototype.run=function(e,t){return this._run(e,t)},t}()),transactionPromise=(transactionManaged.default=ManagedTransaction,{}),__extends$x=commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),__assign$q=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$q=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__importDefault$Q=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},transaction_1=(Object.defineProperty(transactionPromise,"__esModule",{value:!0}),__importDefault$Q(transaction)),TransactionPromise=function(_){function e(e){var t=e.connectionHolder,r=e.onClose,o=e.onBookmarks,n=e.onConnection,i=e.reactive,a=e.fetchSize,s=e.impersonatedUser,u=e.highRecordWatermark,c=e.lowRecordWatermark,l=e.notificationFilter,e=e.apiTelemetryConfig,t=_.call(this,{connectionHolder:t,onClose:r,onBookmarks:o,onConnection:n,reactive:i,fetchSize:a,impersonatedUser:s,highRecordWatermark:u,lowRecordWatermark:c,notificationFilter:l,apiTelemetryConfig:e})||this;return t[_a$e]="TransactionPromise",t}return __extends$x(e,_),e.prototype.then=function(e,t){return this._getOrCreateBeginPromise().then(e,t)},e.prototype.catch=function(e){return this._getOrCreateBeginPromise().catch(e)},e.prototype.finally=function(e){return this._getOrCreateBeginPromise().finally(e)},e.prototype._getOrCreateBeginPromise=function(){var r=this;return null==this._beginPromise&&(this._beginPromise=new Promise(function(e,t){r._resolve=e,r._reject=t,null!=r._beginError&&t(r._beginError),null!=r._beginMetadata&&e(r._toTransaction())})),this._beginPromise},e.prototype._toTransaction=function(){return __assign$q(__assign$q({},this),{run:_.prototype.run.bind(this),commit:_.prototype.commit.bind(this),rollback:_.prototype.rollback.bind(this),close:_.prototype.close.bind(this),isOpen:_.prototype.isOpen.bind(this),_begin:this._begin.bind(this)})},e.prototype._begin=function(e,t){return _.prototype._begin.call(this,e,t,{onError:this._onBeginError.bind(this),onComplete:this._onBeginMetadata.bind(this)})},e.prototype._onBeginError=function(e){this._beginError=e,null!=this._reject&&this._reject(e)},e.prototype._onBeginMetadata=function(e){this._beginMetadata=null!=e?e:{},null!=this._resolve&&this._resolve(this._toTransaction())},e}(transaction_1.default),_a$e=Symbol.toStringTag,session=(transactionPromise.default=TransactionPromise,{}),__awaiter$d=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function o(e){try{i(u.next(e))}catch(e){t(e)}}function n(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(o,n)}i((u=u.apply(e,a||[])).next())})},__generator$d=commonjsGlobal&&commonjsGlobal.__generator||function(o,n){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=n.call(o,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__read$8=commonjsGlobal&&commonjsGlobal.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(o=i.next()).done;)a.push(o.value)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},__spreadArray$3=commonjsGlobal&&commonjsGlobal.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var o,n=0,i=t.length;n<i;n++)!o&&n in t||((o=o||Array.prototype.slice.call(t,0,n))[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))},__importDefault$P=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},observers_1=(Object.defineProperty(session,"__esModule",{value:!0}),observers),util_1$1=util$4,constants_1$2=constants$1,error_1$2=error,result_1=__importDefault$P(result),connection_holder_1=connectionHolder$1,transaction_executor_1=transactionExecutor$1,bookmarks_1$1=bookmarks$1,tx_config_1=txConfig$1,transaction_promise_1=__importDefault$P(transactionPromise),transaction_managed_1=__importDefault$P(transactionManaged),Session=function(){function n(e){var t=e.mode,r=e.connectionProvider,o=e.bookmarks,n=e.database,i=e.config,a=e.reactive,s=e.fetchSize,u=e.impersonatedUser,c=e.bookmarkManager,l=e.notificationFilter,_=e.auth,e=e.log,t=(this._mode=t,this._database=n,this._reactive=a,this._fetchSize=s,this._onDatabaseNameResolved=this._onDatabaseNameResolved.bind(this),this._getConnectionAcquistionBookmarks=this._getConnectionAcquistionBookmarks.bind(this),this._readConnectionHolder=new connection_holder_1.ConnectionHolder({mode:constants_1$2.ACCESS_MODE_READ,auth:_,database:n,bookmarks:o,connectionProvider:r,impersonatedUser:u,onDatabaseNameResolved:this._onDatabaseNameResolved,getConnectionAcquistionBookmarks:this._getConnectionAcquistionBookmarks,log:e}),this._writeConnectionHolder=new connection_holder_1.ConnectionHolder({mode:constants_1$2.ACCESS_MODE_WRITE,auth:_,database:n,bookmarks:o,connectionProvider:r,impersonatedUser:u,onDatabaseNameResolved:this._onDatabaseNameResolved,getConnectionAcquistionBookmarks:this._getConnectionAcquistionBookmarks,log:e}),this._open=!0,this._hasTx=!1,this._impersonatedUser=u,this._lastBookmarks=null!=o?o:bookmarks_1$1.Bookmarks.empty(),this._configuredBookmarks=this._lastBookmarks,this._transactionExecutor=_createTransactionExecutor(i),this._databaseNameResolved=""!==this._database,this._calculateWatermaks());this._lowRecordWatermark=t.low,this._highRecordWatermark=t.high,this._results=[],this._bookmarkManager=c,this._notificationFilter=l,this._log=e}return n.prototype.run=function(e,t,r){var n=this,e=(0,util_1$1.validateQueryAndParameters)(e,t),i=e.validatedQuery,a=e.params,s=null!=r?new tx_config_1.TxConfig(r,this._log):tx_config_1.TxConfig.empty(),t=this._run(i,a,function(o){return __awaiter$d(n,void 0,void 0,function(){var t,r=this;return __generator$d(this,function(e){switch(e.label){case 0:return[4,this._bookmarks()];case 1:return t=e.sent(),this._assertSessionIsOpen(),[2,o.run(i,a,{bookmarks:t,txConfig:s,mode:this._mode,database:this._database,apiTelemetryConfig:{api:constants_1$2.TELEMETRY_APIS.AUTO_COMMIT_TRANSACTION},impersonatedUser:this._impersonatedUser,afterComplete:function(e){return r._onCompleteCallback(e,t)},reactive:this._reactive,fetchSize:this._fetchSize,lowRecordWatermark:this._lowRecordWatermark,highRecordWatermark:this._highRecordWatermark,notificationFilter:this._notificationFilter})]}})})});return this._results.push(t),t},n.prototype._run=function(e,t,r){var r=this._acquireAndConsumeConnection(r),o=r.connectionHolder,r=r.resultPromise.catch(function(e){return Promise.resolve(new observers_1.FailedObserver({error:e}))}),n={high:this._highRecordWatermark,low:this._lowRecordWatermark};return new result_1.default(r,e,t,o,n)},n.prototype._acquireConnection=function(e){var r=this,e=this._acquireAndConsumeConnection(e),o=e.connectionHolder;return e.resultPromise.then(function(t){return __awaiter$d(r,void 0,void 0,function(){return __generator$d(this,function(e){switch(e.label){case 0:return[4,o.releaseConnection()];case 1:return e.sent(),[2,t]}})})})},n.prototype._acquireAndConsumeConnection=function(t){var e=this._connectionHolderWithMode(this._mode),r=this._open?!this._hasTx&&e.initializeConnection()?e.getConnection().then(function(e){return t(e)}):Promise.reject((0,error_1$2.newError)("Queries cannot be run directly on a session with an open transaction; either run from within the transaction or use a different session.")):Promise.reject((0,error_1$2.newError)("Cannot run query in a closed session."));return{connectionHolder:e,resultPromise:r}},n.prototype.beginTransaction=function(e){var t=tx_config_1.TxConfig.empty();return null!=e&&(t=new tx_config_1.TxConfig(e,this._log)),this._beginTransaction(this._mode,t,{api:constants_1$2.TELEMETRY_APIS.UNMANAGED_TRANSACTION})},n.prototype._beginTransaction=function(e,t,r){var o=this;if(!this._open)throw(0,error_1$2.newError)("Cannot begin a transaction on a closed session.");if(this._hasTx)throw(0,error_1$2.newError)("You cannot begin a transaction on a session with an open transaction; either run from within the transaction or use a different session.");e=n._validateSessionMode(e),e=this._connectionHolderWithMode(e),e.initializeConnection(),this._hasTx=!0,e=new transaction_promise_1.default({connectionHolder:e,impersonatedUser:this._impersonatedUser,onClose:this._transactionClosed.bind(this),onBookmarks:function(e,t,r){return o._updateBookmarks(e,t,r)},onConnection:this._assertSessionIsOpen.bind(this),reactive:this._reactive,fetchSize:this._fetchSize,lowRecordWatermark:this._lowRecordWatermark,highRecordWatermark:this._highRecordWatermark,notificationFilter:this._notificationFilter,apiTelemetryConfig:r});return e._begin(function(){return o._bookmarks()},t),e},n.prototype._assertSessionIsOpen=function(){if(!this._open)throw(0,error_1$2.newError)("You cannot run more transactions on a closed session.")},n.prototype._transactionClosed=function(){this._hasTx=!1},n.prototype.lastBookmark=function(){return this.lastBookmarks()},n.prototype.lastBookmarks=function(){return this._lastBookmarks.values()},n.prototype._bookmarks=function(){var r;return __awaiter$d(this,void 0,void 0,function(){var t;return __generator$d(this,function(e){switch(e.label){case 0:return[4,null==(r=this._bookmarkManager)?void 0:r.getBookmarks()];case 1:return void 0===(t=e.sent())?[2,this._lastBookmarks]:[2,new bookmarks_1$1.Bookmarks(__spreadArray$3(__spreadArray$3([],__read$8(t),!1),__read$8(this._configuredBookmarks),!1))]}})})},n.prototype.readTransaction=function(e,t){t=new tx_config_1.TxConfig(t,this._log);return this._runTransaction(constants_1$2.ACCESS_MODE_READ,t,e)},n.prototype.writeTransaction=function(e,t){t=new tx_config_1.TxConfig(t,this._log);return this._runTransaction(constants_1$2.ACCESS_MODE_WRITE,t,e)},n.prototype._runTransaction=function(t,r,e){var o=this;return this._transactionExecutor.execute(function(e){return o._beginTransaction(t,r,e)},e)},n.prototype.executeRead=function(e,t){t=new tx_config_1.TxConfig(t,this._log);return this._executeInTransaction(constants_1$2.ACCESS_MODE_READ,t,e)},n.prototype.executeWrite=function(e,t){t=new tx_config_1.TxConfig(t,this._log);return this._executeInTransaction(constants_1$2.ACCESS_MODE_WRITE,t,e)},n.prototype._executeInTransaction=function(t,r,e){var o=this;return this._transactionExecutor.execute(function(e){return o._beginTransaction(t,r,e)},e,transaction_managed_1.default.fromTransaction)},n.prototype._onDatabaseNameResolved=function(e){this._databaseNameResolved||(this._database=e=null!=e?e:"",this._readConnectionHolder.setDatabase(e),this._writeConnectionHolder.setDatabase(e),this._databaseNameResolved=!0)},n.prototype._getConnectionAcquistionBookmarks=function(){var r;return __awaiter$d(this,void 0,void 0,function(){var t;return __generator$d(this,function(e){switch(e.label){case 0:return[4,null==(r=this._bookmarkManager)?void 0:r.getBookmarks()];case 1:return void 0===(t=e.sent())?[2,this._lastBookmarks]:[2,new bookmarks_1$1.Bookmarks(__spreadArray$3(__spreadArray$3([],__read$8(this._configuredBookmarks),!1),__read$8(t),!1))]}})})},n.prototype._updateBookmarks=function(e,t,r){var o;null==e||e.isEmpty()||(null!=(o=this._bookmarkManager)&&o.updateBookmarks(null!=(o=null==t?void 0:t.values())?o:[],null!=(t=null==e?void 0:e.values())?t:[]).catch(function(){}),this._lastBookmarks=e,this._configuredBookmarks=bookmarks_1$1.Bookmarks.empty())},n.prototype.close=function(){return __awaiter$d(this,void 0,void 0,function(){return __generator$d(this,function(e){switch(e.label){case 0:return this._open?(this._open=!1,this._results.forEach(function(e){return e._cancel()}),this._transactionExecutor.close(),[4,this._readConnectionHolder.close(this._hasTx)]):[3,3];case 1:return e.sent(),[4,this._writeConnectionHolder.close(this._hasTx)];case 2:e.sent(),e.label=3;case 3:return[2]}})})},n.prototype[Symbol.asyncDispose]=function(){return this.close()},n.prototype._connectionHolderWithMode=function(e){if(e===constants_1$2.ACCESS_MODE_READ)return this._readConnectionHolder;if(e===constants_1$2.ACCESS_MODE_WRITE)return this._writeConnectionHolder;throw(0,error_1$2.newError)("Unknown access mode: "+e)},n.prototype._onCompleteCallback=function(e,t){this._updateBookmarks(new bookmarks_1$1.Bookmarks(e.bookmark),t,e.db)},n.prototype._calculateWatermaks=function(){return this._fetchSize===constants_1$2.FETCH_ALL?{low:Number.MAX_VALUE,high:Number.MAX_VALUE}:{low:.3*this._fetchSize,high:.7*this._fetchSize}},n.prototype._configureTransactionExecutor=function(e,t){this._transactionExecutor.pipelineBegin=e,this._transactionExecutor.telemetryApi=t},n._validateSessionMode=function(e){e=null!=e?e:constants_1$2.ACCESS_MODE_WRITE;if(e!==constants_1$2.ACCESS_MODE_READ&&e!==constants_1$2.ACCESS_MODE_WRITE)throw(0,error_1$2.newError)("Illegal session mode "+e);return e},n}();function _createTransactionExecutor(e){e=null!=(e=null==e?void 0:e.maxTransactionRetryTime)?e:null;return new transaction_executor_1.TransactionExecutor(e)}session.default=Session;var driver={},bookmarkManager$1={},__awaiter$c=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function o(e){try{i(u.next(e))}catch(e){t(e)}}function n(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(o,n)}i((u=u.apply(e,a||[])).next())})},__generator$c=commonjsGlobal&&commonjsGlobal.__generator||function(o,n){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=n.call(o,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__values$2=commonjsGlobal&&commonjsGlobal.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],o=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&o>=e.length?void 0:e)&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},__read$7=commonjsGlobal&&commonjsGlobal.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(o=i.next()).done;)a.push(o.value)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},__spreadArray$2=commonjsGlobal&&commonjsGlobal.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var o,n=0,i=t.length;n<i;n++)!o&&n in t||((o=o||Array.prototype.slice.call(t,0,n))[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))},BookmarkManager=(Object.defineProperty(bookmarkManager$1,"__esModule",{value:!0}),bookmarkManager$1.bookmarkManager=void 0,function(){function e(){throw new Error("Not implemented")}return e.prototype.updateBookmarks=function(e,t){return __awaiter$c(this,void 0,void 0,function(){return __generator$c(this,function(e){throw new Error("Not implemented")})})},e.prototype.getBookmarks=function(){return __awaiter$c(this,void 0,void 0,function(){return __generator$c(this,function(e){throw new Error("Not implemented")})})},e}());function bookmarkManager(e){void 0===e&&(e={});var t=new Set(e.initialBookmarks);return new Neo4jBookmarkManager(t,e.bookmarksSupplier,e.bookmarksConsumer)}bookmarkManager$1.default=BookmarkManager,bookmarkManager$1.bookmarkManager=bookmarkManager;var Neo4jBookmarkManager=function(){function e(e,t,r){this._bookmarks=e,this._bookmarksSupplier=t,this._bookmarksConsumer=r}return e.prototype.updateBookmarks=function(_,f){return __awaiter$c(this,void 0,void 0,function(){var t,r,o,n,i,a,s,u,c,l;return __generator$c(this,function(e){switch(e.label){case 0:t=this._bookmarks;try{for(r=__values$2(_),o=r.next();!o.done;o=r.next())a=o.value,t.delete(a)}catch(e){s={error:e}}finally{try{o&&!o.done&&(u=r.return)&&u.call(r)}finally{if(s)throw s.error}}try{for(n=__values$2(f),i=n.next();!i.done;i=n.next())a=i.value,t.add(a)}catch(e){c={error:e}}finally{try{i&&!i.done&&(l=n.return)&&l.call(n)}finally{if(c)throw c.error}}return"function"!=typeof this._bookmarksConsumer?[3,2]:[4,this._bookmarksConsumer(__spreadArray$2([],__read$7(t),!1))];case 1:e.sent(),e.label=2;case 2:return[2]}})})},e.prototype.getBookmarks=function(){var u;return __awaiter$c(this,void 0,void 0,function(){var t,r,o,n,i,a,s;return __generator$c(this,function(e){switch(e.label){case 0:return t=new Set(this._bookmarks),"function"!=typeof this._bookmarksSupplier?[3,2]:[4,this._bookmarksSupplier()];case 1:r=null!=(u=e.sent())?u:[];try{for(o=__values$2(r),n=o.next();!n.done;n=o.next())i=n.value,t.add(i)}catch(e){a={error:e}}finally{try{n&&!n.done&&(s=o.return)&&s.call(o)}finally{if(a)throw a.error}}e.label=2;case 2:return[2,__spreadArray$2([],__read$7(t),!1)]}})})},e}(),resultTransformers$1={},__awaiter$b=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function o(e){try{i(u.next(e))}catch(e){t(e)}}function n(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(o,n)}i((u=u.apply(e,a||[])).next())})},__generator$b=commonjsGlobal&&commonjsGlobal.__generator||function(o,n){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=n.call(o,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__importDefault$O=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},result_eager_1=(Object.defineProperty(resultTransformers$1,"__esModule",{value:!0}),__importDefault$O(resultEager)),error_1$1=error,ResultTransformers=function(){function e(){}return e.prototype.eagerResultTransformer=function(){return createEagerResultFromResult},e.prototype.eager=function(){return createEagerResultFromResult},e.prototype.mappedResultTransformer=function(e){return createMappedResultTransformer(e)},e.prototype.mapped=function(e){return createMappedResultTransformer(e)},e.prototype.first=function(){return first},e.prototype.summary=function(){return summary},e}(),resultTransformers=new ResultTransformers;function createEagerResultFromResult(n){return __awaiter$b(this,void 0,void 0,function(){var t,r,o;return __generator$b(this,function(e){switch(e.label){case 0:return[4,n];case 1:return r=e.sent(),t=r.summary,r=r.records,[4,n.keys()];case 2:return o=e.sent(),[2,new result_eager_1.default(o,r,t)]}})})}function createMappedResultTransformer(i){var e=this;if(null==i||null==i.collect&&null==i.map)throw(0,error_1$1.newError)("Requires a map or/and a collect functions.");return function(n){return __awaiter$b(e,void 0,void 0,function(){return __generator$b(this,function(e){switch(e.label){case 0:return[4,new Promise(function(t,r){var o={records:[],keys:[]};n.subscribe({onKeys:function(e){o.keys=e},onNext:function(e){var t;null!=i.map?void 0!==(t=i.map(e))&&o.records.push(t):o.records.push(e)},onCompleted:function(e){null!=i.collect?t(i.collect(o.records,e,o.keys)):t({records:o.records,summary:e,keys:o.keys})},onError:function(e){r(e)}})})];case 1:return[2,e.sent()]}})})}}function first(n){return __awaiter$b(this,void 0,void 0,function(){var t,r,o;return __generator$b(this,function(e){switch(e.label){case 0:return[4,(t=n[Symbol.asyncIterator]()).next()];case 1:o=e.sent(),r=o.value,o=o.done,e.label=2;case 2:return e.trys.push([2,,3,6]),!0===o?[2,void 0]:[2,r];case 3:return null==t.return?[3,5]:[4,t.return()];case 4:e.sent(),e.label=5;case 5:return[7];case 6:return[2]}})})}function summary(t){return __awaiter$b(this,void 0,void 0,function(){return __generator$b(this,function(e){switch(e.label){case 0:return[4,t.summary()];case 1:return[2,e.sent()]}})})}Object.freeze(resultTransformers),resultTransformers$1.default=resultTransformers;var queryExecutor={},__awaiter$a=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function o(e){try{i(u.next(e))}catch(e){t(e)}}function n(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(o,n)}i((u=u.apply(e,a||[])).next())})},__generator$a=commonjsGlobal&&commonjsGlobal.__generator||function(o,n){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=n.call(o,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},constants_1$1=(Object.defineProperty(queryExecutor,"__esModule",{value:!0}),constants$1),QueryExecutor=function(){function e(e){this._createSession=e}return e.prototype.execute=function(n,i,a){return __awaiter$a(this,void 0,void 0,function(){var t,r,o=this;return __generator$a(this,function(e){switch(e.label){case 0:t=this._createSession({database:n.database,bookmarkManager:n.bookmarkManager,impersonatedUser:n.impersonatedUser,auth:n.auth}),r=installEventListenerWhenPossible(n.signal,"abort",function(){return __awaiter$a(o,void 0,void 0,function(){return __generator$a(this,function(e){switch(e.label){case 0:return[4,t.close()];case 1:return[2,e.sent()]}})})}),t._configureTransactionExecutor(!0,constants_1$1.TELEMETRY_APIS.EXECUTE_QUERY),e.label=1;case 1:return e.trys.push([1,,3,5]),[4,("READ"===n.routing?t.executeRead:t.executeWrite).bind(t)(function(r){return __awaiter$a(o,void 0,void 0,function(){var t;return __generator$a(this,function(e){switch(e.label){case 0:return t=r.run(i,a),[4,n.resultTransformer(t)];case 1:return[2,e.sent()]}})})},n.transactionConfig)];case 2:return[2,e.sent()];case 3:return r.uninstall(),[4,t.close()];case 4:return e.sent(),[7];case 5:return[2]}})})},e}();function installEventListenerWhenPossible(e,t,r){return"function"==typeof(null==e?void 0:e.addEventListener)&&e.addEventListener(t,r),{uninstall:function(){"function"==typeof(null==e?void 0:e.removeEventListener)&&e.removeEventListener(t,r)}}}queryExecutor.default=QueryExecutor;var __awaiter$9=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function o(e){try{i(u.next(e))}catch(e){t(e)}}function n(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(o,n)}i((u=u.apply(e,a||[])).next())})},__generator$9=commonjsGlobal&&commonjsGlobal.__generator||function(o,n){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=n.call(o,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__importDefault$N=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},bookmarks_1=(Object.defineProperty(driver,"__esModule",{value:!0}),driver.QueryConfig=driver.SessionConfig=driver.routing=driver.WRITE=driver.READ=driver.Driver=void 0,bookmarks$1),configured_custom_resolver_1=__importDefault$N(configuredCustomResolver),constants_1=constants$1,logger_1=logger$1,session_1=__importDefault$N(session),util_1=util$4,bookmark_manager_1=bookmarkManager$1,result_transformers_1=__importDefault$N(resultTransformers$1),query_executor_1=__importDefault$N(queryExecutor),error_1=error,DEFAULT_MAX_CONNECTION_LIFETIME=36e5,DEFAULT_FETCH_SIZE=1e3,READ$2=constants_1.ACCESS_MODE_READ,WRITE$2=(driver.READ=READ$2,constants_1.ACCESS_MODE_WRITE),idGenerator$1=(driver.WRITE=WRITE$2,0),SessionConfig=function(){this.defaultAccessMode=WRITE$2,this.bookmarks=[],this.database="",this.impersonatedUser=void 0,this.auth=void 0,this.fetchSize=void 0,this.bookmarkManager=void 0,this.notificationFilter=void 0},ROUTING_WRITE=(driver.SessionConfig=SessionConfig,"WRITE"),ROUTING_READ="READ",routing={WRITE:ROUTING_WRITE,READ:ROUTING_READ},QueryConfig=(driver.routing=routing,Object.freeze(routing),function(){this.routing=routing.WRITE,this.resultTransformer=void 0,this.database="",this.impersonatedUser=void 0,this.bookmarkManager=void 0,this.transactionConfig=void 0,this.auth=void 0,this.signal=void 0}),Driver=(driver.QueryConfig=QueryConfig,function(){function e(e,t,r,o,n){void 0===o&&(o=function(e){return new session_1.default(e)}),void 0===n&&(n=function(e){return new query_executor_1.default(e)}),sanitizeConfig(t=void 0===t?{}:t);var i=logger_1.Logger.create(t);validateConfig(t,i),this._id=idGenerator$1++,this._meta=e,this._config=t,this._log=i,this._createConnectionProvider=r,this._createSession=o,this._defaultExecuteQueryBookmarkManager=(0,bookmark_manager_1.bookmarkManager)(),this._queryExecutor=n(this.session.bind(this)),this._connectionProvider=null,this._afterConstruction()}return Object.defineProperty(e.prototype,"executeQueryBookmarkManager",{get:function(){return this._defaultExecuteQueryBookmarkManager},enumerable:!1,configurable:!0}),e.prototype.executeQuery=function(n,i,a){var s,u;return void 0===a&&(a={}),__awaiter$9(this,void 0,void 0,function(){var t,r,o;return __generator$9(this,function(e){switch(e.label){case 0:if(t=null===a.bookmarkManager?void 0:null!=(s=a.bookmarkManager)?s:this.executeQueryBookmarkManager,r=null!=(s=a.resultTransformer)?s:result_transformers_1.default.eagerResultTransformer(),(o=null!=(u=a.routing)?u:routing.WRITE)!==routing.READ&&o!==routing.WRITE)throw(0,error_1.newError)('Illegal query routing config: "'.concat(o,'"'));return[4,this._queryExecutor.execute({resultTransformer:r,bookmarkManager:t,routing:o,database:a.database,impersonatedUser:a.impersonatedUser,transactionConfig:a.transactionConfig,auth:a.auth,signal:a.signal},n,i)];case 1:return[2,e.sent()]}})})},e.prototype.verifyConnectivity=function(e){e=(void 0===e?{}:e).database,e=void 0===e?"":e;return this._getOrCreateConnectionProvider().verifyConnectivityAndGetServerInfo({database:e,accessMode:READ$2})},e.prototype.verifyAuthentication=function(e){var e=void 0===e?{}:e,t=e.database,r=e.auth;return __awaiter$9(this,void 0,void 0,function(){return __generator$9(this,function(e){switch(e.label){case 0:return[4,this._getOrCreateConnectionProvider().verifyAuthentication({database:null!=t?t:"system",auth:r,accessMode:READ$2})];case 1:return[2,e.sent()]}})})},e.prototype.getServerInfo=function(e){e=(void 0===e?{}:e).database,e=void 0===e?"":e;return this._getOrCreateConnectionProvider().verifyConnectivityAndGetServerInfo({database:e,accessMode:READ$2})},e.prototype.supportsMultiDb=function(){return this._getOrCreateConnectionProvider().supportsMultiDb()},e.prototype.supportsTransactionConfig=function(){return this._getOrCreateConnectionProvider().supportsTransactionConfig()},e.prototype.supportsUserImpersonation=function(){return this._getOrCreateConnectionProvider().supportsUserImpersonation()},e.prototype.supportsSessionAuth=function(){return this._getOrCreateConnectionProvider().supportsSessionAuth()},e.prototype.getNegotiatedProtocolVersion=function(){return this._getOrCreateConnectionProvider().getNegotiatedProtocolVersion()},e.prototype.isEncrypted=function(){return this._isEncrypted()},e.prototype._supportsRouting=function(){return this._meta.routing},e.prototype._isEncrypted=function(){return this._config.encrypted===util_1.ENCRYPTION_ON||!0===this._config.encrypted},e.prototype._getTrust=function(){return this._config.trust},e.prototype.session=function(e){var e=void 0===e?{}:e,t=e.defaultAccessMode,r=e.bookmarks,o=e.database,n=e.impersonatedUser,i=e.fetchSize,a=e.bookmarkManager,s=e.notificationFilter,e=e.auth;return this._newSession({defaultAccessMode:void 0===t?WRITE$2:t,bookmarkOrBookmarks:r,database:void 0===o?"":o,reactive:!1,impersonatedUser:n,fetchSize:validateFetchSizeValue(i,this._config.fetchSize),bookmarkManager:a,notificationFilter:s,auth:e})},e.prototype.close=function(){return this._log.info("Driver ".concat(this._id," closing")),null!=this._connectionProvider?this._connectionProvider.close():Promise.resolve()},e.prototype[Symbol.asyncDispose]=function(){return this.close()},e.prototype._afterConstruction=function(){this._log.info("".concat(this._meta.typename," driver ").concat(this._id," created for server address ").concat(this._meta.address.toString()))},e.prototype._newSession=function(e){var t=e.defaultAccessMode,r=e.bookmarkOrBookmarks,o=e.database,n=e.reactive,i=e.impersonatedUser,a=e.fetchSize,s=e.bookmarkManager,u=e.notificationFilter,e=e.auth,t=session_1.default._validateSessionMode(t),c=this._getOrCreateConnectionProvider(),r=null!=r?new bookmarks_1.Bookmarks(r):bookmarks_1.Bookmarks.empty();return this._createSession({mode:t,database:null!=o?o:"",connectionProvider:c,bookmarks:r,config:this._config,reactive:n,impersonatedUser:i,fetchSize:a,bookmarkManager:s,notificationFilter:u,auth:e,log:this._log})},e.prototype._getOrCreateConnectionProvider=function(){return null==this._connectionProvider&&(this._connectionProvider=this._createConnectionProvider(this._id,this._config,this._log,createHostNameResolver(this._config))),this._connectionProvider},e}());function validateConfig(e,t){var r=e.resolver;if(null!=r&&"function"!=typeof r)throw new TypeError("Configured resolver should be a function. Got: ".concat(typeof r));if(e.connectionAcquisitionTimeout<e.connectionTimeout&&t.warn('Configuration for "connectionAcquisitionTimeout" should be greater than or equal to "connectionTimeout". Otherwise, the connection acquisition timeout will take precedence for over the connection timeout in scenarios where a new connection is created while it is acquired'),null!=(null==(r=e.notificationFilter)?void 0:r.disabledCategories)&&null!=(null==(t=e.notificationFilter)?void 0:t.disabledClassifications))throw new Error('The notificationFilter can\'t have both "disabledCategories" and  "disabledClassifications" configured at the same time.');return e}function sanitizeConfig(e){e.maxConnectionLifetime=sanitizeIntValue(e.maxConnectionLifetime,DEFAULT_MAX_CONNECTION_LIFETIME),e.maxConnectionPoolSize=sanitizeIntValue(e.maxConnectionPoolSize,constants_1.DEFAULT_POOL_MAX_SIZE),e.connectionAcquisitionTimeout=sanitizeIntValue(e.connectionAcquisitionTimeout,constants_1.DEFAULT_POOL_ACQUISITION_TIMEOUT),e.fetchSize=validateFetchSizeValue(e.fetchSize,DEFAULT_FETCH_SIZE),e.connectionTimeout=extractConnectionTimeout(e),e.connectionLivenessCheckTimeout=validateConnectionLivenessCheckTimeoutSizeValue(e.connectionLivenessCheckTimeout)}function sanitizeIntValue(e,t){e=parseInt(e,10);return 0<e||0===e?e:e<0?Number.MAX_SAFE_INTEGER:t}function validateFetchSizeValue(e,t){e=parseInt(e,10);if(0<e||e===constants_1.FETCH_ALL)return e;if(0===e||e<0)throw new Error("The fetch size can only be a positive value or ".concat(constants_1.FETCH_ALL," for ALL. However fetchSize = ").concat(e));return t}function extractConnectionTimeout(e){e=parseInt(e.connectionTimeout,10);return 0===e||!isNaN(e)&&e<0?null:isNaN(e)?constants_1.DEFAULT_CONNECTION_TIMEOUT_MILLIS:e}function validateConnectionLivenessCheckTimeoutSizeValue(e){if(null!=e){e=parseInt(e,10);if(e<0||Number.isNaN(e))throw new Error("The connectionLivenessCheckTimeout can only be a positive value or 0 for always. However connectionLivenessCheckTimeout = ".concat(e));return e}}function createHostNameResolver(e){return new configured_custom_resolver_1.default(e.resolver)}driver.Driver=Driver,driver.default=Driver;var auth$1={},auth=(Object.defineProperty(auth$1,"__esModule",{value:!0}),{basic:function(e,t,r){return null!=r?{scheme:"basic",principal:e,credentials:t,realm:r}:{scheme:"basic",principal:e,credentials:t}},kerberos:function(e){return{scheme:"kerberos",principal:"",credentials:e}},bearer:function(e){return{scheme:"bearer",credentials:e}},none:function(){return{scheme:"none"}},custom:function(e,t,r,o,n){o={scheme:o,principal:e};return isNotEmpty(t)&&(o.credentials=t),isNotEmpty(r)&&(o.realm=r),isNotEmpty(n)&&(o.parameters=n),o}});function isNotEmpty(e){return!(null==e||""===e||Object.getPrototypeOf(e)===Object.prototype&&0===Object.keys(e).length)}auth$1.default=auth;var authTokenManager={},__awaiter$8=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function o(e){try{i(u.next(e))}catch(e){t(e)}}function n(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(o,n)}i((u=u.apply(e,a||[])).next())})},__generator$8=commonjsGlobal&&commonjsGlobal.__generator||function(o,n){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=n.call(o,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__importDefault$M=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},auth_1=(Object.defineProperty(authTokenManager,"__esModule",{value:!0}),authTokenManager.staticAuthTokenManager=authTokenManager.authTokenManagers=authTokenManager.AuthTokenAndExpiration=void 0,__importDefault$M(auth$1)),internal_1=internal,AuthTokenManager=function(){function e(){}return e.prototype.getToken=function(){throw new Error("Not Implemented")},e.prototype.handleSecurityException=function(e,t){throw new Error("Not implemented")},e}(),AuthTokenAndExpiration=(authTokenManager.default=AuthTokenManager,function(){this.token=auth_1.default.none(),this.expiration=void 0}),AuthTokenManagers=(authTokenManager.AuthTokenAndExpiration=AuthTokenAndExpiration,function(){function e(){}return e.prototype.bearer=function(e){e=e.tokenProvider;if("function"!=typeof e)throw new TypeError("tokenProvider should be function, but got: ".concat(typeof e));return new ExpirationBasedAuthTokenManager(e,["Neo.ClientError.Security.Unauthorized","Neo.ClientError.Security.TokenExpired"])},e.prototype.basic=function(e){var t=this,r=e.tokenProvider;if("function"!=typeof r)throw new TypeError("tokenProvider should be function, but got: ".concat(typeof r));return new ExpirationBasedAuthTokenManager(function(){return __awaiter$8(t,void 0,void 0,function(){var t;return __generator$8(this,function(e){switch(e.label){case 0:return t={},[4,r()];case 1:return[2,(t.token=e.sent(),t)]}})})},["Neo.ClientError.Security.Unauthorized"])},e}()),authTokenManagers=new AuthTokenManagers;function staticAuthTokenManager(e){e=e.authToken;return new StaticAuthTokenManager(e)}authTokenManager.authTokenManagers=authTokenManagers,Object.freeze(authTokenManagers),authTokenManager.staticAuthTokenManager=staticAuthTokenManager;var TokenRefreshObservable=function(){function e(e){this._subscribers=e=void 0===e?[]:e}return e.prototype.subscribe=function(e){this._subscribers.push(e)},e.prototype.onCompleted=function(t){this._subscribers.forEach(function(e){return e.onCompleted(t)})},e.prototype.onError=function(t){this._subscribers.forEach(function(e){return e.onError(t)})},e}(),ExpirationBasedAuthTokenManager=function(){function e(e,t,r,o){this._tokenProvider=e,this._handledSecurityCodes=t,this._currentAuthData=r,this._refreshObservable=o}return e.prototype.getToken=function(){var t;return __awaiter$8(this,void 0,void 0,function(){return __generator$8(this,function(e){switch(e.label){case 0:return void 0===this._currentAuthData||void 0!==this._currentAuthData.expiration&&this._currentAuthData.expiration<new Date?[4,this._refreshAuthToken()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2,null==(t=this._currentAuthData)?void 0:t.token]}})})},e.prototype.handleSecurityException=function(e,t){return!!this._handledSecurityCodes.includes(t)&&(internal_1.util.equals(e,null==(t=this._currentAuthData)?void 0:t.token)&&this._scheduleRefreshAuthToken(),!0)},e.prototype._scheduleRefreshAuthToken=function(e){var r=this;void 0===this._refreshObservable&&(this._currentAuthData=void 0,this._refreshObservable=new TokenRefreshObservable,Promise.resolve(this._tokenProvider()).then(function(e){var t;r._currentAuthData=e,null!=(t=r._refreshObservable)&&t.onCompleted(e)}).catch(function(e){var t;null!=(t=r._refreshObservable)&&t.onError(e)}).finally(function(){r._refreshObservable=void 0})),void 0!==e&&this._refreshObservable.subscribe(e)},e.prototype._refreshAuthToken=function(){return __awaiter$8(this,void 0,void 0,function(){var r=this;return __generator$8(this,function(e){switch(e.label){case 0:return[4,new Promise(function(e,t){r._scheduleRefreshAuthToken({onCompleted:e,onError:t})})];case 1:return[2,e.sent()]}})})},e}(),StaticAuthTokenManager=function(){function e(e){this._authToken=e}return e.prototype.getToken=function(){return this._authToken},e.prototype.handleSecurityException=function(e,t){return!1},e}(),types={},__extends$w=commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),Config=(Object.defineProperty(types,"__esModule",{value:!0}),types.InternalConfig=types.Config=void 0,function(){this.encrypted=void 0,this.trust=void 0,this.trustedCertificates=[],this.maxConnectionPoolSize=100,this.maxConnectionLifetime=36e5,this.connectionAcquisitionTimeout=6e4,this.maxTransactionRetryTime=3e4,this.connectionLivenessCheckTimeout=void 0,this.connectionTimeout=3e4,this.disableLosslessIntegers=!1,this.useBigInt=!1,this.logging=void 0,this.resolver=void 0,this.notificationFilter=void 0,this.userAgent=void 0,this.telemetryDisabled=!1,this.clientCertificate=void 0}),InternalConfig=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends$w(t,e),t}(types.Config=Config),clientCertificate=(types.InternalConfig=InternalConfig,{}),__extends$v=commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),__assign$p=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$p=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__createBinding$5=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&("get"in n?t.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){e[o=void 0===o?r:o]=t[r]}),__setModuleDefault$5=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar$5=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding$5(t,e,r);return __setModuleDefault$5(t,e),t},json=(Object.defineProperty(clientCertificate,"__esModule",{value:!0}),clientCertificate.resolveCertificateProvider=clientCertificate.clientCertificateProviders=clientCertificate.RotatingClientCertificateProvider=clientCertificate.ClientCertificateProvider=void 0,__importStar$5(json$3)),ClientCertificate=function(){this.certfile="",this.keyfile="",this.password=void 0},ClientCertificateProvider=(clientCertificate.default=ClientCertificate,function(){function e(){}return e.prototype.hasUpdate=function(){throw new Error("Not Implemented")},e.prototype.getClientCertificate=function(){throw new Error("Not Implemented")},e}()),RotatingClientCertificateProvider=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends$v(t,e),t.prototype.updateCertificate=function(e){throw new Error("Not implemented")},t}(clientCertificate.ClientCertificateProvider=ClientCertificateProvider),ClientCertificateProviders=(clientCertificate.RotatingClientCertificateProvider=RotatingClientCertificateProvider,function(){function e(){}return e.prototype.rotating=function(e){var t,e=e.initialCertificate;if(null!=e&&isClientClientCertificate(e))return t=__assign$p({},e),new InternalRotatingClientCertificateProvider(t);throw new TypeError("initialCertificate should be ClientCertificate, but got ".concat(json.stringify(e)))},e}()),clientCertificateProviders=new ClientCertificateProviders;function resolveCertificateProvider(e){if(null!=e){if("object"==typeof e&&"hasUpdate"in e&&"getClientCertificate"in e&&"function"==typeof e.getClientCertificate&&"function"==typeof e.hasUpdate)return e;var t;if(isClientClientCertificate(e))return t=__assign$p({},e),{getClientCertificate:function(){return t},hasUpdate:function(){return!1}};throw new TypeError("clientCertificate should be configured with ClientCertificate or ClientCertificateProvider, but got ".concat(json.stringify(e)))}}function isClientClientCertificate(e){return null!=e&&"object"==typeof e&&"certfile"in e&&isCertFile(e.certfile)&&"keyfile"in e&&isKeyFile(e.keyfile)&&isStringOrNotPresent("password",e)}function isCertFile(e){return isString(e)||isArrayOf(e,isString)}function isKeyFile(e){function t(e){return"string"==typeof e||null!=e&&"object"==typeof e&&"path"in e&&"string"==typeof e.path&&isStringOrNotPresent("password",e)}return t(e)||isArrayOf(e,t)}function isString(e){return"string"==typeof e}function isArrayOf(e,t,r){return void 0===r&&(r=!1),Array.isArray(e)&&(r||0<e.length)&&e.filter(t).length===e.length}function isStringOrNotPresent(e,t){return!(e in t)||null==t[e]||"string"==typeof t[e]}clientCertificate.clientCertificateProviders=clientCertificateProviders,Object.freeze(clientCertificateProviders),clientCertificate.resolveCertificateProvider=resolveCertificateProvider;for(var InternalRotatingClientCertificateProvider=function(){function e(e,t){void 0===t&&(t=!1),this._certificate=e,this._updated=t}return e.prototype.hasUpdate=function(){try{return this._updated}finally{this._updated=!1}},e.prototype.getClientCertificate=function(){return this._certificate},e.prototype.updateCertificate=function(e){if(!isClientClientCertificate(e))throw new TypeError("certificate should be ClientCertificate, but got ".concat(json.stringify(e)));this._certificate=__assign$p({},e),this._updated=!0},e}(),lib=(!function(e){var o=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&("get"in n?t.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){e[o=void 0===o?r:o]=t[r]}),n=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),t=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&o(t,e,r);return n(t,e),t},r=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},i=(Object.defineProperty(e,"__esModule",{value:!0}),e.EagerResult=e.Result=e.Stats=e.QueryStatistics=e.ProfiledPlan=e.Plan=e.GqlStatusObject=e.Notification=e.ServerInfo=e.queryType=e.ResultSummary=e.Record=e.isPathSegment=e.PathSegment=e.isPath=e.Path=e.isUnboundRelationship=e.UnboundRelationship=e.isRelationship=e.Relationship=e.isNode=e.Node=e.Time=e.LocalTime=e.LocalDateTime=e.isTime=e.isLocalTime=e.isLocalDateTime=e.isDuration=e.isDateTime=e.isDate=e.Duration=e.DateTime=e.Date=e.Point=e.isPoint=e.internal=e.toString=e.toNumber=e.inSafeRange=e.isInt=e.int=e.Integer=e.error=e.isRetriableError=e.GQLError=e.newGQLError=e.Neo4jError=e.newError=e.authTokenManagers=void 0,e.resolveCertificateProvider=e.clientCertificateProviders=e.notificationFilterMinimumSeverityLevel=e.notificationFilterDisabledClassification=e.notificationFilterDisabledCategory=e.notificationSeverityLevel=e.notificationClassification=e.notificationCategory=e.resultTransformers=e.routing=e.staticAuthTokenManager=e.bookmarkManager=e.auth=e.json=e.driver=e.types=e.Driver=e.Session=e.TransactionPromise=e.ManagedTransaction=e.Transaction=e.Connection=e.Releasable=e.ConnectionProvider=void 0,error),a=(Object.defineProperty(e,"newError",{enumerable:!0,get:function(){return i.newError}}),Object.defineProperty(e,"Neo4jError",{enumerable:!0,get:function(){return i.Neo4jError}}),Object.defineProperty(e,"newGQLError",{enumerable:!0,get:function(){return i.newGQLError}}),Object.defineProperty(e,"GQLError",{enumerable:!0,get:function(){return i.GQLError}}),Object.defineProperty(e,"isRetriableError",{enumerable:!0,get:function(){return i.isRetriableError}}),t(integer)),s=(e.Integer=a.default,Object.defineProperty(e,"int",{enumerable:!0,get:function(){return a.int}}),Object.defineProperty(e,"isInt",{enumerable:!0,get:function(){return a.isInt}}),Object.defineProperty(e,"inSafeRange",{enumerable:!0,get:function(){return a.inSafeRange}}),Object.defineProperty(e,"toNumber",{enumerable:!0,get:function(){return a.toNumber}}),Object.defineProperty(e,"toString",{enumerable:!0,get:function(){return a.toString}}),temporalTypes),u=(Object.defineProperty(e,"Date",{enumerable:!0,get:function(){return s.Date}}),Object.defineProperty(e,"DateTime",{enumerable:!0,get:function(){return s.DateTime}}),Object.defineProperty(e,"Duration",{enumerable:!0,get:function(){return s.Duration}}),Object.defineProperty(e,"isDate",{enumerable:!0,get:function(){return s.isDate}}),Object.defineProperty(e,"isDateTime",{enumerable:!0,get:function(){return s.isDateTime}}),Object.defineProperty(e,"isDuration",{enumerable:!0,get:function(){return s.isDuration}}),Object.defineProperty(e,"isLocalDateTime",{enumerable:!0,get:function(){return s.isLocalDateTime}}),Object.defineProperty(e,"isLocalTime",{enumerable:!0,get:function(){return s.isLocalTime}}),Object.defineProperty(e,"isTime",{enumerable:!0,get:function(){return s.isTime}}),Object.defineProperty(e,"LocalDateTime",{enumerable:!0,get:function(){return s.LocalDateTime}}),Object.defineProperty(e,"LocalTime",{enumerable:!0,get:function(){return s.LocalTime}}),Object.defineProperty(e,"Time",{enumerable:!0,get:function(){return s.Time}}),graphTypes),c=(Object.defineProperty(e,"Node",{enumerable:!0,get:function(){return u.Node}}),Object.defineProperty(e,"isNode",{enumerable:!0,get:function(){return u.isNode}}),Object.defineProperty(e,"Relationship",{enumerable:!0,get:function(){return u.Relationship}}),Object.defineProperty(e,"isRelationship",{enumerable:!0,get:function(){return u.isRelationship}}),Object.defineProperty(e,"UnboundRelationship",{enumerable:!0,get:function(){return u.UnboundRelationship}}),Object.defineProperty(e,"isUnboundRelationship",{enumerable:!0,get:function(){return u.isUnboundRelationship}}),Object.defineProperty(e,"Path",{enumerable:!0,get:function(){return u.Path}}),Object.defineProperty(e,"isPath",{enumerable:!0,get:function(){return u.isPath}}),Object.defineProperty(e,"PathSegment",{enumerable:!0,get:function(){return u.PathSegment}}),Object.defineProperty(e,"isPathSegment",{enumerable:!0,get:function(){return u.isPathSegment}}),r(record)),l=(e.Record=c.default,spatialTypes),_=(Object.defineProperty(e,"isPoint",{enumerable:!0,get:function(){return l.isPoint}}),Object.defineProperty(e,"Point",{enumerable:!0,get:function(){return l.Point}}),t(resultSummary)),f=(e.ResultSummary=_.default,Object.defineProperty(e,"queryType",{enumerable:!0,get:function(){return _.queryType}}),Object.defineProperty(e,"ServerInfo",{enumerable:!0,get:function(){return _.ServerInfo}}),Object.defineProperty(e,"Plan",{enumerable:!0,get:function(){return _.Plan}}),Object.defineProperty(e,"ProfiledPlan",{enumerable:!0,get:function(){return _.ProfiledPlan}}),Object.defineProperty(e,"QueryStatistics",{enumerable:!0,get:function(){return _.QueryStatistics}}),Object.defineProperty(e,"Stats",{enumerable:!0,get:function(){return _.Stats}}),t(notification)),d=(e.Notification=f.default,Object.defineProperty(e,"GqlStatusObject",{enumerable:!0,get:function(){return f.GqlStatusObject}}),Object.defineProperty(e,"notificationCategory",{enumerable:!0,get:function(){return f.notificationCategory}}),Object.defineProperty(e,"notificationClassification",{enumerable:!0,get:function(){return f.notificationClassification}}),Object.defineProperty(e,"notificationSeverityLevel",{enumerable:!0,get:function(){return f.notificationSeverityLevel}}),notificationFilter),p=(Object.defineProperty(e,"notificationFilterDisabledCategory",{enumerable:!0,get:function(){return d.notificationFilterDisabledCategory}}),Object.defineProperty(e,"notificationFilterDisabledClassification",{enumerable:!0,get:function(){return d.notificationFilterDisabledClassification}}),Object.defineProperty(e,"notificationFilterMinimumSeverityLevel",{enumerable:!0,get:function(){return d.notificationFilterMinimumSeverityLevel}}),r(result)),h=(e.Result=p.default,r(resultEager)),m=(e.EagerResult=h.default,t(connectionProvider$1)),b=(e.ConnectionProvider=m.default,Object.defineProperty(e,"Releasable",{enumerable:!0,get:function(){return m.Releasable}}),r(connection$2)),g=(e.Connection=b.default,r(transaction)),y=(e.Transaction=g.default,r(transactionManaged)),v=(e.ManagedTransaction=y.default,r(transactionPromise)),O=(e.TransactionPromise=v.default,r(session)),E=(e.Session=O.default,t(driver)),T=E,$=(e.Driver=E.default,e.driver=T,r(auth$1)),P=(e.auth=$.default,bookmarkManager$1),w=(Object.defineProperty(e,"bookmarkManager",{enumerable:!0,get:function(){return P.bookmarkManager}}),authTokenManager),C=(Object.defineProperty(e,"authTokenManagers",{enumerable:!0,get:function(){return w.authTokenManagers}}),Object.defineProperty(e,"staticAuthTokenManager",{enumerable:!0,get:function(){return w.staticAuthTokenManager}}),driver),R=(Object.defineProperty(e,"routing",{enumerable:!0,get:function(){return C.routing}}),t(types)),S=(e.types=R,t(json$3)),r=(e.json=S,r(resultTransformers$1)),I=(e.resultTransformers=r.default,clientCertificate),t=(Object.defineProperty(e,"clientCertificateProviders",{enumerable:!0,get:function(){return I.clientCertificateProviders}}),Object.defineProperty(e,"resolveCertificateProvider",{enumerable:!0,get:function(){return I.resolveCertificateProvider}}),t(internal)),j=(e.internal=t,{SERVICE_UNAVAILABLE:i.SERVICE_UNAVAILABLE,SESSION_EXPIRED:i.SESSION_EXPIRED,PROTOCOL_ERROR:i.PROTOCOL_ERROR}),j=(e.error=j,{authTokenManagers:w.authTokenManagers,newError:i.newError,Neo4jError:i.Neo4jError,newGQLError:i.newGQLError,GQLError:i.GQLError,isRetriableError:i.isRetriableError,error:j,Integer:a.default,int:a.int,isInt:a.isInt,inSafeRange:a.inSafeRange,toNumber:a.toNumber,toString:a.toString,internal:t,isPoint:l.isPoint,Point:l.Point,Date:s.Date,DateTime:s.DateTime,Duration:s.Duration,isDate:s.isDate,isDateTime:s.isDateTime,isDuration:s.isDuration,isLocalDateTime:s.isLocalDateTime,isLocalTime:s.isLocalTime,isTime:s.isTime,LocalDateTime:s.LocalDateTime,LocalTime:s.LocalTime,Time:s.Time,Node:u.Node,isNode:u.isNode,Relationship:u.Relationship,isRelationship:u.isRelationship,UnboundRelationship:u.UnboundRelationship,isUnboundRelationship:u.isUnboundRelationship,Path:u.Path,isPath:u.isPath,PathSegment:u.PathSegment,isPathSegment:u.isPathSegment,Record:c.default,ResultSummary:_.default,queryType:_.queryType,ServerInfo:_.ServerInfo,Notification:f.default,GqlStatusObject:f.GqlStatusObject,Plan:_.Plan,ProfiledPlan:_.ProfiledPlan,QueryStatistics:_.QueryStatistics,Stats:_.Stats,Result:p.default,EagerResult:h.default,Transaction:g.default,ManagedTransaction:y.default,TransactionPromise:v.default,Session:O.default,Driver:E.default,Connection:b.default,Releasable:m.Releasable,types:R,driver:T,json:S,auth:$.default,bookmarkManager:P.bookmarkManager,routing:C.routing,resultTransformers:r.default,notificationCategory:f.notificationCategory,notificationClassification:f.notificationClassification,notificationSeverityLevel:f.notificationSeverityLevel,notificationFilterDisabledCategory:d.notificationFilterDisabledCategory,notificationFilterDisabledClassification:d.notificationFilterDisabledClassification,notificationFilterMinimumSeverityLevel:d.notificationFilterMinimumSeverityLevel,clientCertificateProviders:I.clientCertificateProviders,resolveCertificateProvider:I.resolveCertificateProvider});e.default=j}(lib$1),{}),loadBalancing={},loadBalancingStrategy={},LoadBalancingStrategy=(Object.defineProperty(loadBalancingStrategy,"__esModule",{value:!0}),function(){function e(){}return e.prototype.selectReader=function(e){throw new Error("Abstract function")},e.prototype.selectWriter=function(e){throw new Error("Abstract function")},e}()),leastConnectedLoadBalancingStrategy=(loadBalancingStrategy.default=LoadBalancingStrategy,{}),roundRobinArrayIndex={},RoundRobinArrayIndex=(Object.defineProperty(roundRobinArrayIndex,"__esModule",{value:!0}),function(){function e(e){this._offset=e||0}return e.prototype.next=function(e){var t;return 0===e?-1:(t=this._offset,this._offset+=1,this._offset===Number.MAX_SAFE_INTEGER&&(this._offset=0),t%e)},e}()),__extends$u=(roundRobinArrayIndex.default=RoundRobinArrayIndex,commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}()),__importDefault$L=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},round_robin_array_index_1=(Object.defineProperty(leastConnectedLoadBalancingStrategy,"__esModule",{value:!0}),__importDefault$L(roundRobinArrayIndex)),load_balancing_strategy_1$1=__importDefault$L(loadBalancingStrategy),LeastConnectedLoadBalancingStrategy=function(r){function e(e){var t=r.call(this)||this;return t._readersIndex=new round_robin_array_index_1.default,t._writersIndex=new round_robin_array_index_1.default,t._connectionPool=e,t}return __extends$u(e,r),e.prototype.selectReader=function(e){return this._select(e,this._readersIndex)},e.prototype.selectWriter=function(e){return this._select(e,this._writersIndex)},e.prototype._select=function(e,t){var r=e.length;if(0===r)return null;var o=t.next(r),n=o,i=null,a=Number.MAX_SAFE_INTEGER;do{var s=e[n],u=this._connectionPool.activeResourceCount(s)}while(u<a&&(i=s,a=u),n===r-1?n=0:n++,n!==o);return i},e}(load_balancing_strategy_1$1.default),__importDefault$K=(leastConnectedLoadBalancingStrategy.default=LeastConnectedLoadBalancingStrategy,commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}}),load_balancing_strategy_1=(Object.defineProperty(loadBalancing,"__esModule",{value:!0}),loadBalancing.LeastConnectedLoadBalancingStrategy=loadBalancing.LoadBalancingStrategy=void 0,__importDefault$K(loadBalancingStrategy)),least_connected_load_balancing_strategy_1=(loadBalancing.LoadBalancingStrategy=load_balancing_strategy_1.default,__importDefault$K(leastConnectedLoadBalancingStrategy)),bolt=(loadBalancing.LeastConnectedLoadBalancingStrategy=least_connected_load_balancing_strategy_1.default,loadBalancing.default=least_connected_load_balancing_strategy_1.default,{}),handshake$1={},channel={},browser={},browserChannel={},channelBuf={},buffer={},base64Js={},lookup=(base64Js.byteLength=byteLength,base64Js.toByteArray=toByteArray,base64Js.fromByteArray=fromByteArray,[]),revLookup=[],Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0,len=code.length;i<len;++i)lookup[i]=code[i],revLookup[code.charCodeAt(i)]=i;function getLens(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");e=e.indexOf("="),t=(e=-1===e?t:e)===t?0:4-e%4;return[e,t]}function byteLength(e){var e=getLens(e),t=e[0],e=e[1];return 3*(t+e)/4-e}function _byteLength(e,t,r){return 3*(t+r)/4-r}function toByteArray(e){for(var t,r=getLens(e),o=r[0],r=r[1],n=new Arr(_byteLength(e,o,r)),i=0,a=0<r?o-4:o,s=0;s<a;s+=4)t=revLookup[e.charCodeAt(s)]<<18|revLookup[e.charCodeAt(s+1)]<<12|revLookup[e.charCodeAt(s+2)]<<6|revLookup[e.charCodeAt(s+3)],n[i++]=t>>16&255,n[i++]=t>>8&255,n[i++]=255&t;return 2===r&&(t=revLookup[e.charCodeAt(s)]<<2|revLookup[e.charCodeAt(s+1)]>>4,n[i++]=255&t),1===r&&(t=revLookup[e.charCodeAt(s)]<<10|revLookup[e.charCodeAt(s+1)]<<4|revLookup[e.charCodeAt(s+2)]>>2,n[i++]=t>>8&255,n[i++]=255&t),n}function tripletToBase64(e){return lookup[e>>18&63]+lookup[e>>12&63]+lookup[e>>6&63]+lookup[63&e]}function encodeChunk(e,t,r){for(var o,n=[],i=t;i<r;i+=3)o=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]),n.push(tripletToBase64(o));return n.join("")}function fromByteArray(e){for(var t,r=e.length,o=r%3,n=[],i=0,a=r-o;i<a;i+=16383)n.push(encodeChunk(e,i,a<i+16383?a:i+16383));return 1==o?(t=e[r-1],n.push(lookup[t>>2]+lookup[t<<4&63]+"==")):2==o&&(t=(e[r-2]<<8)+e[r-1],n.push(lookup[t>>10]+lookup[t>>4&63]+lookup[t<<2&63]+"=")),n.join("")}revLookup["-".charCodeAt(0)]=62,revLookup["_".charCodeAt(0)]=63;var ieee754={read:function(e,t,r,o,n){var i,a,s=8*n-o-1,u=(1<<s)-1,c=u>>1,l=-7,_=r?n-1:0,f=r?-1:1,n=e[t+_];for(_+=f,i=n&(1<<-l)-1,n>>=-l,l+=s;0<l;i=256*i+e[t+_],_+=f,l-=8);for(a=i&(1<<-l)-1,i>>=-l,l+=o;0<l;a=256*a+e[t+_],_+=f,l-=8);if(0===i)i=1-c;else{if(i===u)return a?NaN:1/0*(n?-1:1);a+=Math.pow(2,o),i-=c}return(n?-1:1)*a*Math.pow(2,i-o)},write:function(e,t,r,o,n,i){var a,s,u=8*i-n-1,c=(1<<u)-1,l=c>>1,_=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,f=o?0:i-1,d=o?1:-1,i=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=c):(a=Math.floor(Math.log(t)/Math.LN2),t*(o=Math.pow(2,-a))<1&&(a--,o*=2),2<=(t+=1<=a+l?_/o:_*Math.pow(2,1-l))*o&&(a++,o/=2),c<=a+l?(s=0,a=c):1<=a+l?(s=(t*o-1)*Math.pow(2,n),a+=l):(s=t*Math.pow(2,l-1)*Math.pow(2,n),a=0));8<=n;e[r+f]=255&s,f+=d,s/=256,n-=8);for(a=a<<n|s,u+=n;0<u;e[r+f]=255&a,f+=d,a/=256,u-=8);e[r+f-d]|=128*i}},buf=(!function(r){const m=base64Js,i=ieee754;var e="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=l,r.SlowBuffer=function(e){+e!=e&&(e=0);return l.alloc(+e)},r.INSPECT_MAX_BYTES=50;const t=2147483647;function s(e){if(e>t)throw new RangeError('The value "'+e+'" is invalid for option "size"');e=new Uint8Array(e);return Object.setPrototypeOf(e,l.prototype),e}function l(e,t,r){if("number"!=typeof e)return o(e,t,r);if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return a(e)}function o(t,r,e){if("string"==typeof t){var o=t;var n=r;"string"==typeof n&&""!==n||(n="utf8");if(!l.isEncoding(n))throw new TypeError("Unknown encoding: "+n);var i=0|f(o,n);let e=s(i);o=e.write(o,n);o!==i&&(e=e.slice(0,o));return e}if(ArrayBuffer.isView(t))return A(n=t,Uint8Array)?c((i=new Uint8Array(n)).buffer,i.byteOffset,i.byteLength):u(n);if(null!=t){if(A(t,ArrayBuffer)||t&&A(t.buffer,ArrayBuffer))return c(t,r,e);if("undefined"!=typeof SharedArrayBuffer&&(A(t,SharedArrayBuffer)||t&&A(t.buffer,SharedArrayBuffer)))return c(t,r,e);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');o=t.valueOf&&t.valueOf();if(null!=o&&o!==t)return l.from(o,r,e);var a=function(e){{var t,r;if(l.isBuffer(e))return t=0|_(e.length),0!==(r=s(t)).length&&e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!=typeof e.length||D(e.length)?s(0):u(e);if("Buffer"===e.type&&Array.isArray(e.data))return u(e.data)}(t);if(a)return a;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return l.from(t[Symbol.toPrimitive]("string"),r,e)}throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function n(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function a(e){return n(e),s(e<0?0:0|_(e))}function u(t){var r=t.length<0?0:0|_(t.length),o=s(r);for(let e=0;e<r;e+=1)o[e]=255&t[e];return o}function c(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let o;return o=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(o,l.prototype),o}function _(e){if(e>=t)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+t.toString(16)+" bytes");return 0|e}function f(e,t){if(l.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||A(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,o=2<arguments.length&&!0===arguments[2];if(!o&&0===r)return 0;let n=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return j(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return G(e).length;default:if(n)return o?-1:j(e).length;t=(""+t).toLowerCase(),n=!0}}function k(e,r,o){let t=!1;if((r=void 0===r||r<0?0:r)>this.length)return"";if((o=void 0===o||o>this.length?this.length:o)<=0)return"";if((o>>>=0)<=(r>>>=0))return"";for(e=e||"utf8";;)switch(e){case"hex":{var n=this;var i=r;var a=o;var s=n.length;(!i||i<0)&&(i=0);(!a||a<0||s<a)&&(a=s);let t="";for(let e=i;e<a;++e)t+=F[n[e]];return t;return}case"utf8":case"utf-8":return b(this,r,o);case"ascii":{var u=this;s=r;var c=o;let t="";c=Math.min(u.length,c);for(let e=s;e<c;++e)t+=String.fromCharCode(127&u[e]);return t;return}case"latin1":case"binary":{var l=this;i=r;var _=o;let t="";_=Math.min(l.length,_);for(let e=i;e<_;++e)t+=String.fromCharCode(l[e]);return t;return}case"base64":return d=this,h=o,0===(p=r)&&h===d.length?m.fromByteArray(d):m.fromByteArray(d.slice(p,h));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":{d=this;p=r;h=o;var f=d.slice(p,h);let t="";for(let e=0;e<f.length-1;e+=2)t+=String.fromCharCode(f[e]+256*f[e+1]);return t;return}default:if(t)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),t=!0}var d,p,h}function d(e,t,r){var o=e[t];e[t]=e[r],e[r]=o}function p(e,t,r,o,n){if(0===e.length)return-1;if("string"==typeof r?(o=r,r=0):2147483647<r?r=2147483647:r<-2147483648&&(r=-2147483648),(r=(r=D(r=+r)?n?0:e.length-1:r)<0?e.length+r:r)>=e.length){if(n)return-1;r=e.length-1}else if(r<0){if(!n)return-1;r=0}if("string"==typeof t&&(t=l.from(t,o)),l.isBuffer(t))return 0===t.length?-1:h(e,t,r,o,n);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?(n?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(e,t,r):h(e,[t],r,o,n);throw new TypeError("val must be string, number or Buffer")}function h(r,o,t,e,n){let i=1,a=r.length,s=o.length;if(void 0!==e&&("ucs2"===(e=String(e).toLowerCase())||"ucs-2"===e||"utf16le"===e||"utf-16le"===e)){if(r.length<2||o.length<2)return-1;i=2,a/=2,s/=2,t/=2}function u(e,t){return 1===i?e[t]:e.readUInt16BE(t*i)}let c;if(n){let e=-1;for(c=t;c<a;c++)if(u(r,c)===u(o,-1===e?0:c-e)){if(-1===e&&(e=c),c-e+1===s)return e*i}else-1!==e&&(c-=c-e),e=-1}else for(t+s>a&&(t=a-s),c=t;0<=c;c--){let t=!0;for(let e=0;e<s;e++)if(u(r,c+e)!==u(o,e)){t=!1;break}if(t)return c}return-1}function M(e,t,r,o){return N(function(t){var r=[];for(let e=0;e<t.length;++e)r.push(255&t.charCodeAt(e));return r}(t),e,r,o)}function x(e,t,r,o){return N(function(t,r){var o,n;var i=[];for(let e=0;e<t.length&&!((r-=2)<0);++e)o=t.charCodeAt(e),n=o>>8,i.push(o%256),i.push(n);return i}(t,e.length-r),e,r,o)}function b(a,e,t){t=Math.min(a.length,t);var r=[];let s=e;for(;s<t;){var u=a[s];let n=null,i=239<u?4:223<u?3:191<u?2:1;if(s+i<=t){let e,t,r,o;switch(i){case 1:u<128&&(n=u);break;case 2:128==(192&(e=a[s+1]))&&127<(o=(31&u)<<6|63&e)&&(n=o);break;case 3:e=a[s+1],t=a[s+2],128==(192&e)&&128==(192&t)&&2047<(o=(15&u)<<12|(63&e)<<6|63&t)&&(o<55296||57343<o)&&(n=o);break;case 4:e=a[s+1],t=a[s+2],r=a[s+3],128==(192&e)&&128==(192&t)&&128==(192&r)&&65535<(o=(15&u)<<18|(63&e)<<12|(63&t)<<6|63&r)&&o<1114112&&(n=o)}}null===n?(n=65533,i=1):65535<n&&(n-=65536,r.push(n>>>10&1023|55296),n=56320|1023&n),r.push(n),s+=i}{var o=r,n=o.length;if(n<=g)return String.fromCharCode.apply(String,o);let e="",t=0;for(;t<n;)e+=String.fromCharCode.apply(String,o.slice(t,t+=g));return e}}r.kMaxLength=t,(l.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}())||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=o,Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(e,t,r){return t=t,r=r,n(e=e),!(e<=0)&&void 0!==t?"string"==typeof r?s(e).fill(t,r):s(e).fill(t):s(e)},l.allocUnsafe=a,l.allocUnsafeSlow=a,l.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==l.prototype},l.compare=function(r,o){if(A(r,Uint8Array)&&(r=l.from(r,r.offset,r.byteLength)),A(o,Uint8Array)&&(o=l.from(o,o.offset,o.byteLength)),!l.isBuffer(r)||!l.isBuffer(o))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(r===o)return 0;let n=r.length,i=o.length;for(let e=0,t=Math.min(n,i);e<t;++e)if(r[e]!==o[e]){n=r[e],i=o[e];break}return n<i?-1:i<n?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return l.alloc(0);let r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var o=l.allocUnsafe(e);let n=0;for(r=0;r<t.length;++r){let e=t[r];if(A(e,Uint8Array))n+e.length>o.length?(e=l.isBuffer(e)?e:l.from(e)).copy(o,n):Uint8Array.prototype.set.call(o,e,n);else{if(!l.isBuffer(e))throw new TypeError('"list" argument must be an Array of Buffers');e.copy(o,n)}n+=e.length}return o},l.byteLength=f,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)d(this,e,e+1);return this},l.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)d(this,e,e+3),d(this,e+1,e+2);return this},l.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)d(this,e,e+7),d(this,e+1,e+6),d(this,e+2,e+5),d(this,e+3,e+4);return this},l.prototype.toLocaleString=l.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?b(this,0,e):k.apply(this,arguments)},l.prototype.equals=function(e){if(l.isBuffer(e))return this===e||0===l.compare(this,e);throw new TypeError("Argument must be a Buffer")},l.prototype.inspect=function(){let e="";var t=r.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},e&&(l.prototype[e]=l.prototype.inspect),l.prototype.compare=function(e,t,r,o,n){if(A(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===r&&(r=e?e.length:0),void 0===o&&(o=0),void 0===n&&(n=this.length),(t=void 0===t?0:t)<0||r>e.length||o<0||n>this.length)throw new RangeError("out of range index");if(n<=o&&r<=t)return 0;if(n<=o)return-1;if(r<=t)return 1;if(this===e)return 0;let i=(n>>>=0)-(o>>>=0),a=(r>>>=0)-(t>>>=0);var s=Math.min(i,a),u=this.slice(o,n),c=e.slice(t,r);for(let e=0;e<s;++e)if(u[e]!==c[e]){i=u[e],a=c[e];break}return i<a?-1:a<i?1:0},l.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},l.prototype.indexOf=function(e,t,r){return p(this,e,t,r,!0)},l.prototype.lastIndexOf=function(e,t,r){return p(this,e,t,r,!1)},l.prototype.write=function(t,r,o,e){if(void 0===r)e="utf8",o=this.length,r=0;else if(void 0===o&&"string"==typeof r)e=r,o=this.length,r=0;else{if(!isFinite(r))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");r>>>=0,isFinite(o)?(o>>>=0,void 0===e&&(e="utf8")):(e=o,o=void 0)}var n,i,a,s=this.length-r;if((void 0===o||s<o)&&(o=s),0<t.length&&(o<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");e=e||"utf8";let u=!1;for(;;)switch(e){case"hex":{var c=this;var l=t;var _=r;var f=o;_=Number(_)||0;var d=c.length-_;(!f||d<(f=Number(f)))&&(f=d),(d=l.length)/2<f&&(f=d/2);let e;for(e=0;e<f;++e){var p=parseInt(l.substr(2*e,2),16);if(D(p))return e;c[_+e]=p}return e;return}case"utf8":case"utf-8":return d=r,a=o,N(j(t,(i=this).length-d),i,d,a);case"ascii":case"latin1":case"binary":return M(this,t,r,o);case"base64":return i=this,a=r,n=o,N(G(t),i,a,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,t,r,o);default:if(u)throw new TypeError("Unknown encoding: "+e);e=(""+e).toLowerCase(),u=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const g=4096;function y(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(r<e+t)throw new RangeError("Trying to access beyond buffer length")}function v(e,t,r,o,n,i){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(n<t||t<i)throw new RangeError('"value" argument is out of bounds');if(r+o>e.length)throw new RangeError("Index out of range")}function O(e,t,r,o,n){U(t,o,n,e,r,7);o=Number(t&BigInt(4294967295)),e[r++]=o,e[r++]=o>>=8,e[r++]=o>>=8,e[r++]=o>>=8,n=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=n,e[r++]=n>>=8,e[r++]=n>>=8,e[r++]=n>>=8,r}function E(e,t,r,o,n){U(t,o,n,e,r,7);o=Number(t&BigInt(4294967295)),e[r+7]=o,e[r+6]=o>>=8,e[r+5]=o>>=8,e[r+4]=o>>=8,n=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=n,e[r+2]=n>>=8,e[r+1]=n>>=8,e[r]=n>>=8,r+8}function T(e,t,r,o){if(r+o>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function $(e,t,r,o,n){return t=+t,r>>>=0,n||T(e,0,r,4),i.write(e,t,r,o,23,4),r+4}function P(e,t,r,o,n){return t=+t,r>>>=0,n||T(e,0,r,8),i.write(e,t,r,o,52,8),r+8}l.prototype.slice=function(e,t){var r=this.length,r=((e=~~e)<0?(e+=r)<0&&(e=0):r<e&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):r<t&&(t=r),t<e&&(t=e),this.subarray(e,t));return Object.setPrototypeOf(r,l.prototype),r},l.prototype.readUintLE=l.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||y(e,t,this.length);let o=this[e],n=1,i=0;for(;++i<t&&(n*=256);)o+=this[e+i]*n;return o},l.prototype.readUintBE=l.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||y(e,t,this.length);let o=this[e+--t],n=1;for(;0<t&&(n*=256);)o+=this[e+--t]*n;return o},l.prototype.readUint8=l.prototype.readUInt8=function(e,t){return e>>>=0,t||y(e,1,this.length),this[e]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(e,t){return e>>>=0,t||y(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(e,t){return e>>>=0,t||y(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(e,t){return e>>>=0,t||y(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(e,t){return e>>>=0,t||y(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readBigUInt64LE=L(function(e){S(e>>>=0,"offset");var t=this[e],r=this[e+7],t=(void 0!==t&&void 0!==r||I(e,this.length-8),t+256*this[++e]+65536*this[++e]+this[++e]*2**24),e=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(t)+(BigInt(e)<<BigInt(32))}),l.prototype.readBigUInt64BE=L(function(e){S(e>>>=0,"offset");var t=this[e],r=this[e+7],t=(void 0!==t&&void 0!==r||I(e,this.length-8),t*2**24+65536*this[++e]+256*this[++e]+this[++e]),e=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(t)<<BigInt(32))+BigInt(e)}),l.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||y(e,t,this.length);let o=this[e],n=1,i=0;for(;++i<t&&(n*=256);)o+=this[e+i]*n;return n*=128,o>=n&&(o-=Math.pow(2,8*t)),o},l.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||y(e,t,this.length);let o=t,n=1,i=this[e+--o];for(;0<o&&(n*=256);)i+=this[e+--o]*n;return n*=128,i>=n&&(i-=Math.pow(2,8*t)),i},l.prototype.readInt8=function(e,t){return e>>>=0,t||y(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){e>>>=0,t||y(e,2,this.length);t=this[e]|this[e+1]<<8;return 32768&t?4294901760|t:t},l.prototype.readInt16BE=function(e,t){e>>>=0,t||y(e,2,this.length);t=this[e+1]|this[e]<<8;return 32768&t?4294901760|t:t},l.prototype.readInt32LE=function(e,t){return e>>>=0,t||y(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return e>>>=0,t||y(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readBigInt64LE=L(function(e){S(e>>>=0,"offset");var t=this[e],r=this[e+7],r=(void 0!==t&&void 0!==r||I(e,this.length-8),this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24));return(BigInt(r)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)}),l.prototype.readBigInt64BE=L(function(e){S(e>>>=0,"offset");var t=this[e],r=this[e+7],t=(void 0!==t&&void 0!==r||I(e,this.length-8),(t<<24)+65536*this[++e]+256*this[++e]+this[++e]);return(BigInt(t)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)}),l.prototype.readFloatLE=function(e,t){return e>>>=0,t||y(e,4,this.length),i.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return e>>>=0,t||y(e,4,this.length),i.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return e>>>=0,t||y(e,8,this.length),i.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return e>>>=0,t||y(e,8,this.length),i.read(this,e,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(e,t,r,o){e=+e,t>>>=0,r>>>=0,o||v(this,e,t,r,Math.pow(2,8*r)-1,0);let n=1,i=0;for(this[t]=255&e;++i<r&&(n*=256);)this[t+i]=e/n&255;return t+r},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(e,t,r,o){e=+e,t>>>=0,r>>>=0,o||v(this,e,t,r,Math.pow(2,8*r)-1,0);let n=r-1,i=1;for(this[t+n]=255&e;0<=--n&&(i*=256);)this[t+n]=e/i&255;return t+r},l.prototype.writeUint8=l.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||v(this,e,t,1,255,0),this[t]=255&e,t+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||v(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||v(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||v(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||v(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigUInt64LE=L(function(e,t=0){return O(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),l.prototype.writeBigUInt64BE=L(function(e,t=0){return E(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),l.prototype.writeIntLE=function(e,t,r,o){e=+e,t>>>=0,o||v(this,e,t,r,(o=Math.pow(2,8*r-1))-1,-o);let n=0,i=1,a=0;for(this[t]=255&e;++n<r&&(i*=256);)e<0&&0===a&&0!==this[t+n-1]&&(a=1),this[t+n]=(e/i>>0)-a&255;return t+r},l.prototype.writeIntBE=function(e,t,r,o){e=+e,t>>>=0,o||v(this,e,t,r,(o=Math.pow(2,8*r-1))-1,-o);let n=r-1,i=1,a=0;for(this[t+n]=255&e;0<=--n&&(i*=256);)e<0&&0===a&&0!==this[t+n+1]&&(a=1),this[t+n]=(e/i>>0)-a&255;return t+r},l.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||v(this,e,t,1,127,-128),this[t]=255&(e=e<0?255+e+1:e),t+1},l.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||v(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||v(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||v(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},l.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||v(this,e,t,4,2147483647,-2147483648),this[t]=(e=e<0?4294967295+e+1:e)>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigInt64LE=L(function(e,t=0){return O(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),l.prototype.writeBigInt64BE=L(function(e,t=0){return E(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),l.prototype.writeFloatLE=function(e,t,r){return $(this,e,t,!0,r)},l.prototype.writeFloatBE=function(e,t,r){return $(this,e,t,!1,r)},l.prototype.writeDoubleLE=function(e,t,r){return P(this,e,t,!0,r)},l.prototype.writeDoubleBE=function(e,t,r){return P(this,e,t,!1,r)},l.prototype.copy=function(e,t,r,o){if(!l.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r=r||0,o||0===o||(o=this.length),t>=e.length&&(t=e.length),(o=0<o&&o<r?r:o)===r)return 0;if(0===e.length||0===this.length)return 0;if((t=t||0)<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(o<0)throw new RangeError("sourceEnd out of bounds");o>this.length&&(o=this.length);var n=(o=e.length-t<o-r?e.length-t+r:o)-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,o):Uint8Array.prototype.set.call(e,this.subarray(r,o),t),n},l.prototype.fill=function(t,r,o,n){if("string"==typeof t){if("string"==typeof r?(n=r,r=0,o=this.length):"string"==typeof o&&(n=o,o=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!l.isEncoding(n))throw new TypeError("Unknown encoding: "+n);var e;1===t.length&&(e=t.charCodeAt(0),"utf8"===n&&e<128||"latin1"===n)&&(t=e)}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(r<0||this.length<r||this.length<o)throw new RangeError("Out of range index");if(!(o<=r)){r>>>=0,o=void 0===o?this.length:o>>>0;let e;if("number"==typeof(t=t||0))for(e=r;e<o;++e)this[e]=t;else{var i=l.isBuffer(t)?t:l.from(t,n),a=i.length;if(0===a)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(e=0;e<o-r;++e)this[e+r]=i[e%a]}}return this};const w={};function C(e,t,r){w[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=this.name+` [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return this.name+` [${e}]: `+this.message}}}function R(e){let t="",r=e.length;for(var o="-"===e[0]?1:0;r>=4+o;r-=3)t="_"+e.slice(r-3,r)+t;return""+e.slice(0,r)+t}function U(t,r,o,e,n,i){if(o<t||t<r){var a="bigint"==typeof r?"n":"";let e;throw e=3<i?0===r||r===BigInt(0)?`>= 0${a} and < 2${a} ** `+8*(i+1)+a:`>= -(2${a} ** ${8*(i+1)-1}${a}) and < 2 ** `+(8*(i+1)-1)+a:`>= ${r}${a} and <= `+o+a,new w.ERR_OUT_OF_RANGE("value",e,t)}r=e,o=i,S(a=n,"offset"),void 0!==r[a]&&void 0!==r[a+o]||I(a,r.length-(o+1))}function S(e,t){if("number"!=typeof e)throw new w.ERR_INVALID_ARG_TYPE(t,"number",e)}function I(e,t,r){if(Math.floor(e)!==e)throw S(e,r),new w.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new w.ERR_BUFFER_OUT_OF_BOUNDS;throw new w.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= `+t,e)}C("ERR_BUFFER_OUT_OF_BOUNDS",function(e){return e?e+" is outside of buffer bounds":"Attempt to access memory outside buffer bounds"},RangeError),C("ERR_INVALID_ARG_TYPE",function(e,t){return`The "${e}" argument must be of type number. Received type `+typeof t},TypeError),C("ERR_OUT_OF_RANGE",function(e,t,r){e=`The value of "${e}" is out of range.`;let o=r;return Number.isInteger(r)&&Math.abs(r)>2**32?o=R(String(r)):"bigint"==typeof r&&(o=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(o=R(o)),o+="n"),e+=` It must be ${t}. Received `+o},RangeError);const B=/[^+/0-9A-Za-z-_]/g;function j(t,r){r=r||1/0;let o;var n=t.length;let i=null;var a=[];for(let e=0;e<n;++e){if(55295<(o=t.charCodeAt(e))&&o<57344){if(!i){if(56319<o){-1<(r-=3)&&a.push(239,191,189);continue}if(e+1===n){-1<(r-=3)&&a.push(239,191,189);continue}i=o;continue}if(o<56320){-1<(r-=3)&&a.push(239,191,189),i=o;continue}o=65536+(i-55296<<10|o-56320)}else i&&-1<(r-=3)&&a.push(239,191,189);if(i=null,o<128){if(--r<0)break;a.push(o)}else if(o<2048){if((r-=2)<0)break;a.push(o>>6|192,63&o|128)}else if(o<65536){if((r-=3)<0)break;a.push(o>>12|224,o>>6&63|128,63&o|128)}else{if(!(o<1114112))throw new Error("Invalid code point");if((r-=4)<0)break;a.push(o>>18|240,o>>12&63|128,o>>6&63|128,63&o|128)}}return a}function G(e){return m.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(B,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function N(e,t,r,o){let n;for(n=0;n<o&&!(n+r>=t.length||n>=e.length);++n)t[n+r]=e[n];return n}function A(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function D(e){return e!=e}const F=function(){var r="0123456789abcdef",o=new Array(256);for(let t=0;t<16;++t){var n=16*t;for(let e=0;e<16;++e)o[n+e]=r[t]+r[e]}return o}();function L(e){return"undefined"==typeof BigInt?V:e}function V(){throw new Error("BigInt not supported")}}(buffer),{}),baseBuf={},__extends$t=commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),BaseBuffer=(Object.defineProperty(baseBuf,"__esModule",{value:!0}),function(){function e(e){this.position=0,this.length=e}return e.prototype.getUInt8=function(e){throw new Error("Not implemented")},e.prototype.getInt8=function(e){throw new Error("Not implemented")},e.prototype.getFloat64=function(e){throw new Error("Not implemented")},e.prototype.putUInt8=function(e,t){throw new Error("Not implemented")},e.prototype.putInt8=function(e,t){throw new Error("Not implemented")},e.prototype.putFloat64=function(e,t){throw new Error("Not implemented")},e.prototype.getInt16=function(e){return this.getInt8(e)<<8|this.getUInt8(e+1)},e.prototype.getUInt16=function(e){return this.getUInt8(e)<<8|this.getUInt8(e+1)},e.prototype.getInt32=function(e){return this.getInt8(e)<<24|this.getUInt8(e+1)<<16|this.getUInt8(e+2)<<8|this.getUInt8(e+3)},e.prototype.getUInt32=function(e){return this.getUInt8(e)<<24|this.getUInt8(e+1)<<16|this.getUInt8(e+2)<<8|this.getUInt8(e+3)},e.prototype.getInt64=function(e){return this.getInt8(e)<<56|this.getUInt8(e+1)<<48|this.getUInt8(e+2)<<40|this.getUInt8(e+3)<<32|this.getUInt8(e+4)<<24|this.getUInt8(e+5)<<16|this.getUInt8(e+6)<<8|this.getUInt8(e+7)},e.prototype.getSlice=function(e,t){return new SliceBuffer(e,t,this)},e.prototype.putInt16=function(e,t){this.putInt8(e,t>>8),this.putUInt8(e+1,255&t)},e.prototype.putUInt16=function(e,t){this.putUInt8(e,t>>8&255),this.putUInt8(e+1,255&t)},e.prototype.putInt32=function(e,t){this.putInt8(e,t>>24),this.putUInt8(e+1,t>>16&255),this.putUInt8(e+2,t>>8&255),this.putUInt8(e+3,255&t)},e.prototype.putUInt32=function(e,t){this.putUInt8(e,t>>24&255),this.putUInt8(e+1,t>>16&255),this.putUInt8(e+2,t>>8&255),this.putUInt8(e+3,255&t)},e.prototype.putInt64=function(e,t){this.putInt8(e,t>>48),this.putUInt8(e+1,t>>42&255),this.putUInt8(e+2,t>>36&255),this.putUInt8(e+3,t>>30&255),this.putUInt8(e+4,t>>24&255),this.putUInt8(e+5,t>>16&255),this.putUInt8(e+6,t>>8&255),this.putUInt8(e+7,255&t)},e.prototype.putBytes=function(e,t){for(var r=0,o=t.remaining();r<o;r++)this.putUInt8(e+r,t.readUInt8())},e.prototype.readUInt8=function(){return this.getUInt8(this._updatePos(1))},e.prototype.readInt8=function(){return this.getInt8(this._updatePos(1))},e.prototype.readUInt16=function(){return this.getUInt16(this._updatePos(2))},e.prototype.readUInt32=function(){return this.getUInt32(this._updatePos(4))},e.prototype.readInt16=function(){return this.getInt16(this._updatePos(2))},e.prototype.readInt32=function(){return this.getInt32(this._updatePos(4))},e.prototype.readInt64=function(){return this.getInt32(this._updatePos(8))},e.prototype.readFloat64=function(){return this.getFloat64(this._updatePos(8))},e.prototype.writeUInt8=function(e){this.putUInt8(this._updatePos(1),e)},e.prototype.writeInt8=function(e){this.putInt8(this._updatePos(1),e)},e.prototype.writeInt16=function(e){this.putInt16(this._updatePos(2),e)},e.prototype.writeInt32=function(e){this.putInt32(this._updatePos(4),e)},e.prototype.writeUInt32=function(e){this.putUInt32(this._updatePos(4),e)},e.prototype.writeInt64=function(e){this.putInt64(this._updatePos(8),e)},e.prototype.writeFloat64=function(e){this.putFloat64(this._updatePos(8),e)},e.prototype.writeBytes=function(e){this.putBytes(this._updatePos(e.remaining()),e)},e.prototype.readSlice=function(e){return this.getSlice(this._updatePos(e),e)},e.prototype._updatePos=function(e){var t=this.position;return this.position+=e,t},e.prototype.remaining=function(){return this.length-this.position},e.prototype.hasRemaining=function(){return 0<this.remaining()},e.prototype.reset=function(){this.position=0},e.prototype.toString=function(){return this.constructor.name+"( position="+this.position+" )\n  "+this.toHex()},e.prototype.toHex=function(){for(var e="",t=0;t<this.length;t++){var r=this.getUInt8(t).toString(16);e+=r=1===r.length?"0"+r:r,t!==this.length-1&&(e+=" ")}return e},e}()),SliceBuffer=function(o){function e(e,t,r){t=o.call(this,t)||this;return t._start=e,t._inner=r,t}return __extends$t(e,o),e.prototype.putUInt8=function(e,t){this._inner.putUInt8(this._start+e,t)},e.prototype.getUInt8=function(e){return this._inner.getUInt8(this._start+e)},e.prototype.putInt8=function(e,t){this._inner.putInt8(this._start+e,t)},e.prototype.putFloat64=function(e,t){this._inner.putFloat64(this._start+e,t)},e.prototype.getInt8=function(e){return this._inner.getInt8(this._start+e)},e.prototype.getFloat64=function(e){return this._inner.getFloat64(this._start+e)},e}(baseBuf.default=BaseBuffer),__importDefault$J=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},base_buf_1$1=(Object.defineProperty(buf,"__esModule",{value:!0}),buf.BaseBuffer=void 0,__importDefault$J(baseBuf)),__extends$s=(buf.BaseBuffer=base_buf_1$1.default,buf.default=base_buf_1$1.default,commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}()),__importDefault$I=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},buffer_1$1=(Object.defineProperty(channelBuf,"__esModule",{value:!0}),channelBuf.alloc=void 0,__importDefault$I(buffer)),buf_1$1=__importDefault$I(buf),ChannelBuffer=function(o){function n(e){var t=this,e=newChannelJSBuffer(e);return(t=o.call(this,e.length)||this)._buffer=e,t}return __extends$s(n,o),n.prototype.getUInt8=function(e){return this._buffer.readUInt8(e)},n.prototype.getInt8=function(e){return this._buffer.readInt8(e)},n.prototype.getFloat64=function(e){return this._buffer.readDoubleBE(e)},n.prototype.putUInt8=function(e,t){this._buffer.writeUInt8(t,e)},n.prototype.putInt8=function(e,t){this._buffer.writeInt8(t,e)},n.prototype.putFloat64=function(e,t){this._buffer.writeDoubleBE(t,e)},n.prototype.putBytes=function(e,t){var r;t instanceof n?(r=Math.min(t.length-t.position,this.length-e),t._buffer.copy(this._buffer,e,t.position,t.position+r),t.position+=r):o.prototype.putBytes.call(this,e,t)},n.prototype.getSlice=function(e,t){return new n(this._buffer.slice(e,e+t))},n}(buf_1$1.default);function alloc(e){return new ChannelBuffer(e)}function newChannelJSBuffer(e){return e instanceof buffer_1$1.default.Buffer?e:"number"==typeof e&&"function"==typeof buffer_1$1.default.Buffer.alloc?buffer_1$1.default.Buffer.alloc(e):new buffer_1$1.default.Buffer(e)}channelBuf.default=ChannelBuffer,channelBuf.alloc=alloc;var __importDefault$H=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},channel_buf_1$3=(Object.defineProperty(browserChannel,"__esModule",{value:!0}),__importDefault$H(channelBuf)),neo4j_driver_core_1$H=lib$1,_a$d=neo4j_driver_core_1$H.internal.util,ENCRYPTION_OFF$1=_a$d.ENCRYPTION_OFF,ENCRYPTION_ON$1=_a$d.ENCRYPTION_ON,WS_OPEN=1,WS_CLOSED=3,WebSocketChannel=function(){function e(e,t,r){void 0===t&&(t=detectWebPageProtocol),void 0===r&&(r=function(e){return new WebSocket(e)});var o,n=this,t=(this._open=!0,this._pending=[],this._error=null,this._handleConnectionError=this._handleConnectionError.bind(this),this._config=e,this._receiveTimeout=null,this._receiveTimeoutStarted=!1,this._receiveTimeoutId=null,this._closingPromise=null,determineWebSocketScheme(e,t)),i=t.scheme,t=t.error;t?this._error=t:(this._ws=createWebSocket(i,e.address,r),this._ws.binaryType="arraybuffer",(o=this)._ws.onclose=function(e){e&&!e.wasClean&&o._handleConnectionError(),o._open=!1},this._ws.onopen=function(){o._clearConnectionTimeout();var e=o._pending;o._pending=null;for(var t=0;t<e.length;t++)o.write(e[t])},this._ws.onmessage=function(e){n._resetTimeout(),o.onmessage&&(e=new channel_buf_1$3.default(e.data),o.onmessage(e))},this._ws.onerror=this._handleConnectionError,this._connectionTimeoutFired=!1,this._connectionTimeoutId=this._setupConnectionTimeout())}return e.prototype._handleConnectionError=function(){this._connectionTimeoutFired?(this._error=(0,neo4j_driver_core_1$H.newError)("Failed to establish connection in ".concat(this._config.connectionTimeout,"ms"),this._config.connectionErrorCode),this.onerror&&this.onerror(this._error)):this._open&&!this._timedout&&(this._error=(0,neo4j_driver_core_1$H.newError)("WebSocket connection failure. Due to security constraints in your web browser, the reason for the failure is not available to this Neo4j Driver. Please use your browsers development console to determine the root cause of the failure. Common reasons include the database being unavailable, using the wrong connection URL or temporary network problems. If you have enabled encryption, ensure your browser is configured to trust the certificate Neo4j is configured to use. WebSocket `readyState` is: "+this._ws.readyState,this._config.connectionErrorCode),this.onerror)&&this.onerror(this._error)},e.prototype.write=function(e){if(null!==this._pending)this._pending.push(e);else{if(!(e instanceof channel_buf_1$3.default))throw(0,neo4j_driver_core_1$H.newError)("Don't know how to send buffer: "+e);try{this._ws.send(e._buffer)}catch(e){if(this._ws.readyState===WS_OPEN)throw e;this._handleConnectionError()}}},e.prototype.close=function(){var r=this;return null===this._closingPromise&&(this._closingPromise=new Promise(function(e,t){r._clearConnectionTimeout(),r._ws&&r._ws.readyState!==WS_CLOSED?(r._open=!1,r.stopReceiveTimeout(),r._ws.onclose=function(){e()},r._ws.close()):e()})),this._closingPromise},e.prototype.setupReceiveTimeout=function(e){this._receiveTimeout=e},e.prototype.stopReceiveTimeout=function(){null!==this._receiveTimeout&&this._receiveTimeoutStarted&&(this._receiveTimeoutStarted=!1,null!=this._receiveTimeoutId&&clearTimeout(this._receiveTimeoutId),this._receiveTimeoutId=null)},e.prototype.startReceiveTimeout=function(){this._open&&null!==this._receiveTimeout&&!this._receiveTimeoutStarted&&(this._receiveTimeoutStarted=!0,this._resetTimeout())},e.prototype._resetTimeout=function(){var e=this;this._receiveTimeoutStarted&&(null!==this._receiveTimeoutId&&clearTimeout(this._receiveTimeoutId),this._receiveTimeoutId=setTimeout(function(){e._receiveTimeoutId=null,e._timedout=!0,e.stopReceiveTimeout(),e._error=(0,neo4j_driver_core_1$H.newError)("Connection lost. Server didn't respond in ".concat(e._receiveTimeout,"ms"),e._config.connectionErrorCode),e.close(),e.onerror&&e.onerror(e._error)},this._receiveTimeout))},e.prototype._setupConnectionTimeout=function(){var e,t=this,r=this._config.connectionTimeout;return r?(e=this._ws,setTimeout(function(){e.readyState!==WS_OPEN&&(t._connectionTimeoutFired=!0,e.close())},r)):null},e.prototype._clearConnectionTimeout=function(){var e=this._connectionTimeoutId;!e&&0!==e||(this._connectionTimeoutFired=!1,this._connectionTimeoutId=null,clearTimeout(e))},e}();function createWebSocket(t,r,o){var e=t+"://"+r.asHostPort();try{return o(e)}catch(e){if(isIPv6AddressIssueOnWindows(e,r))return o(asWindowsFriendlyIPv6Address(t,r));throw e}}function isIPv6AddressIssueOnWindows(e,t){return"SyntaxError"===e.name&&isIPv6Address(t.asHostPort())}function isIPv6Address(e){return"["===e.charAt(0)&&-1!==e.indexOf("]")}function asWindowsFriendlyIPv6Address(e,t){var r=t.host().replace(/:/g,"-").replace("%","s")+".ipv6-literal.net";return"".concat(e,"://").concat(r,":").concat(t.port())}function determineWebSocketScheme(e,t){var r=isEncryptionExplicitlyTurnedOn(e),o=isEncryptionExplicitlyTurnedOff(e),e=e.trust,t=isProtocolSecure(t);return verifyEncryptionSettings(r,o,t),o?{scheme:"ws",error:null}:t?{scheme:"wss",error:null}:r?e&&"TRUST_SYSTEM_CA_SIGNED_CERTIFICATES"!==e?{scheme:null,error:(0,neo4j_driver_core_1$H.newError)("The browser version of this driver only supports one trust strategy, 'TRUST_SYSTEM_CA_SIGNED_CERTIFICATES'. "+e+' is not supported. Please either use TRUST_SYSTEM_CA_SIGNED_CERTIFICATES or disable encryption by setting `encrypted:"'+ENCRYPTION_OFF$1+'"` in the driver configuration.')}:{scheme:"wss",error:null}:{scheme:"ws",error:null}}function isEncryptionExplicitlyTurnedOn(e){return!0===e.encrypted||e.encrypted===ENCRYPTION_ON$1}function isEncryptionExplicitlyTurnedOff(e){return!1===e.encrypted||e.encrypted===ENCRYPTION_OFF$1}function isProtocolSecure(e){e="function"==typeof e?e():"";return e&&0<=e.toLowerCase().indexOf("https")}function verifyEncryptionSettings(e,t,r){null!==r&&(e&&!r?console.warn("Neo4j driver is configured to use secure WebSocket on a HTTP web page. WebSockets might not work in a mixed content environment. Please consider configuring driver to not use encryption."):t&&r&&console.warn("Neo4j driver is configured to use insecure WebSocket on a HTTPS web page. WebSockets might not work in a mixed content environment. Please consider configuring driver to use encryption."))}function detectWebPageProtocol(){return"undefined"!=typeof window&&window.location?window.location.protocol:null}browserChannel.default=WebSocketChannel;var browserHostNameResolver={},__extends$r=commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),neo4j_driver_core_1$G=(Object.defineProperty(browserHostNameResolver,"__esModule",{value:!0}),lib$1),BaseHostNameResolver=lib$1.internal.resolver.BaseHostNameResolver,BrowserHostNameResolver=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends$r(t,e),t.prototype.resolve=function(e){return this._resolveToItself(e)},t}(BaseHostNameResolver),browserClientCertificatesLoader=(browserHostNameResolver.default=BrowserHostNameResolver,{}),__awaiter$7=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function o(e){try{i(u.next(e))}catch(e){t(e)}}function n(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(o,n)}i((u=u.apply(e,a||[])).next())})},__generator$7=commonjsGlobal&&commonjsGlobal.__generator||function(o,n){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=n.call(o,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__importDefault$G=(Object.defineProperty(browserClientCertificatesLoader,"__esModule",{value:!0}),browserClientCertificatesLoader.default={load:function(t){return __awaiter$7(this,void 0,void 0,function(){return __generator$7(this,function(e){return[2,t]})})}},commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}}),browser_channel_1=(Object.defineProperty(browser,"__esModule",{value:!0}),browser.ClientCertificatesLoader=browser.HostNameResolver=browser.Channel=void 0,__importDefault$G(browserChannel)),browser_host_name_resolver_1=__importDefault$G(browserHostNameResolver),browser_client_certificates_loader_1=__importDefault$G(browserClientCertificatesLoader),chunking=(browser.Channel=browser_channel_1.default,browser.HostNameResolver=browser_host_name_resolver_1.default,browser.ClientCertificatesLoader=browser_client_certificates_loader_1.default,{}),combinedBuf={},__extends$q=commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),buf_1=(Object.defineProperty(combinedBuf,"__esModule",{value:!0}),buf),channel_buf_1$2=channelBuf,CombinedBuffer=function(n){function e(e){for(var t=this,r=0,o=0;o<e.length;o++)r+=e[o].length;return(t=n.call(this,r)||this)._buffers=e,t}return __extends$q(e,n),e.prototype.getUInt8=function(e){for(var t=0;t<this._buffers.length;t++){var r=this._buffers[t];if(!(e>=r.length))return r.getUInt8(e);e-=r.length}},e.prototype.getInt8=function(e){for(var t=0;t<this._buffers.length;t++){var r=this._buffers[t];if(!(e>=r.length))return r.getInt8(e);e-=r.length}},e.prototype.getFloat64=function(e){for(var t=(0,channel_buf_1$2.alloc)(8),r=0;r<8;r++)t.putUInt8(r,this.getUInt8(e+r));return t.getFloat64(0)},e}(buf.BaseBuffer),__extends$p=(combinedBuf.default=CombinedBuffer,commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}()),__importDefault$F=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},base_buf_1=(Object.defineProperty(chunking,"__esModule",{value:!0}),chunking.Dechunker=chunking.Chunker=void 0,__importDefault$F(baseBuf)),channel_buf_1$1=channelBuf,combined_buf_1=__importDefault$F(combinedBuf),_CHUNK_HEADER_SIZE=2,_MESSAGE_BOUNDARY=0,_DEFAULT_BUFFER_SIZE=1400,Chunker=function(o){function e(e,t){var r=o.call(this,0)||this;return r._bufferSize=t||_DEFAULT_BUFFER_SIZE,r._ch=e,r._buffer=(0,channel_buf_1$1.alloc)(r._bufferSize),r._currentChunkStart=0,r._chunkOpen=!1,r}return __extends$p(e,o),e.prototype.putUInt8=function(e,t){this._ensure(1),this._buffer.writeUInt8(t)},e.prototype.putInt8=function(e,t){this._ensure(1),this._buffer.writeInt8(t)},e.prototype.putFloat64=function(e,t){this._ensure(8),this._buffer.writeFloat64(t)},e.prototype.putBytes=function(e,t){for(;0<t.remaining();)this._ensure(1),this._buffer.remaining()>t.remaining()?this._buffer.writeBytes(t):this._buffer.writeBytes(t.readSlice(this._buffer.remaining()));return this},e.prototype.flush=function(){var e;return 0<this._buffer.position&&(this._closeChunkIfOpen(),e=this._buffer,this._buffer=null,this._ch.write(e.getSlice(0,e.position)),this._buffer=(0,channel_buf_1$1.alloc)(this._bufferSize),this._chunkOpen=!1),this},e.prototype.messageBoundary=function(){this._closeChunkIfOpen(),this._buffer.remaining()<_CHUNK_HEADER_SIZE&&this.flush(),this._buffer.writeInt16(_MESSAGE_BOUNDARY)},e.prototype._ensure=function(e){e=this._chunkOpen?e:e+_CHUNK_HEADER_SIZE;this._buffer.remaining()<e&&this.flush(),this._chunkOpen||(this._currentChunkStart=this._buffer.position,this._buffer.position=this._buffer.position+_CHUNK_HEADER_SIZE,this._chunkOpen=!0)},e.prototype._closeChunkIfOpen=function(){var e;this._chunkOpen&&(e=this._buffer.position-(this._currentChunkStart+_CHUNK_HEADER_SIZE),this._buffer.putUInt16(this._currentChunkStart,e),this._chunkOpen=!1)},e}(base_buf_1.default),Dechunker=(chunking.Chunker=Chunker,function(){function e(){this._currentMessage=[],this._partialChunkHeader=0,this._state=this.AWAITING_CHUNK}return e.prototype.AWAITING_CHUNK=function(e){return 2<=e.remaining()?this._onHeader(e.readUInt16()):(this._partialChunkHeader=e.readUInt8()<<8,this.IN_HEADER)},e.prototype.IN_HEADER=function(e){return this._onHeader(65535&(this._partialChunkHeader|e.readUInt8()))},e.prototype.IN_CHUNK=function(e){return this._chunkSize<=e.remaining()?(this._currentMessage.push(e.readSlice(this._chunkSize)),this.AWAITING_CHUNK):(this._chunkSize-=e.remaining(),this._currentMessage.push(e.readSlice(e.remaining())),this.IN_CHUNK)},e.prototype.CLOSED=function(e){},e.prototype._onHeader=function(e){if(0!==e)return this._chunkSize=e,this.IN_CHUNK;var t=void 0;switch(this._currentMessage.length){case 0:return this.AWAITING_CHUNK;case 1:t=this._currentMessage[0];break;default:t=new combined_buf_1.default(this._currentMessage)}return this._currentMessage=[],this.onmessage(t),this.AWAITING_CHUNK},e.prototype.write=function(e){for(;e.hasRemaining();)this._state=this._state(e)},e}()),channelConfig=(chunking.Dechunker=Dechunker,{}),neo4j_driver_core_1$F=(Object.defineProperty(channelConfig,"__esModule",{value:!0}),lib$1),_a$c=neo4j_driver_core_1$F.internal.util,ENCRYPTION_OFF=_a$c.ENCRYPTION_OFF,ENCRYPTION_ON=_a$c.ENCRYPTION_ON,SERVICE_UNAVAILABLE$4=neo4j_driver_core_1$F.error.SERVICE_UNAVAILABLE,ALLOWED_VALUES_ENCRYPTED=[null,void 0,!0,!1,ENCRYPTION_ON,ENCRYPTION_OFF],ALLOWED_VALUES_TRUST=[null,void 0,"TRUST_ALL_CERTIFICATES","TRUST_CUSTOM_CA_SIGNED_CERTIFICATES","TRUST_SYSTEM_CA_SIGNED_CERTIFICATES"],ChannelConfig=function(e,t,r,o){this.address=e,this.encrypted=extractEncrypted(t),this.trust=extractTrust(t),this.trustedCertificates=extractTrustedCertificates(t),this.knownHostsPath=extractKnownHostsPath(t),this.connectionErrorCode=r||SERVICE_UNAVAILABLE$4,this.connectionTimeout=t.connectionTimeout,this.clientCertificate=o};function extractEncrypted(e){e=e.encrypted;if(-1===ALLOWED_VALUES_ENCRYPTED.indexOf(e))throw(0,neo4j_driver_core_1$F.newError)("Illegal value of the encrypted setting ".concat(e,". Expected one of ").concat(ALLOWED_VALUES_ENCRYPTED));return e}function extractTrust(e){e=e.trust;if(-1===ALLOWED_VALUES_TRUST.indexOf(e))throw(0,neo4j_driver_core_1$F.newError)("Illegal value of the trust setting ".concat(e,". Expected one of ").concat(ALLOWED_VALUES_TRUST));return e}function extractTrustedCertificates(e){return e.trustedCertificates||[]}function extractKnownHostsPath(e){return e.knownHosts||null}channelConfig.default=ChannelConfig;var utf8={},string_decoder={},safeBuffer={exports:{}},Buffer=(!function(e,t){var r=buffer,o=r.Buffer;function n(e,t){for(var r in e)t[r]=e[r]}function i(e,t,r){return o(e,t,r)}o.from&&o.alloc&&o.allocUnsafe&&o.allocUnsafeSlow?e.exports=r:(n(r,t),t.Buffer=i),i.prototype=Object.create(o.prototype),n(o,i),i.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return o(e,t,r)},i.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");e=o(e);return void 0!==t?"string"==typeof r?e.fill(t,r):e.fill(t):e.fill(0),e},i.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return o(e)},i.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}}(safeBuffer,safeBuffer.exports),safeBuffer.exports.Buffer),isEncoding=Buffer.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function _normalizeEncoding(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}function normalizeEncoding(e){var t=_normalizeEncoding(e);if("string"==typeof t||Buffer.isEncoding!==isEncoding&&isEncoding(e))return t||e;throw new Error("Unknown encoding: "+e)}function StringDecoder(e){var t;switch(this.encoding=normalizeEncoding(e),this.encoding){case"utf16le":this.text=utf16Text,this.end=utf16End,t=4;break;case"utf8":this.fillLast=utf8FillLast,t=4;break;case"base64":this.text=base64Text,this.end=base64End,t=3;break;default:return this.write=simpleWrite,void(this.end=simpleEnd)}this.lastNeed=0,this.lastTotal=0,this.lastChar=Buffer.allocUnsafe(t)}function utf8CheckByte(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function utf8CheckIncomplete(e,t,r){var o,n=t.length-1;return n<r?0:0<=(o=utf8CheckByte(t[n]))?(0<o&&(e.lastNeed=o-1),o):--n<r||-2===o?0:0<=(o=utf8CheckByte(t[n]))?(0<o&&(e.lastNeed=o-2),o):!(--n<r||-2===o)&&0<=(o=utf8CheckByte(t[n]))?(0<o&&(2===o?o=0:e.lastNeed=o-3),o):0}function utf8CheckExtraBytes(e,t,r){return 128!=(192&t[0])?(e.lastNeed=0,"�"):1<e.lastNeed&&1<t.length?128!=(192&t[1])?(e.lastNeed=1,"�"):2<e.lastNeed&&2<t.length&&128!=(192&t[2])?(e.lastNeed=2,"�"):void 0:void 0}function utf8FillLast(e){var t=this.lastTotal-this.lastNeed,r=utf8CheckExtraBytes(this,e);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function utf8Text(e,t){var r=utf8CheckIncomplete(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;r=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)}function utf8End(e){e=e&&e.length?this.write(e):"";return this.lastNeed?e+"�":e}function utf16Text(e,t){if((e.length-t)%2!=0)return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1);t=e.toString("utf16le",t);if(t){var r=t.charCodeAt(t.length-1);if(55296<=r&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],t.slice(0,-1)}return t}function utf16End(e){var t,e=e&&e.length?this.write(e):"";return this.lastNeed?(t=this.lastTotal-this.lastNeed,e+this.lastChar.toString("utf16le",0,t)):e}function base64Text(e,t){var r=(e.length-t)%3;return 0==r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1==r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function base64End(e){e=e&&e.length?this.write(e):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function simpleWrite(e){return e.toString(this.encoding)}function simpleEnd(e){return e&&e.length?this.write(e):""}(string_decoder.StringDecoder=StringDecoder).prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},StringDecoder.prototype.end=utf8End,StringDecoder.prototype.text=utf8Text,StringDecoder.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length};var __importDefault$E=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},channel_buf_1=(Object.defineProperty(utf8,"__esModule",{value:!0}),__importDefault$E(channelBuf)),neo4j_driver_core_1$E=lib$1,buffer_1=__importDefault$E(buffer),string_decoder_1=string_decoder,decoder=new string_decoder.StringDecoder("utf8");function encode(e){return new channel_buf_1.default(newBuffer(e))}function decode(e,t){if(Object.prototype.hasOwnProperty.call(e,"_buffer"))return decodeChannelBuffer(e,t);if(Object.prototype.hasOwnProperty.call(e,"_buffers"))return decodeCombinedBuffer(e,t);throw(0,neo4j_driver_core_1$E.newError)("Don't know how to decode strings from '".concat(e,"'"))}function decodeChannelBuffer(e,t){var r=e.position,t=r+t;return e.position=Math.min(t,e.length),e._buffer.toString("utf8",r,t)}function decodeCombinedBuffer(e,t){return streamDecodeCombinedBuffer(e,t,function(e){return decoder.write(e._buffer)},function(){return decoder.end()})}function streamDecodeCombinedBuffer(e,t,n,r){var i=t,a=e.position;return e._updatePos(Math.min(t,e.length-a)),e._buffers.reduce(function(e,t){var r,o;return i<=0?e:a>=t.length?(a-=t.length,""):(t._updatePos(a-t.position),r=Math.min(t.length-a,i),o=t.readSlice(r),t._updatePos(r),i=Math.max(i-o.length,0),a=0,e+n(o))},"")+r()}function newBuffer(e){return"function"==typeof buffer_1.default.Buffer.from?buffer_1.default.Buffer.from(e,"utf8"):new buffer_1.default.Buffer(e,"utf8")}utf8.default={encode:encode,decode:decode},function(e){var o=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&("get"in n?t.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){e[o=void 0===o?r:o]=t[r]}),t=commonjsGlobal&&commonjsGlobal.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)},r=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},n=(Object.defineProperty(e,"__esModule",{value:!0}),e.utf8=e.alloc=e.ChannelConfig=void 0,t(browser,e),t(chunking,e),channelConfig),i=(Object.defineProperty(e,"ChannelConfig",{enumerable:!0,get:function(){return r(n).default}}),channelBuf),a=(Object.defineProperty(e,"alloc",{enumerable:!0,get:function(){return i.alloc}}),utf8);Object.defineProperty(e,"utf8",{enumerable:!0,get:function(){return r(a).default}})}(channel),Object.defineProperty(handshake$1,"__esModule",{value:!0});var channel_1$4=channel,neo4j_driver_core_1$D=lib$1,BOLT_MAGIC_PREAMBLE=1616949271;function version(e,t){return{major:e,minor:t}}function createHandshakeMessage(e){if(4<e.length)throw(0,neo4j_driver_core_1$D.newError)("It should not have more than 4 versions of the protocol");var n=(0,channel_1$4.alloc)(20);return n.writeInt32(BOLT_MAGIC_PREAMBLE),e.forEach(function(e){var t,r,o;e instanceof Array?(r=(o=e[0]).major,o=o.minor,t=e[1].minor,n.writeInt32(o-t<<16|o<<8|r)):(r=e.major,o=e.minor,n.writeInt32(o<<8|r))}),n.reset(),n}function parseNegotiatedResponse(e,t){e=[e.readUInt8(),e.readUInt8(),e.readUInt8(),e.readUInt8()];if(72===e[0]&&84===e[1]&&84===e[2]&&80===e[3])throw t.error("Handshake failed since server responded with HTTP."),(0,neo4j_driver_core_1$D.newError)("Server responded HTTP. Make sure you are not trying to connect to the http endpoint (HTTP defaults to port 7474 whereas BOLT defaults to port 7687)");return Number(e[3]+"."+e[2])}function newHandshakeBuffer(){return createHandshakeMessage([[version(5,7),version(5,0)],[version(4,4),version(4,2)],version(4,1),version(3,0)])}function handshake(t,n){var i=this;return new Promise(function(r,o){function e(e){o(e)}t.onerror=e.bind(i),t._error&&e(t._error),t.onmessage=function(t){try{var e=parseNegotiatedResponse(t,n);r({protocolVersion:e,consumeRemainingBuffer:function(e){t.hasRemaining()&&e(t.readSlice(t.remaining()))}})}catch(e){o(e)}},t.write(newHandshakeBuffer())})}handshake$1.default=handshake;var create$1={},boltProtocolV1={},boltProtocolUtil={},streamObservers={},routingTableRaw={},__extends$o=commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),__importDefault$D=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},RawRoutingTable=(Object.defineProperty(routingTableRaw,"__esModule",{value:!0}),__importDefault$D(lib$1),function(){function t(){}return t.ofRecord=function(e){return null===e?t.ofNull():new RecordRawRoutingTable(e)},t.ofMessageResponse=function(e){return null===e?t.ofNull():new ResponseRawRoutingTable(e)},t.ofNull=function(){return new NullRawRoutingTable},Object.defineProperty(t.prototype,"ttl",{get:function(){throw new Error("Not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"db",{get:function(){throw new Error("Not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"servers",{get:function(){throw new Error("Not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isNull",{get:function(){throw new Error("Not implemented")},enumerable:!1,configurable:!0}),t}()),ResponseRawRoutingTable=function(r){function e(e){var t=r.call(this)||this;return t._response=e,t}return __extends$o(e,r),Object.defineProperty(e.prototype,"ttl",{get:function(){return this._response.rt.ttl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"servers",{get:function(){return this._response.rt.servers},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"db",{get:function(){return this._response.rt.db},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isNull",{get:function(){return null===this._response},enumerable:!1,configurable:!0}),e}(routingTableRaw.default=RawRoutingTable),NullRawRoutingTable=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends$o(t,e),Object.defineProperty(t.prototype,"isNull",{get:function(){return!0},enumerable:!1,configurable:!0}),t}(RawRoutingTable),RecordRawRoutingTable=function(r){function e(e){var t=r.call(this)||this;return t._record=e,t}return __extends$o(e,r),Object.defineProperty(e.prototype,"ttl",{get:function(){return this._record.get("ttl")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"servers",{get:function(){return this._record.get("servers")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"db",{get:function(){return this._record.has("db")?this._record.get("db"):null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isNull",{get:function(){return null===this._record},enumerable:!1,configurable:!0}),e}(RawRoutingTable),lang={},functional={},neo4j_driver_core_1$C=(Object.defineProperty(functional,"__esModule",{value:!0}),functional.reuseOngoingRequest=functional.identity=void 0,lib$1);function identity(e){return e}function reuseOngoingRequest(n,i){void 0===i&&(i=null);var a=new Map;return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r,o=neo4j_driver_core_1$C.json.stringify(e);return a.has(o)?a.get(o):(r=n.apply(i,e),a.set(o,r),r.finally(function(){a.delete(o)}))}}functional.identity=identity,functional.reuseOngoingRequest=reuseOngoingRequest;var object={},__values$1=commonjsGlobal&&commonjsGlobal.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],o=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&o>=e.length?void 0:e)&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};function equals(e,t){var r,o;if(e!==t){if(null===e||null===t)return!1;if("object"!=typeof e||"object"!=typeof t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;try{for(var a=__values$1(n),s=a.next();!s.done;s=a.next()){var u=s.value;if(e[u]!==t[u])return!1}}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}}return!0}Object.defineProperty(object,"__esModule",{value:!0}),object.equals=void 0,object.equals=equals;var __createBinding$4=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&("get"in n?t.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){e[o=void 0===o?r:o]=t[r]}),__setModuleDefault$4=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar$4=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding$4(t,e,r);return __setModuleDefault$4(t,e),t},__extends$n=(Object.defineProperty(lang,"__esModule",{value:!0}),lang.object=lang.functional=void 0,lang.functional=__importStar$4(functional),lang.object=__importStar$4(object),commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}()),__importDefault$C=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},neo4j_driver_core_1$B=(Object.defineProperty(streamObservers,"__esModule",{value:!0}),streamObservers.TelemetryObserver=streamObservers.ProcedureRouteObserver=streamObservers.RouteObserver=streamObservers.CompletedObserver=streamObservers.FailedObserver=streamObservers.ResetObserver=streamObservers.LogoffObserver=streamObservers.LoginObserver=streamObservers.ResultStreamObserver=streamObservers.StreamObserver=void 0,lib$1),routing_table_raw_1=__importDefault$C(routingTableRaw),lang_1$4=lang,FETCH_ALL$5=neo4j_driver_core_1$B.internal.constants.FETCH_ALL,PROTOCOL_ERROR$5=neo4j_driver_core_1$B.error.PROTOCOL_ERROR,StreamObserver=function(){function e(){}return e.prototype.onNext=function(e){},e.prototype.onError=function(e){},e.prototype.onCompleted=function(e){},e}(),ResultStreamObserver=function(h){function e(e){var e=void 0===e?{}:e,t=e.reactive,t=void 0!==t&&t,r=e.moreFunction,o=e.discardFunction,n=e.fetchSize,n=void 0===n?FETCH_ALL$5:n,i=e.beforeError,a=e.afterError,s=e.beforeKeys,u=e.afterKeys,c=e.beforeComplete,l=e.afterComplete,_=e.server,f=e.highRecordWatermark,f=void 0===f?Number.MAX_VALUE:f,d=e.lowRecordWatermark,d=void 0===d?Number.MAX_VALUE:d,e=e.enrichMetadata,p=h.call(this)||this;return p._fieldKeys=null,p._fieldLookup=null,p._head=null,p._queuedRecords=[],p._tail=null,p._error=null,p._observers=[],p._meta={},p._server=_,p._beforeError=i,p._afterError=a,p._beforeKeys=s,p._afterKeys=u,p._beforeComplete=c,p._afterComplete=l,p._enrichMetadata=e||lang_1$4.functional.identity,p._queryId=null,p._moreFunction=r,p._discardFunction=o,p._discard=!1,p._fetchSize=n,p._lowRecordWatermark=d,p._highRecordWatermark=f,p._setState(t?_states.READY:_states.READY_STREAMING),p._setupAutoPull(),p._paused=!1,p._pulled=!t,p._haveRecordStreamed=!1,p}return __extends$n(e,h),e.prototype.pause=function(){this._paused=!0},e.prototype.resume=function(){this._paused=!1,this._setupAutoPull(!0),this._state.pull(this)},e.prototype.onNext=function(e){this._haveRecordStreamed=!0;var t=new neo4j_driver_core_1$B.Record(this._fieldKeys,e,this._fieldLookup);this._observers.some(function(e){return e.onNext})?this._observers.forEach(function(e){e.onNext&&e.onNext(t)}):(this._queuedRecords.push(t),this._queuedRecords.length>this._highRecordWatermark&&(this._autoPull=!1))},e.prototype.onCompleted=function(e){this._state.onSuccess(this,e)},e.prototype.onError=function(e){this._state.onError(this,e)},e.prototype.cancel=function(){this._discard=!0},e.prototype.prepareToHandleSingleResponse=function(){this._head=[],this._fieldKeys=[],this._setState(_states.STREAMING)},e.prototype.markCompleted=function(){this._head=[],this._fieldKeys=[],this._tail={},this._setState(_states.SUCCEEDED)},e.prototype.subscribe=function(e){if(this._head&&e.onKeys&&e.onKeys(this._head),0<this._queuedRecords.length&&e.onNext)for(var t=0;t<this._queuedRecords.length;t++)e.onNext(this._queuedRecords[t]),this._queuedRecords.length-t-1<=this._lowRecordWatermark&&(this._autoPull=!0,this._state===_states.READY)&&this._handleStreaming();this._tail&&e.onCompleted&&e.onCompleted(this._tail),this._error&&e.onError(this._error),this._observers.push(e),this._state===_states.READY&&this._handleStreaming()},e.prototype._handleHasMore=function(e){this._setState(_states.READY),this._handleStreaming(),delete e.has_more},e.prototype._handlePullSuccess=function(e){var t,r=this,o=this._enrichMetadata(Object.assign(this._server?{server:this._server}:{},this._meta,{stream_summary:{have_records_streamed:this._haveRecordStreamed,pulled:this._pulled,has_keys:0<this._fieldKeys.length}},e));[void 0,null,"r","w","rw","s"].includes(o.type)?(this._setState(_states.SUCCEEDED),e=null,t=function(){r._tail=o,r._observers.some(function(e){return e.onCompleted})&&r._observers.forEach(function(e){e.onCompleted&&e.onCompleted(o)}),r._afterComplete&&r._afterComplete(o)},(e=this._beforeComplete?this._beforeComplete(o):e)?Promise.resolve(e).then(t):t()):this.onError((0,neo4j_driver_core_1$B.newError)('Server returned invalid query type. Expected one of [undefined, null, "r", "w", "rw", "s"] but got \''.concat(o.type,"'"),PROTOCOL_ERROR$5))},e.prototype._handleRunSuccess=function(e,t){var r=this;if(null===this._fieldKeys){if(this._fieldKeys=[],this._fieldLookup={},e.fields&&0<e.fields.length){this._fieldKeys=e.fields;for(var o=0;o<e.fields.length;o++)this._fieldLookup[e.fields[o]]=o}null!=e.fields&&delete e.fields,null!==e.qid&&void 0!==e.qid&&(this._queryId=e.qid,delete e.qid),this._storeMetadataForCompletion(e);function n(){r._head=r._fieldKeys,r._observers.some(function(e){return e.onKeys})&&r._observers.forEach(function(e){e.onKeys&&e.onKeys(r._fieldKeys)}),r._afterKeys&&r._afterKeys(r._fieldKeys),t()}var i=null;this._beforeKeys&&(i=this._beforeKeys(this._fieldKeys));i?Promise.resolve(i).then(n):n()}},e.prototype._handleError=function(t){function e(){r._observers.some(function(e){return e.onError})&&r._observers.forEach(function(e){e.onError&&e.onError(t)}),r._afterError&&r._afterError(t)}var r=this,o=(this._setState(_states.FAILED),this._error=t,null);this._beforeError&&(o=this._beforeError(t));o?Promise.resolve(o).then(e):e()},e.prototype._handleStreaming=function(){this._head&&this._observers.some(function(e){return e.onNext||e.onCompleted})&&(this._paused||!this._discard&&!this._autoPull||this._more())},e.prototype._more=function(){this._discard?this._discardFunction(this._queryId,this):(this._pulled=!0,this._moreFunction(this._queryId,this._fetchSize,this)),this._setState(_states.STREAMING)},e.prototype._storeMetadataForCompletion=function(e){for(var t,r=Object.keys(e),o=r.length;o--;)t=r[o],this._meta[t]=e[t]},e.prototype._setState=function(e){this._state=e},e.prototype._setupAutoPull=function(){this._autoPull=!0},e}(streamObservers.StreamObserver=StreamObserver),LoginObserver=(streamObservers.ResultStreamObserver=ResultStreamObserver,function(o){function e(e){var e=void 0===e?{}:e,t=e.onError,e=e.onCompleted,r=o.call(this)||this;return r._onError=t,r._onCompleted=e,r}return __extends$n(e,o),e.prototype.onNext=function(e){this.onError((0,neo4j_driver_core_1$B.newError)("Received RECORD when initializing "+neo4j_driver_core_1$B.json.stringify(e)))},e.prototype.onError=function(e){this._onError&&this._onError(e)},e.prototype.onCompleted=function(e){this._onCompleted&&this._onCompleted(e)},e}(StreamObserver)),LogoffObserver=(streamObservers.LoginObserver=LoginObserver,function(o){function e(e){var e=void 0===e?{}:e,t=e.onError,e=e.onCompleted,r=o.call(this)||this;return r._onError=t,r._onCompleted=e,r}return __extends$n(e,o),e.prototype.onNext=function(e){this.onError((0,neo4j_driver_core_1$B.newError)("Received RECORD when logging off "+neo4j_driver_core_1$B.json.stringify(e)))},e.prototype.onError=function(e){this._onError&&this._onError(e)},e.prototype.onCompleted=function(e){this._onCompleted&&this._onCompleted(e)},e}(StreamObserver)),ResetObserver=(streamObservers.LogoffObserver=LogoffObserver,function(n){function e(e){var e=void 0===e?{}:e,t=e.onProtocolError,r=e.onError,e=e.onComplete,o=n.call(this)||this;return o._onProtocolError=t,o._onError=r,o._onComplete=e,o}return __extends$n(e,n),e.prototype.onNext=function(e){this.onError((0,neo4j_driver_core_1$B.newError)("Received RECORD when resetting: received record is: "+neo4j_driver_core_1$B.json.stringify(e),PROTOCOL_ERROR$5))},e.prototype.onError=function(e){e.code===PROTOCOL_ERROR$5&&this._onProtocolError&&this._onProtocolError(e.message),this._onError&&this._onError(e)},e.prototype.onCompleted=function(e){this._onComplete&&this._onComplete(e)},e}(StreamObserver)),TelemetryObserver=(streamObservers.ResetObserver=ResetObserver,function(o){function e(e){var e=void 0===e?{}:e,t=e.onError,e=e.onCompleted,r=o.call(this)||this;return r._onError=t,r._onCompleted=e,r}return __extends$n(e,o),e.prototype.onNext=function(e){this.onError((0,neo4j_driver_core_1$B.newError)("Received RECORD when sending telemetry "+neo4j_driver_core_1$B.json.stringify(e),PROTOCOL_ERROR$5))},e.prototype.onError=function(e){this._onError&&this._onError(e)},e.prototype.onCompleted=function(e){this._onCompleted&&this._onCompleted(e)},e}(ResultStreamObserver)),FailedObserver=(streamObservers.TelemetryObserver=TelemetryObserver,function(r){function e(e){var t=e.error,e=e.onError,e=r.call(this,{beforeError:e})||this;return e.onError(t),e}return __extends$n(e,r),e}(ResultStreamObserver)),CompletedObserver=(streamObservers.FailedObserver=FailedObserver,function(t){function e(){var e=t.call(this)||this;return t.prototype.markCompleted.call(e),e}return __extends$n(e,t),e}(ResultStreamObserver)),ProcedureRouteObserver=(streamObservers.CompletedObserver=CompletedObserver,function(i){function e(e){var t=e.resultObserver,r=e.onProtocolError,o=e.onError,e=e.onCompleted,n=i.call(this)||this;return n._resultObserver=t,n._onError=o,n._onCompleted=e,n._records=[],n._onProtocolError=r,t.subscribe(n),n}return __extends$n(e,i),e.prototype.onNext=function(e){this._records.push(e)},e.prototype.onError=function(e){e.code===PROTOCOL_ERROR$5&&this._onProtocolError&&this._onProtocolError(e.message),this._onError&&this._onError(e)},e.prototype.onCompleted=function(){null!==this._records&&1!==this._records.length?this.onError((0,neo4j_driver_core_1$B.newError)("Illegal response from router. Received "+this._records.length+" records but expected only one.\n"+neo4j_driver_core_1$B.json.stringify(this._records),PROTOCOL_ERROR$5)):this._onCompleted&&this._onCompleted(routing_table_raw_1.default.ofRecord(this._records[0]))},e}(StreamObserver)),RouteObserver=(streamObservers.ProcedureRouteObserver=ProcedureRouteObserver,function(n){function e(e){var e=void 0===e?{}:e,t=e.onProtocolError,r=e.onError,e=e.onCompleted,o=n.call(this)||this;return o._onProtocolError=t,o._onError=r,o._onCompleted=e,o}return __extends$n(e,n),e.prototype.onNext=function(e){this.onError((0,neo4j_driver_core_1$B.newError)("Received RECORD when resetting: received record is: "+neo4j_driver_core_1$B.json.stringify(e),PROTOCOL_ERROR$5))},e.prototype.onError=function(e){e.code===PROTOCOL_ERROR$5&&this._onProtocolError&&this._onProtocolError(e.message),this._onError&&this._onError(e)},e.prototype.onCompleted=function(e){this._onCompleted&&this._onCompleted(routing_table_raw_1.default.ofMessageResponse(e))},e}(StreamObserver)),_states=(streamObservers.RouteObserver=RouteObserver,{READY_STREAMING:{onSuccess:function(e,t){e._handleRunSuccess(t,function(){e._setState(_states.STREAMING)})},onError:function(e,t){e._handleError(t)},name:function(){return"READY_STREAMING"},pull:function(){}},READY:{onSuccess:function(e,t){e._handleRunSuccess(t,function(){return e._handleStreaming()})},onError:function(e,t){e._handleError(t)},name:function(){return"READY"},pull:function(e){return e._more()}},STREAMING:{onSuccess:function(e,t){t.has_more?e._handleHasMore(t):e._handlePullSuccess(t)},onError:function(e,t){e._handleError(t)},name:function(){return"STREAMING"},pull:function(){}},FAILED:{onError:function(e){},name:function(){return"FAILED"},pull:function(){}},SUCCEEDED:{name:function(){return"SUCCEEDED"},pull:function(){}}}),neo4j_driver_core_1$A=(Object.defineProperty(boltProtocolUtil,"__esModule",{value:!0}),boltProtocolUtil.assertNotificationFilterIsEmpty=boltProtocolUtil.assertImpersonatedUserIsEmpty=boltProtocolUtil.assertTxConfigIsEmpty=boltProtocolUtil.assertDatabaseIsEmpty=void 0,lib$1);function assertTxConfigIsEmpty(e,t,r){if(void 0===t&&(t=function(){}),e&&!e.isEmpty())throw t((e=(0,neo4j_driver_core_1$A.newError)("Driver is connected to the database that does not support transaction configuration. Please upgrade to neo4j 3.5.0 or later in order to use this functionality")).message),r.onError(e),e}function assertDatabaseIsEmpty(e,t,r){if(void 0===t&&(t=function(){}),e)throw t((e=(0,neo4j_driver_core_1$A.newError)("Driver is connected to the database that does not support multiple databases. Please upgrade to neo4j 4.0.0 or later in order to use this functionality")).message),r.onError(e),e}function assertImpersonatedUserIsEmpty(e,t,r){if(void 0===t&&(t=function(){}),e)throw t((t=(0,neo4j_driver_core_1$A.newError)("Driver is connected to the database that does not support user impersonation. Please upgrade to neo4j 4.4.0 or later in order to use this functionality. "+"Trying to impersonate ".concat(e,"."))).message),r.onError(t),t}function assertNotificationFilterIsEmpty(e,t,r){if(void 0===t&&(t=function(){}),void 0!==e)throw t((t=(0,neo4j_driver_core_1$A.newError)("Driver is connected to a database that does not support user notification filters. Please upgrade to Neo4j 5.7.0 or later in order to use this functionality. "+"Trying to set notifications to ".concat(neo4j_driver_core_1$A.json.stringify(e),"."))).message),r.onError(t),t}boltProtocolUtil.assertTxConfigIsEmpty=assertTxConfigIsEmpty,boltProtocolUtil.assertDatabaseIsEmpty=assertDatabaseIsEmpty,boltProtocolUtil.assertImpersonatedUserIsEmpty=assertImpersonatedUserIsEmpty,boltProtocolUtil.assertNotificationFilterIsEmpty=assertNotificationFilterIsEmpty;var packstream={},packstreamV1={},structure$1={},neo4j_driver_core_1$z=(Object.defineProperty(structure$1,"__esModule",{value:!0}),structure$1.verifyStructSize=structure$1.Structure=void 0,lib$1),PROTOCOL_ERROR$4=neo4j_driver_core_1$z.error.PROTOCOL_ERROR,Structure=function(){function e(e,t){this.signature=e,this.fields=t}return Object.defineProperty(e.prototype,"size",{get:function(){return this.fields.length},enumerable:!1,configurable:!0}),e.prototype.toString=function(){for(var e="",t=0;t<this.fields.length;t++)0<t&&(e+=", "),e+=this.fields[t];return"Structure("+this.signature+", ["+e+"])"},e}();function verifyStructSize(e,t,r){if(t!==r)throw(0,neo4j_driver_core_1$z.newError)("Wrong struct size for ".concat(e,", expected ").concat(t," but was ").concat(r),PROTOCOL_ERROR$4)}structure$1.Structure=Structure,structure$1.verifyStructSize=verifyStructSize,structure$1.default=Structure,Object.defineProperty(packstreamV1,"__esModule",{value:!0}),packstreamV1.Unpacker=packstreamV1.Packer=void 0;var channel_1$3=channel,lang_1$3=lang,structure_1=structure$1,neo4j_driver_core_1$y=lib$1,PROTOCOL_ERROR$3=neo4j_driver_core_1$y.error.PROTOCOL_ERROR,TINY_STRING=128,TINY_LIST=144,TINY_MAP=160,TINY_STRUCT=176,NULL=192,FLOAT_64=193,FALSE=194,TRUE=195,INT_8=200,INT_16=201,INT_32=202,INT_64=203,STRING_8=208,STRING_16=209,STRING_32=210,LIST_8=212,LIST_16=213,LIST_32=214,BYTES_8=204,BYTES_16=205,BYTES_32=206,MAP_8=216,MAP_16=217,MAP_32=218,STRUCT_8=220,STRUCT_16=221,Packer$1=function(){function e(e){this._ch=e,this._byteArraysSupported=!0}return e.prototype.packable=function(n,i){var a=this;void 0===i&&(i=lang_1$3.functional.identity);try{n=i(n)}catch(e){return function(){throw e}}if(null===n)return function(){return a._ch.writeUInt8(NULL)};if(!0===n)return function(){return a._ch.writeUInt8(TRUE)};if(!1===n)return function(){return a._ch.writeUInt8(FALSE)};if("number"==typeof n)return function(){return a.packFloat(n)};if("string"==typeof n)return function(){return a.packString(n)};if("bigint"==typeof n)return function(){return a.packInteger((0,neo4j_driver_core_1$y.int)(n))};if((0,neo4j_driver_core_1$y.isInt)(n))return function(){return a.packInteger(n)};if(n instanceof Int8Array)return function(){return a.packBytes(n)};if(n instanceof Array)return function(){a.packListHeader(n.length);for(var e=0;e<n.length;e++)a.packable(void 0===n[e]?null:n[e],i)()};if(isIterable(n))return this.packableIterable(n,i);if(n instanceof structure_1.Structure){for(var e=[],t=0;t<n.fields.length;t++)e[t]=this.packable(n.fields[t],i);return function(){return a.packStruct(n.signature,e)}}return"object"==typeof n?function(){for(var e=Object.keys(n),t=0,r=0;r<e.length;r++)void 0!==n[e[r]]&&t++;a.packMapHeader(t);for(r=0;r<e.length;r++){var o=e[r];void 0!==n[o]&&(a.packString(o),a.packable(n[o],i)())}}:this._nonPackableValue("Unable to pack the given value: ".concat(n))},e.prototype.packableIterable=function(t,e){try{var r=Array.from(t);return this.packable(r,e)}catch(e){throw(0,neo4j_driver_core_1$y.newError)("Cannot pack given iterable, ".concat(e.message,": ").concat(t))}},e.prototype.packStruct=function(e,t){this.packStructHeader((t=t||[]).length,e);for(var r=0;r<t.length;r++)t[r]()},e.prototype.packInteger=function(e){var t=e.high,r=e.low;e.greaterThanOrEqual(-16)&&e.lessThan(128)?this._ch.writeInt8(r):e.greaterThanOrEqual(-128)&&e.lessThan(-16)?(this._ch.writeUInt8(INT_8),this._ch.writeInt8(r)):e.greaterThanOrEqual(-32768)&&e.lessThan(32768)?(this._ch.writeUInt8(INT_16),this._ch.writeInt16(r)):(e.greaterThanOrEqual(-2147483648)&&e.lessThan(2147483648)?this._ch.writeUInt8(INT_32):(this._ch.writeUInt8(INT_64),this._ch.writeInt32(t)),this._ch.writeInt32(r))},e.prototype.packFloat=function(e){this._ch.writeUInt8(FLOAT_64),this._ch.writeFloat64(e)},e.prototype.packString=function(e){var e=channel_1$3.utf8.encode(e),t=e.length;if(t<16)this._ch.writeUInt8(TINY_STRING|t);else if(t<256)this._ch.writeUInt8(STRING_8),this._ch.writeUInt8(t);else{if(t<65536)this._ch.writeUInt8(STRING_16),this._ch.writeUInt8(t/256>>0);else{if(!(t<4294967296))throw(0,neo4j_driver_core_1$y.newError)("UTF-8 strings of size "+t+" are not supported");this._ch.writeUInt8(STRING_32),this._ch.writeUInt8((t/16777216>>0)%256),this._ch.writeUInt8((t/65536>>0)%256),this._ch.writeUInt8((t/256>>0)%256)}this._ch.writeUInt8(t%256)}this._ch.writeBytes(e)},e.prototype.packListHeader=function(e){if(e<16)this._ch.writeUInt8(TINY_LIST|e);else if(e<256)this._ch.writeUInt8(LIST_8),this._ch.writeUInt8(e);else{if(e<65536)this._ch.writeUInt8(LIST_16);else{if(!(e<4294967296))throw(0,neo4j_driver_core_1$y.newError)("Lists of size "+e+" are not supported");this._ch.writeUInt8(LIST_32),this._ch.writeUInt8((e/16777216>>0)%256),this._ch.writeUInt8((e/65536>>0)%256)}this._ch.writeUInt8((e/256>>0)%256),this._ch.writeUInt8(e%256)}},e.prototype.packBytes=function(e){if(!this._byteArraysSupported)throw(0,neo4j_driver_core_1$y.newError)("Byte arrays are not supported by the database this driver is connected to");this.packBytesHeader(e.length);for(var t=0;t<e.length;t++)this._ch.writeInt8(e[t])},e.prototype.packBytesHeader=function(e){if(e<256)this._ch.writeUInt8(BYTES_8),this._ch.writeUInt8(e);else{if(e<65536)this._ch.writeUInt8(BYTES_16);else{if(!(e<4294967296))throw(0,neo4j_driver_core_1$y.newError)("Byte arrays of size "+e+" are not supported");this._ch.writeUInt8(BYTES_32),this._ch.writeUInt8((e/16777216>>0)%256),this._ch.writeUInt8((e/65536>>0)%256)}this._ch.writeUInt8((e/256>>0)%256),this._ch.writeUInt8(e%256)}},e.prototype.packMapHeader=function(e){if(e<16)this._ch.writeUInt8(TINY_MAP|e);else if(e<256)this._ch.writeUInt8(MAP_8),this._ch.writeUInt8(e);else{if(e<65536)this._ch.writeUInt8(MAP_16),this._ch.writeUInt8(e/256>>0);else{if(!(e<4294967296))throw(0,neo4j_driver_core_1$y.newError)("Maps of size "+e+" are not supported");this._ch.writeUInt8(MAP_32),this._ch.writeUInt8((e/16777216>>0)%256),this._ch.writeUInt8((e/65536>>0)%256),this._ch.writeUInt8((e/256>>0)%256)}this._ch.writeUInt8(e%256)}},e.prototype.packStructHeader=function(e,t){if(e<16)this._ch.writeUInt8(TINY_STRUCT|e),this._ch.writeUInt8(t);else if(e<256)this._ch.writeUInt8(STRUCT_8),this._ch.writeUInt8(e),this._ch.writeUInt8(t);else{if(!(e<65536))throw(0,neo4j_driver_core_1$y.newError)("Structures of size "+e+" are not supported");this._ch.writeUInt8(STRUCT_16),this._ch.writeUInt8(e/256>>0),this._ch.writeUInt8(e%256)}},e.prototype.disableByteArrays=function(){this._byteArraysSupported=!1},e.prototype._nonPackableValue=function(e){return function(){throw(0,neo4j_driver_core_1$y.newError)(e,PROTOCOL_ERROR$3)}},e}(),Unpacker$1=(packstreamV1.Packer=Packer$1,function(){function e(e,t){void 0===t&&(t=!1),this._disableLosslessIntegers=e=void 0===e?!1:e,this._useBigInt=t}return e.prototype.unpack=function(e,t){void 0===t&&(t=lang_1$3.functional.identity);var r=e.readUInt8(),o=240&r,n=15&r;if(r===NULL)return null;var i=this._unpackBoolean(r);if(null!==i)return i;i=this._unpackNumberOrInteger(r,e);if(null!==i){if((0,neo4j_driver_core_1$y.isInt)(i)){if(this._useBigInt)return i.toBigInt();if(this._disableLosslessIntegers)return i.toNumberOrInfinity()}return i}i=this._unpackString(r,o,n,e);if(null!==i)return i;i=this._unpackList(r,o,n,e,t);if(null!==i)return i;i=this._unpackByteArray(r,e);if(null!==i)return i;i=this._unpackMap(r,o,n,e,t);if(null!==i)return i;i=this._unpackStruct(r,o,n,e,t);if(null!==i)return i;throw(0,neo4j_driver_core_1$y.newError)("Unknown packed value with marker "+r.toString(16))},e.prototype.unpackInteger=function(e){var t=e.readUInt8(),e=this._unpackInteger(t,e);if(null==e)throw(0,neo4j_driver_core_1$y.newError)("Unable to unpack integer value with marker "+t.toString(16));return e},e.prototype._unpackBoolean=function(e){return e===TRUE||e!==FALSE&&null},e.prototype._unpackNumberOrInteger=function(e,t){return e===FLOAT_64?t.readFloat64():this._unpackInteger(e,t)},e.prototype._unpackInteger=function(e,t){var r;return 0<=e&&e<128?(0,neo4j_driver_core_1$y.int)(e):240<=e&&e<256?(0,neo4j_driver_core_1$y.int)(e-256):e===INT_8?(0,neo4j_driver_core_1$y.int)(t.readInt8()):e===INT_16?(0,neo4j_driver_core_1$y.int)(t.readInt16()):e===INT_32?(r=t.readInt32(),(0,neo4j_driver_core_1$y.int)(r)):e===INT_64?(r=t.readInt32(),e=t.readInt32(),new neo4j_driver_core_1$y.Integer(e,r)):null},e.prototype._unpackString=function(e,t,r,o){return t===TINY_STRING?channel_1$3.utf8.decode(o,r):e===STRING_8?channel_1$3.utf8.decode(o,o.readUInt8()):e===STRING_16?channel_1$3.utf8.decode(o,o.readUInt16()):e===STRING_32?channel_1$3.utf8.decode(o,o.readUInt32()):null},e.prototype._unpackList=function(e,t,r,o,n){return t===TINY_LIST?this._unpackListWithSize(r,o,n):e===LIST_8?this._unpackListWithSize(o.readUInt8(),o,n):e===LIST_16?this._unpackListWithSize(o.readUInt16(),o,n):e===LIST_32?this._unpackListWithSize(o.readUInt32(),o,n):null},e.prototype._unpackListWithSize=function(e,t,r){for(var o=[],n=0;n<e;n++)o.push(this.unpack(t,r));return o},e.prototype._unpackByteArray=function(e,t){return e===BYTES_8?this._unpackByteArrayWithSize(t.readUInt8(),t):e===BYTES_16?this._unpackByteArrayWithSize(t.readUInt16(),t):e===BYTES_32?this._unpackByteArrayWithSize(t.readUInt32(),t):null},e.prototype._unpackByteArrayWithSize=function(e,t){for(var r=new Int8Array(e),o=0;o<e;o++)r[o]=t.readInt8();return r},e.prototype._unpackMap=function(e,t,r,o,n){return t===TINY_MAP?this._unpackMapWithSize(r,o,n):e===MAP_8?this._unpackMapWithSize(o.readUInt8(),o,n):e===MAP_16?this._unpackMapWithSize(o.readUInt16(),o,n):e===MAP_32?this._unpackMapWithSize(o.readUInt32(),o,n):null},e.prototype._unpackMapWithSize=function(e,t,r){for(var o={},n=0;n<e;n++)o[this.unpack(t,r)]=this.unpack(t,r);return o},e.prototype._unpackStruct=function(e,t,r,o,n){return t===TINY_STRUCT?this._unpackStructWithSize(r,o,n):e===STRUCT_8?this._unpackStructWithSize(o.readUInt8(),o,n):e===STRUCT_16?this._unpackStructWithSize(o.readUInt16(),o,n):null},e.prototype._unpackStructWithSize=function(e,t,r){for(var o=t.readUInt8(),n=new structure_1.Structure(o,[]),i=0;i<e;i++)n.fields.push(this.unpack(t,r));return r(n)},e}());function isIterable(e){return null!=e&&"function"==typeof e[Symbol.iterator]}packstreamV1.Unpacker=Unpacker$1;var packstreamV2={},__extends$m=commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),__createBinding$3=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&("get"in n?t.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){e[o=void 0===o?r:o]=t[r]}),__setModuleDefault$3=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar$3=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding$3(t,e,r);return __setModuleDefault$3(t,e),t},v1$1=(Object.defineProperty(packstreamV2,"__esModule",{value:!0}),packstreamV2.Unpacker=packstreamV2.Packer=void 0,__importStar$3(packstreamV1)),Packer=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends$m(t,e),t.prototype.disableByteArrays=function(){throw new Error("Bolt V2 should always support byte arrays")},t}(v1$1.Packer),Unpacker=(packstreamV2.Packer=Packer,function(r){function e(e,t){return r.call(this,e=void 0===e?!1:e,t=void 0===t?!1:t)||this}return __extends$m(e,r),e}(v1$1.Unpacker)),__createBinding$2=(packstreamV2.Unpacker=Unpacker,commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&("get"in n?t.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){e[o=void 0===o?r:o]=t[r]})),__setModuleDefault$2=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar$2=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding$2(t,e,r);return __setModuleDefault$2(t,e),t},v1=(Object.defineProperty(packstream,"__esModule",{value:!0}),packstream.structure=packstream.v2=packstream.v1=void 0,__importStar$2(packstreamV1)),v2=(packstream.v1=v1,__importStar$2(packstreamV2)),structure=(packstream.v2=v2,__importStar$2(structure$1)),requestMessage=(packstream.structure=structure,packstream.default=v2,{}),neo4j_driver_core_1$x=(Object.defineProperty(requestMessage,"__esModule",{value:!0}),requestMessage.SIGNATURES=void 0,lib$1),_a$b=neo4j_driver_core_1$x.internal.constants,ACCESS_MODE_READ=_a$b.ACCESS_MODE_READ,FETCH_ALL$4=_a$b.FETCH_ALL,assertString=neo4j_driver_core_1$x.internal.util.assertString,INIT=1,RESET=15,RUN=16,PULL_ALL=63,HELLO=1,GOODBYE=2,BEGIN=17,COMMIT=18,ROLLBACK=19,TELEMETRY=84,ROUTE=102,LOGON=106,LOGOFF=107,DISCARD=47,PULL=63,READ_MODE="r",NO_STATEMENT_ID=-1,SIGNATURES=Object.freeze({INIT:INIT,RESET:RESET,RUN:RUN,PULL_ALL:PULL_ALL,HELLO:HELLO,GOODBYE:GOODBYE,BEGIN:BEGIN,COMMIT:COMMIT,ROLLBACK:ROLLBACK,TELEMETRY:TELEMETRY,ROUTE:ROUTE,LOGON:LOGON,LOGOFF:LOGOFF,DISCARD:DISCARD,PULL:PULL}),RequestMessage=(requestMessage.SIGNATURES=SIGNATURES,function(){function i(e,t,r){this.signature=e,this.fields=t,this.toString=r}return i.init=function(e,t){return new i(INIT,[e,t],function(){return"INIT ".concat(e," {...}")})},i.run=function(e,t){return new i(RUN,[e,t],function(){return"RUN ".concat(e," ").concat(neo4j_driver_core_1$x.json.stringify(t))})},i.pullAll=function(){return PULL_ALL_MESSAGE},i.reset=function(){return RESET_MESSAGE},i.hello=function(e,t,r,o){void 0===r&&(r=null),void 0===o&&(o=null);t=Object.assign({user_agent:e},t);return r&&(t.routing=r),o&&(t.patch_bolt=o),new i(HELLO,[t],function(){return"HELLO {user_agent: '".concat(e,"', ...}")})},i.hello5x1=function(e,t){var r={user_agent:e};return(t=void 0===t?null:t)&&(r.routing=t),new i(HELLO,[r],function(){return"HELLO {user_agent: '".concat(e,"', ...}")})},i.hello5x2=function(e,t,r){void 0===r&&(r=null);var o={user_agent:e};return appendLegacyNotificationFilterToMetadata(o,t=void 0===t?null:t),r&&(o.routing=r),new i(HELLO,[o],function(){return"HELLO ".concat(neo4j_driver_core_1$x.json.stringify(o))})},i.hello5x3=function(e,t,r,o){void 0===r&&(r=null),void 0===o&&(o=null);var n={};return e&&(n.user_agent=e),t&&(n.bolt_agent={product:t.product,platform:t.platform,language:t.language,language_details:t.languageDetails}),appendLegacyNotificationFilterToMetadata(n,r),o&&(n.routing=o),new i(HELLO,[n],function(){return"HELLO ".concat(neo4j_driver_core_1$x.json.stringify(n))})},i.hello5x5=function(e,t,r,o){void 0===r&&(r=null),void 0===o&&(o=null);var n={};return e&&(n.user_agent=e),t&&(n.bolt_agent={product:t.product,platform:t.platform,language:t.language,language_details:t.languageDetails}),appendGqlNotificationFilterToMetadata(n,r),o&&(n.routing=o),new i(HELLO,[n],function(){return"HELLO ".concat(neo4j_driver_core_1$x.json.stringify(n))})},i.logon=function(e){return new i(LOGON,[e],function(){return"LOGON { ... }"})},i.logoff=function(){return new i(LOGOFF,[],function(){return"LOGOFF"})},i.begin=function(e){var e=void 0===e?{}:e,t=buildTxMetadata(e.bookmarks,e.txConfig,e.database,e.mode,e.impersonatedUser,e.notificationFilter);return new i(BEGIN,[t],function(){return"BEGIN ".concat(neo4j_driver_core_1$x.json.stringify(t))})},i.begin5x5=function(e){var e=void 0===e?{}:e,t=buildTxMetadata(e.bookmarks,e.txConfig,e.database,e.mode,e.impersonatedUser,e.notificationFilter,{appendNotificationFilter:appendGqlNotificationFilterToMetadata});return new i(BEGIN,[t],function(){return"BEGIN ".concat(neo4j_driver_core_1$x.json.stringify(t))})},i.commit=function(){return COMMIT_MESSAGE},i.rollback=function(){return ROLLBACK_MESSAGE},i.runWithMetadata=function(e,t,r){var r=void 0===r?{}:r,o=buildTxMetadata(r.bookmarks,r.txConfig,r.database,r.mode,r.impersonatedUser,r.notificationFilter);return new i(RUN,[e,t,o],function(){return"RUN ".concat(e," ").concat(neo4j_driver_core_1$x.json.stringify(t)," ").concat(neo4j_driver_core_1$x.json.stringify(o))})},i.runWithMetadata5x5=function(e,t,r){var r=void 0===r?{}:r,o=buildTxMetadata(r.bookmarks,r.txConfig,r.database,r.mode,r.impersonatedUser,r.notificationFilter,{appendNotificationFilter:appendGqlNotificationFilterToMetadata});return new i(RUN,[e,t,o],function(){return"RUN ".concat(e," ").concat(neo4j_driver_core_1$x.json.stringify(t)," ").concat(neo4j_driver_core_1$x.json.stringify(o))})},i.goodbye=function(){return GOODBYE_MESSAGE},i.pull=function(e){var e=void 0===e?{}:e,t=e.stmtId,t=void 0===t?NO_STATEMENT_ID:t,e=e.n,r=buildStreamMetadata(null==t?NO_STATEMENT_ID:t,(void 0===e?FETCH_ALL$4:e)||FETCH_ALL$4);return new i(PULL,[r],function(){return"PULL ".concat(neo4j_driver_core_1$x.json.stringify(r))})},i.discard=function(e){var e=void 0===e?{}:e,t=e.stmtId,t=void 0===t?NO_STATEMENT_ID:t,e=e.n,r=buildStreamMetadata(null==t?NO_STATEMENT_ID:t,(void 0===e?FETCH_ALL$4:e)||FETCH_ALL$4);return new i(DISCARD,[r],function(){return"DISCARD ".concat(neo4j_driver_core_1$x.json.stringify(r))})},i.telemetry=function(e){var e=e.api,t=(0,neo4j_driver_core_1$x.int)(e);return new i(TELEMETRY,[t],function(){return"TELEMETRY ".concat(t.toString())})},i.route=function(e,t,r){return new i(ROUTE,[e=void 0===e?{}:e,t=void 0===t?[]:t,r=void 0===r?null:r],function(){return"ROUTE ".concat(neo4j_driver_core_1$x.json.stringify(e)," ").concat(neo4j_driver_core_1$x.json.stringify(t)," ").concat(r)})},i.routeV4x4=function(e,t,r){void 0===e&&(e={}),void 0===t&&(t=[]);var o={};return(r=void 0===r?{}:r).databaseName&&(o.db=r.databaseName),r.impersonatedUser&&(o.imp_user=r.impersonatedUser),new i(ROUTE,[e,t,o],function(){return"ROUTE ".concat(neo4j_driver_core_1$x.json.stringify(e)," ").concat(neo4j_driver_core_1$x.json.stringify(t)," ").concat(neo4j_driver_core_1$x.json.stringify(o))})},i}());function buildTxMetadata(e,t,r,o,n,i,a){void 0===a&&(a={});var s={};return e.isEmpty()||(s.bookmarks=e.values()),null!==t.timeout&&(s.tx_timeout=t.timeout),t.metadata&&(s.tx_metadata=t.metadata),r&&(s.db=assertString(r,"database")),n&&(s.imp_user=assertString(n,"impersonatedUser")),o===ACCESS_MODE_READ&&(s.mode=READ_MODE),(null!=(e=a.appendNotificationFilter)?e:appendLegacyNotificationFilterToMetadata)(s,i),s}function buildStreamMetadata(e,t){t={n:(0,neo4j_driver_core_1$x.int)(t)};return e!==NO_STATEMENT_ID&&(t.qid=(0,neo4j_driver_core_1$x.int)(e)),t}function appendLegacyNotificationFilterToMetadata(e,t){t&&(t.minimumSeverityLevel&&(e.notifications_minimum_severity=t.minimumSeverityLevel),t.disabledCategories&&(e.notifications_disabled_categories=t.disabledCategories),t.disabledClassifications)&&(e.notifications_disabled_categories=t.disabledClassifications)}function appendGqlNotificationFilterToMetadata(e,t){t&&(t.minimumSeverityLevel&&(e.notifications_minimum_severity=t.minimumSeverityLevel),t.disabledCategories&&(e.notifications_disabled_classifications=t.disabledCategories),t.disabledClassifications)&&(e.notifications_disabled_classifications=t.disabledClassifications)}var PULL_ALL_MESSAGE=new(requestMessage.default=RequestMessage)(PULL_ALL,[],function(){return"PULL_ALL"}),RESET_MESSAGE=new RequestMessage(RESET,[],function(){return"RESET"}),COMMIT_MESSAGE=new RequestMessage(COMMIT,[],function(){return"COMMIT"}),ROLLBACK_MESSAGE=new RequestMessage(ROLLBACK,[],function(){return"ROLLBACK"}),GOODBYE_MESSAGE=new RequestMessage(GOODBYE,[],function(){return"GOODBYE"}),boltProtocolV1_transformer={},transformer={},packstream_1$6=(Object.defineProperty(transformer,"__esModule",{value:!0}),transformer.TypeTransformer=void 0,packstream),neo4j_driver_core_1$w=lib$1,objectUtil=lib$1.internal.objectUtil,Transformer=function(){function e(e){this._transformers=e,this._transformersPerSignature=new Map(e.map(function(e){return[e.signature,e]})),this.fromStructure=this.fromStructure.bind(this),this.toStructure=this.toStructure.bind(this),Object.freeze(this)}return e.prototype.fromStructure=function(e){try{return e instanceof packstream_1$6.structure.Structure&&this._transformersPerSignature.has(e.signature)?(0,this._transformersPerSignature.get(e.signature).fromStructure)(e):e}catch(e){return objectUtil.createBrokenObject(e)}},e.prototype.toStructure=function(t){var e=this._transformers.find(function(e){return(0,e.isTypeInstance)(t)});return void 0!==e?e.toStructure(t):t},e}(),TypeTransformer=(transformer.default=Transformer,function(){function n(e){var t=e.signature,r=e.fromStructure,o=e.toStructure,e=e.isTypeInstance;this.signature=t,this.isTypeInstance=e,this.fromStructure=r,this.toStructure=o,Object.freeze(this)}return n.prototype.extendsWith=function(e){var t=e.signature,r=e.fromStructure,o=e.toStructure,e=e.isTypeInstance;return new n({signature:t||this.signature,fromStructure:r||this.fromStructure,toStructure:o||this.toStructure,isTypeInstance:e||this.isTypeInstance})},n}()),__read$6=(transformer.TypeTransformer=TypeTransformer,commonjsGlobal&&commonjsGlobal.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(o=i.next()).done;)a.push(o.value)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a}),neo4j_driver_core_1$v=(Object.defineProperty(boltProtocolV1_transformer,"__esModule",{value:!0}),lib$1),packstream_1$5=packstream,transformer_1$h=transformer,PROTOCOL_ERROR$2=neo4j_driver_core_1$v.error.PROTOCOL_ERROR,NODE=78,NODE_STRUCT_SIZE$1=3,RELATIONSHIP=82,RELATIONSHIP_STRUCT_SIZE$1=5,UNBOUND_RELATIONSHIP=114,UNBOUND_RELATIONSHIP_STRUCT_SIZE$1=3,PATH=80,PATH_STRUCT_SIZE=3;function createNodeTransformer$1(){return new transformer_1$h.TypeTransformer({signature:NODE,isTypeInstance:function(e){return e instanceof neo4j_driver_core_1$v.Node},toStructure:function(e){throw(0,neo4j_driver_core_1$v.newError)("It is not allowed to pass nodes in query parameters, given: ".concat(e),PROTOCOL_ERROR$2)},fromStructure:function(e){packstream_1$5.structure.verifyStructSize("Node",NODE_STRUCT_SIZE$1,e.size);var e=__read$6(e.fields,3),t=e[0],r=e[1],e=e[2];return new neo4j_driver_core_1$v.Node(t,r,e)}})}function createRelationshipTransformer$1(){return new transformer_1$h.TypeTransformer({signature:RELATIONSHIP,isTypeInstance:function(e){return e instanceof neo4j_driver_core_1$v.Relationship},toStructure:function(e){throw(0,neo4j_driver_core_1$v.newError)("It is not allowed to pass relationships in query parameters, given: ".concat(e),PROTOCOL_ERROR$2)},fromStructure:function(e){packstream_1$5.structure.verifyStructSize("Relationship",RELATIONSHIP_STRUCT_SIZE$1,e.size);var e=__read$6(e.fields,5),t=e[0],r=e[1],o=e[2],n=e[3],e=e[4];return new neo4j_driver_core_1$v.Relationship(t,r,o,n,e)}})}function createUnboundRelationshipTransformer$1(){return new transformer_1$h.TypeTransformer({signature:UNBOUND_RELATIONSHIP,isTypeInstance:function(e){return e instanceof neo4j_driver_core_1$v.UnboundRelationship},toStructure:function(e){throw(0,neo4j_driver_core_1$v.newError)("It is not allowed to pass unbound relationships in query parameters, given: ".concat(e),PROTOCOL_ERROR$2)},fromStructure:function(e){packstream_1$5.structure.verifyStructSize("UnboundRelationship",UNBOUND_RELATIONSHIP_STRUCT_SIZE$1,e.size);var e=__read$6(e.fields,3),t=e[0],r=e[1],e=e[2];return new neo4j_driver_core_1$v.UnboundRelationship(t,r,e)}})}function createPathTransformer(){return new transformer_1$h.TypeTransformer({signature:PATH,isTypeInstance:function(e){return e instanceof neo4j_driver_core_1$v.Path},toStructure:function(e){throw(0,neo4j_driver_core_1$v.newError)("It is not allowed to pass paths in query parameters, given: ".concat(e),PROTOCOL_ERROR$2)},fromStructure:function(e){packstream_1$5.structure.verifyStructSize("Path",PATH_STRUCT_SIZE,e.size);for(var e=__read$6(e.fields,3),t=e[0],r=e[1],o=e[2],n=[],i=t[0],a=0;a<o.length;a+=2){var s=t[o[a+1]],u=(0,neo4j_driver_core_1$v.toNumber)(o[a]),c=void 0;0<u?(c=r[u-1])instanceof neo4j_driver_core_1$v.UnboundRelationship&&(r[u-1]=c=c.bindTo(i,s)):(c=r[-u-1])instanceof neo4j_driver_core_1$v.UnboundRelationship&&(r[-u-1]=c=c.bindTo(s,i)),n.push(new neo4j_driver_core_1$v.PathSegment(i,c,s)),i=s}return new neo4j_driver_core_1$v.Path(t[0],t[t.length-1],n)}})}boltProtocolV1_transformer.default={createNodeTransformer:createNodeTransformer$1,createRelationshipTransformer:createRelationshipTransformer$1,createUnboundRelationshipTransformer:createUnboundRelationshipTransformer$1,createPathTransformer:createPathTransformer};var __assign$o=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$o=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__createBinding$1=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&("get"in n?t.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){e[o=void 0===o?r:o]=t[r]}),__setModuleDefault$1=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar$1=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding$1(t,e,r);return __setModuleDefault$1(t,e),t},__importDefault$B=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},bolt_protocol_util_1$7=(Object.defineProperty(boltProtocolV1,"__esModule",{value:!0}),boltProtocolUtil),packstream_1$4=packstream,request_message_1$b=__importStar$1(requestMessage),stream_observers_1$b=streamObservers,neo4j_driver_core_1$u=lib$1,bolt_protocol_v1_transformer_1$1=__importDefault$B(boltProtocolV1_transformer),transformer_1$g=__importDefault$B(transformer),Bookmarks$3=neo4j_driver_core_1$u.internal.bookmarks.Bookmarks,_a$a=neo4j_driver_core_1$u.internal.constants,ACCESS_MODE_WRITE=_a$a.ACCESS_MODE_WRITE,BOLT_PROTOCOL_V1=_a$a.BOLT_PROTOCOL_V1,TxConfig$2=(neo4j_driver_core_1$u.internal.logger.Logger,neo4j_driver_core_1$u.internal.txConfig.TxConfig),DEFAULT_DIAGNOSTIC_RECORD$3=Object.freeze({OPERATION:"",OPERATION_CODE:"0",CURRENT_SCHEMA:"/"}),BoltProtocol$f=function(){function e(e,t,r,o,n,i){var r=void 0===r?{}:r,a=r.disableLosslessIntegers,r=r.useBigInt;void 0===o&&(o=function(){return null}),this._server=e||{},this._chunker=t,this._packer=this._createPacker(t),this._unpacker=this._createUnpacker(a,r),this._responseHandler=o(this),this._log=n,this._onProtocolError=i,this._fatalError=null,this._lastMessageSignature=null,this._config={disableLosslessIntegers:a,useBigInt:r}}return Object.defineProperty(e.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new transformer_1$g.default(Object.values(bolt_protocol_v1_transformer_1$1.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return BOLT_PROTOCOL_V1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"supportsReAuth",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"initialized",{get:function(){return!!this._initialized},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"authToken",{get:function(){return this._authToken},enumerable:!1,configurable:!0}),e.prototype.packer=function(){return this._packer},e.prototype.packable=function(e){return this._packer.packable(e,this.transformer.toStructure)},e.prototype.unpacker=function(){return this._unpacker},e.prototype.unpack=function(e){return this._unpacker.unpack(e,this.transformer.fromStructure)},e.prototype.transformMetadata=function(e){return e},e.prototype.enrichErrorMetadata=function(e){return __assign$o(__assign$o({},e),{diagnostic_record:null!==e.diagnostic_record?__assign$o(__assign$o({},DEFAULT_DIAGNOSTIC_RECORD$3),e.diagnostic_record):null})},e.prototype.initialize=function(e){var t=this,e=void 0===e?{}:e,r=e.userAgent,o=(e.boltAgent,e.authToken),n=e.notificationFilter,i=e.onError,a=e.onComplete,e=new stream_observers_1$b.LoginObserver({onError:function(e){return t._onLoginError(e,i)},onCompleted:function(e){return t._onLoginCompleted(e,a)}});return(0,bolt_protocol_util_1$7.assertNotificationFilterIsEmpty)(n,this._onProtocolError,e),this.write(request_message_1$b.default.init(r,o),e,!0),e},e.prototype.logoff=function(e){var e=void 0===e?{}:e,t=e.onComplete,r=e.onError,e=(e.flush,new stream_observers_1$b.LogoffObserver({onCompleted:t,onError:r})),t=(0,neo4j_driver_core_1$u.newError)("Driver is connected to a database that does not support logoff. Please upgrade to Neo4j 5.5.0 or later in order to use this functionality.");throw this._onProtocolError(t.message),e.onError(t),t},e.prototype.logon=function(e){var t=this,e=void 0===e?{}:e,r=e.authToken,o=e.onComplete,n=e.onError,e=(e.flush,new stream_observers_1$b.LoginObserver({onCompleted:function(){return t._onLoginCompleted({},r,o)},onError:function(e){return t._onLoginError(e,n)}})),i=(0,neo4j_driver_core_1$u.newError)("Driver is connected to a database that does not support logon. Please upgrade to Neo4j 5.5.0 or later in order to use this functionality.");throw this._onProtocolError(i.message),e.onError(i),i},e.prototype.prepareToClose=function(){},e.prototype.beginTransaction=function(e){var e=void 0===e?{}:e,t=e.bookmarks,r=e.txConfig,o=e.database,n=e.mode,i=e.impersonatedUser,a=e.notificationFilter,s=e.beforeError,u=e.afterError,c=e.beforeComplete,e=e.afterComplete;return this.run("BEGIN",t?t.asBeginTransactionParameters():{},{bookmarks:t,txConfig:r,database:o,mode:n,impersonatedUser:i,notificationFilter:a,beforeError:s,afterError:u,beforeComplete:c,afterComplete:e,flush:!1})},e.prototype.commitTransaction=function(e){var e=void 0===e?{}:e,t=e.beforeError,r=e.afterError,o=e.beforeComplete,e=e.afterComplete;return this.run("COMMIT",{},{bookmarks:Bookmarks$3.empty(),txConfig:TxConfig$2.empty(),mode:ACCESS_MODE_WRITE,beforeError:t,afterError:r,beforeComplete:o,afterComplete:e})},e.prototype.rollbackTransaction=function(e){var e=void 0===e?{}:e,t=e.beforeError,r=e.afterError,o=e.beforeComplete,e=e.afterComplete;return this.run("ROLLBACK",{},{bookmarks:Bookmarks$3.empty(),txConfig:TxConfig$2.empty(),mode:ACCESS_MODE_WRITE,beforeError:t,afterError:r,beforeComplete:o,afterComplete:e})},e.prototype.run=function(e,t,r){var r=void 0===r?{}:r,o=(r.bookmarks,r.txConfig),n=r.database,i=(r.mode,r.impersonatedUser),a=r.notificationFilter,s=r.beforeKeys,u=r.afterKeys,c=r.beforeError,l=r.afterError,_=r.beforeComplete,f=r.afterComplete,d=r.flush,d=void 0===d||d,p=r.highRecordWatermark,p=void 0===p?Number.MAX_VALUE:p,r=r.lowRecordWatermark,r=void 0===r?Number.MAX_VALUE:r,s=new stream_observers_1$b.ResultStreamObserver({server:this._server,beforeKeys:s,afterKeys:u,beforeError:c,afterError:l,beforeComplete:_,afterComplete:f,highRecordWatermark:p,lowRecordWatermark:r});return(0,bolt_protocol_util_1$7.assertTxConfigIsEmpty)(o,this._onProtocolError,s),(0,bolt_protocol_util_1$7.assertDatabaseIsEmpty)(n,this._onProtocolError,s),(0,bolt_protocol_util_1$7.assertImpersonatedUserIsEmpty)(i,this._onProtocolError,s),(0,bolt_protocol_util_1$7.assertNotificationFilterIsEmpty)(a,this._onProtocolError,s),this.write(request_message_1$b.default.run(e,t),s,!1),this.write(request_message_1$b.default.pullAll(),s,d),s},Object.defineProperty(e.prototype,"currentFailure",{get:function(){return this._responseHandler.currentFailure},enumerable:!1,configurable:!0}),e.prototype.reset=function(e){var e=void 0===e?{}:e,t=e.onError,e=e.onComplete,t=new stream_observers_1$b.ResetObserver({onProtocolError:this._onProtocolError,onError:t,onComplete:e});return this.write(request_message_1$b.default.reset(),t,!0),t},e.prototype.telemetry=function(e,t){e.api;e=void 0===t?{}:t,e.onError,t=e.onCompleted,e=new stream_observers_1$b.CompletedObserver;return t&&t(),e},e.prototype._createPacker=function(e){return new packstream_1$4.v1.Packer(e)},e.prototype._createUnpacker=function(e,t){return new packstream_1$4.v1.Unpacker(e,t)},e.prototype.write=function(e,t,r){this.queueObserverIfProtocolIsNotBroken(t)&&(this._log.isDebugEnabled()&&this._log.debug("C: ".concat(e)),this._lastMessageSignature=e.signature,t=new packstream_1$4.structure.Structure(e.signature,e.fields),this.packable(t)(),this._chunker.messageBoundary(),r)&&this._chunker.flush()},e.prototype.isLastMessageLogon=function(){return this._lastMessageSignature===request_message_1$b.SIGNATURES.HELLO||this._lastMessageSignature===request_message_1$b.SIGNATURES.LOGON},e.prototype.isLastMessageReset=function(){return this._lastMessageSignature===request_message_1$b.SIGNATURES.RESET},e.prototype.notifyFatalError=function(e){return this._fatalError=e,this._responseHandler._notifyErrorToObservers(e)},e.prototype.updateCurrentObserver=function(){return this._responseHandler._updateCurrentObserver()},e.prototype.hasOngoingObservableRequests=function(){return this._responseHandler.hasOngoingObservableRequests()},e.prototype.queueObserverIfProtocolIsNotBroken=function(e){return this.isBroken()?(this.notifyFatalErrorToObserver(e),!1):this._responseHandler._queueObserver(e)},e.prototype.isBroken=function(){return!!this._fatalError},e.prototype.notifyFatalErrorToObserver=function(e){e&&e.onError&&e.onError(this._fatalError)},e.prototype.resetFailure=function(){this._responseHandler._resetFailure()},e.prototype._onLoginCompleted=function(e,t,r){this._initialized=!0,this._authToken=t,e&&(t=e.server,this._server.version||(this._server.version=t)),r&&r(e)},e.prototype._onLoginError=function(e,t){this._onProtocolError(e.message),t&&t(e)},e}(),boltProtocolV2=(boltProtocolV1.default=BoltProtocol$f,{}),boltProtocolV2_transformer={},temporalFactory={},neo4j_driver_core_1$t=(Object.defineProperty(temporalFactory,"__esModule",{value:!0}),temporalFactory.epochSecondAndNanoToLocalDateTime=temporalFactory.nanoOfDayToLocalTime=temporalFactory.epochDayToDate=void 0,lib$1),_a$9=neo4j_driver_core_1$t.internal.temporalUtil,DAYS_0000_TO_1970=_a$9.DAYS_0000_TO_1970,DAYS_PER_400_YEAR_CYCLE=_a$9.DAYS_PER_400_YEAR_CYCLE,NANOS_PER_HOUR=_a$9.NANOS_PER_HOUR,NANOS_PER_MINUTE=_a$9.NANOS_PER_MINUTE,NANOS_PER_SECOND=_a$9.NANOS_PER_SECOND,SECONDS_PER_DAY=_a$9.SECONDS_PER_DAY,floorDiv=_a$9.floorDiv,floorMod=_a$9.floorMod;function epochDayToDate(e){var e=(e=(0,neo4j_driver_core_1$t.int)(e)).add(DAYS_0000_TO_1970).subtract(60),t=(0,neo4j_driver_core_1$t.int)(0),r=(e.lessThan(0)&&(t=(r=e.add(1).div(DAYS_PER_400_YEAR_CYCLE).subtract(1)).multiply(400),e=e.add(r.multiply(-DAYS_PER_400_YEAR_CYCLE))),e.multiply(400).add(591).div(DAYS_PER_400_YEAR_CYCLE)),o=e.subtract(r.multiply(365).add(r.div(4)).subtract(r.div(100)).add(r.div(400))),e=(o.lessThan(0)&&(r=r.subtract(1),o=e.subtract(r.multiply(365).add(r.div(4)).subtract(r.div(100)).add(r.div(400)))),r=r.add(t),o),t=e.multiply(5).add(2).div(153),o=t.add(2).modulo(12).add(1),e=e.subtract(t.multiply(306).add(5).div(10)).add(1),r=r.add(t.div(10));return new neo4j_driver_core_1$t.Date(r,o,e)}function nanoOfDayToLocalTime(e){var t=(e=(0,neo4j_driver_core_1$t.int)(e)).div(NANOS_PER_HOUR),r=(e=e.subtract(t.multiply(NANOS_PER_HOUR))).div(NANOS_PER_MINUTE),o=(e=e.subtract(r.multiply(NANOS_PER_MINUTE))).div(NANOS_PER_SECOND),e=e.subtract(o.multiply(NANOS_PER_SECOND));return new neo4j_driver_core_1$t.LocalTime(t,r,o,e)}function epochSecondAndNanoToLocalDateTime(e,t){var r=floorDiv(e,SECONDS_PER_DAY),e=floorMod(e,SECONDS_PER_DAY).multiply(NANOS_PER_SECOND).add(t),t=epochDayToDate(r),r=nanoOfDayToLocalTime(e);return new neo4j_driver_core_1$t.LocalDateTime(t.year,t.month,t.day,r.hour,r.minute,r.second,r.nanosecond)}temporalFactory.epochDayToDate=epochDayToDate,temporalFactory.nanoOfDayToLocalTime=nanoOfDayToLocalTime,temporalFactory.epochSecondAndNanoToLocalDateTime=epochSecondAndNanoToLocalDateTime;var __assign$n=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$n=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__read$5=commonjsGlobal&&commonjsGlobal.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(o=i.next()).done;)a.push(o.value)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},__importDefault$A=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},neo4j_driver_core_1$s=(Object.defineProperty(boltProtocolV2_transformer,"__esModule",{value:!0}),lib$1),packstream_1$3=packstream,transformer_1$f=transformer,temporal_factory_1$1=temporalFactory,bolt_protocol_v1_transformer_1=__importDefault$A(boltProtocolV1_transformer),_a$8=neo4j_driver_core_1$s.internal.temporalUtil,dateToEpochDay=_a$8.dateToEpochDay,localDateTimeToEpochSecond$1=_a$8.localDateTimeToEpochSecond,localTimeToNanoOfDay=_a$8.localTimeToNanoOfDay,POINT_2D=88,POINT_2D_STRUCT_SIZE=3,POINT_3D=89,POINT_3D_STRUCT_SIZE=4,DURATION=69,DURATION_STRUCT_SIZE=4,LOCAL_TIME=116,LOCAL_TIME_STRUCT_SIZE=1,TIME=84,TIME_STRUCT_SIZE=2,DATE=68,DATE_STRUCT_SIZE=1,LOCAL_DATE_TIME=100,LOCAL_DATE_TIME_STRUCT_SIZE=2,DATE_TIME_WITH_ZONE_OFFSET$1=70,DATE_TIME_WITH_ZONE_OFFSET_STRUCT_SIZE$1=3,DATE_TIME_WITH_ZONE_ID$1=102,DATE_TIME_WITH_ZONE_ID_STRUCT_SIZE$1=3;function createPoint2DTransformer(){return new transformer_1$f.TypeTransformer({signature:POINT_2D,isTypeInstance:function(e){return(0,neo4j_driver_core_1$s.isPoint)(e)&&(null===e.z||void 0===e.z)},toStructure:function(e){return new packstream_1$3.structure.Structure(POINT_2D,[(0,neo4j_driver_core_1$s.int)(e.srid),e.x,e.y])},fromStructure:function(e){packstream_1$3.structure.verifyStructSize("Point2D",POINT_2D_STRUCT_SIZE,e.size);var e=__read$5(e.fields,3),t=e[0],r=e[1],e=e[2];return new neo4j_driver_core_1$s.Point(t,r,e,void 0)}})}function createPoint3DTransformer(){return new transformer_1$f.TypeTransformer({signature:POINT_3D,isTypeInstance:function(e){return(0,neo4j_driver_core_1$s.isPoint)(e)&&null!==e.z&&void 0!==e.z},toStructure:function(e){return new packstream_1$3.structure.Structure(POINT_3D,[(0,neo4j_driver_core_1$s.int)(e.srid),e.x,e.y,e.z])},fromStructure:function(e){packstream_1$3.structure.verifyStructSize("Point3D",POINT_3D_STRUCT_SIZE,e.size);var e=__read$5(e.fields,4),t=e[0],r=e[1],o=e[2],e=e[3];return new neo4j_driver_core_1$s.Point(t,r,o,e)}})}function createDurationTransformer(){return new transformer_1$f.TypeTransformer({signature:DURATION,isTypeInstance:neo4j_driver_core_1$s.isDuration,toStructure:function(e){var t=(0,neo4j_driver_core_1$s.int)(e.months),r=(0,neo4j_driver_core_1$s.int)(e.days),o=(0,neo4j_driver_core_1$s.int)(e.seconds),e=(0,neo4j_driver_core_1$s.int)(e.nanoseconds);return new packstream_1$3.structure.Structure(DURATION,[t,r,o,e])},fromStructure:function(e){packstream_1$3.structure.verifyStructSize("Duration",DURATION_STRUCT_SIZE,e.size);var e=__read$5(e.fields,4),t=e[0],r=e[1],o=e[2],e=e[3];return new neo4j_driver_core_1$s.Duration(t,r,o,e)}})}function createLocalTimeTransformer(e){var t=e.disableLosslessIntegers,r=e.useBigInt;return new transformer_1$f.TypeTransformer({signature:LOCAL_TIME,isTypeInstance:neo4j_driver_core_1$s.isLocalTime,toStructure:function(e){e=localTimeToNanoOfDay(e.hour,e.minute,e.second,e.nanosecond);return new packstream_1$3.structure.Structure(LOCAL_TIME,[e])},fromStructure:function(e){packstream_1$3.structure.verifyStructSize("LocalTime",LOCAL_TIME_STRUCT_SIZE,e.size);e=__read$5(e.fields,1)[0];return convertIntegerPropsIfNeeded$1((0,temporal_factory_1$1.nanoOfDayToLocalTime)(e),t,r)}})}function createTimeTransformer(e){var r=e.disableLosslessIntegers,o=e.useBigInt;return new transformer_1$f.TypeTransformer({signature:TIME,isTypeInstance:neo4j_driver_core_1$s.isTime,toStructure:function(e){var t=localTimeToNanoOfDay(e.hour,e.minute,e.second,e.nanosecond),e=(0,neo4j_driver_core_1$s.int)(e.timeZoneOffsetSeconds);return new packstream_1$3.structure.Structure(TIME,[t,e])},fromStructure:function(e){packstream_1$3.structure.verifyStructSize("Time",TIME_STRUCT_SIZE,e.size);var e=__read$5(e.fields,2),t=e[0],e=e[1],t=(0,temporal_factory_1$1.nanoOfDayToLocalTime)(t);return convertIntegerPropsIfNeeded$1(new neo4j_driver_core_1$s.Time(t.hour,t.minute,t.second,t.nanosecond,e),r,o)}})}function createDateTransformer(e){var t=e.disableLosslessIntegers,r=e.useBigInt;return new transformer_1$f.TypeTransformer({signature:DATE,isTypeInstance:neo4j_driver_core_1$s.isDate,toStructure:function(e){e=dateToEpochDay(e.year,e.month,e.day);return new packstream_1$3.structure.Structure(DATE,[e])},fromStructure:function(e){packstream_1$3.structure.verifyStructSize("Date",DATE_STRUCT_SIZE,e.size);e=__read$5(e.fields,1)[0];return convertIntegerPropsIfNeeded$1((0,temporal_factory_1$1.epochDayToDate)(e),t,r)}})}function createLocalDateTimeTransformer(e){var r=e.disableLosslessIntegers,o=e.useBigInt;return new transformer_1$f.TypeTransformer({signature:LOCAL_DATE_TIME,isTypeInstance:neo4j_driver_core_1$s.isLocalDateTime,toStructure:function(e){var t=localDateTimeToEpochSecond$1(e.year,e.month,e.day,e.hour,e.minute,e.second,e.nanosecond),e=(0,neo4j_driver_core_1$s.int)(e.nanosecond);return new packstream_1$3.structure.Structure(LOCAL_DATE_TIME,[t,e])},fromStructure:function(e){packstream_1$3.structure.verifyStructSize("LocalDateTime",LOCAL_DATE_TIME_STRUCT_SIZE,e.size);var e=__read$5(e.fields,2),t=e[0],e=e[1];return convertIntegerPropsIfNeeded$1((0,temporal_factory_1$1.epochSecondAndNanoToLocalDateTime)(t,e),r,o)}})}function createDateTimeWithZoneIdTransformer$1(e){var o=e.disableLosslessIntegers,n=e.useBigInt;return new transformer_1$f.TypeTransformer({signature:DATE_TIME_WITH_ZONE_ID$1,isTypeInstance:function(e){return(0,neo4j_driver_core_1$s.isDateTime)(e)&&null!=e.timeZoneId},toStructure:function(e){var t=localDateTimeToEpochSecond$1(e.year,e.month,e.day,e.hour,e.minute,e.second,e.nanosecond),r=(0,neo4j_driver_core_1$s.int)(e.nanosecond),e=e.timeZoneId;return new packstream_1$3.structure.Structure(DATE_TIME_WITH_ZONE_ID$1,[t,r,e])},fromStructure:function(e){packstream_1$3.structure.verifyStructSize("DateTimeWithZoneId",DATE_TIME_WITH_ZONE_ID_STRUCT_SIZE$1,e.size);var e=__read$5(e.fields,3),t=e[0],r=e[1],e=e[2],t=(0,temporal_factory_1$1.epochSecondAndNanoToLocalDateTime)(t,r);return convertIntegerPropsIfNeeded$1(new neo4j_driver_core_1$s.DateTime(t.year,t.month,t.day,t.hour,t.minute,t.second,t.nanosecond,null,e),o,n)}})}function createDateTimeWithOffsetTransformer$1(e){var o=e.disableLosslessIntegers,n=e.useBigInt;return new transformer_1$f.TypeTransformer({signature:DATE_TIME_WITH_ZONE_OFFSET$1,isTypeInstance:function(e){return(0,neo4j_driver_core_1$s.isDateTime)(e)&&null==e.timeZoneId},toStructure:function(e){var t=localDateTimeToEpochSecond$1(e.year,e.month,e.day,e.hour,e.minute,e.second,e.nanosecond),r=(0,neo4j_driver_core_1$s.int)(e.nanosecond),e=(0,neo4j_driver_core_1$s.int)(e.timeZoneOffsetSeconds);return new packstream_1$3.structure.Structure(DATE_TIME_WITH_ZONE_OFFSET$1,[t,r,e])},fromStructure:function(e){packstream_1$3.structure.verifyStructSize("DateTimeWithZoneOffset",DATE_TIME_WITH_ZONE_OFFSET_STRUCT_SIZE$1,e.size);var e=__read$5(e.fields,3),t=e[0],r=e[1],e=e[2],t=(0,temporal_factory_1$1.epochSecondAndNanoToLocalDateTime)(t,r);return convertIntegerPropsIfNeeded$1(new neo4j_driver_core_1$s.DateTime(t.year,t.month,t.day,t.hour,t.minute,t.second,t.nanosecond,e,null),o,n)}})}function convertIntegerPropsIfNeeded$1(e,t,r){if(!t&&!r)return e;var o,n,i,a=Object.create(Object.getPrototypeOf(e));for(o in e)!0===Object.prototype.hasOwnProperty.call(e,o)&&(n=e[o],a[o]=(0,neo4j_driver_core_1$s.isInt)(n)?(i=n,r?i.toBigInt():i.toNumberOrInfinity()):n);return Object.freeze(a),a}boltProtocolV2_transformer.default=__assign$n(__assign$n({},bolt_protocol_v1_transformer_1.default),{createPoint2DTransformer:createPoint2DTransformer,createPoint3DTransformer:createPoint3DTransformer,createDurationTransformer:createDurationTransformer,createLocalTimeTransformer:createLocalTimeTransformer,createTimeTransformer:createTimeTransformer,createDateTransformer:createDateTransformer,createLocalDateTimeTransformer:createLocalDateTimeTransformer,createDateTimeWithZoneIdTransformer:createDateTimeWithZoneIdTransformer$1,createDateTimeWithOffsetTransformer:createDateTimeWithOffsetTransformer$1});var __extends$l=commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),__importDefault$z=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},bolt_protocol_v1_1$1=(Object.defineProperty(boltProtocolV2,"__esModule",{value:!0}),__importDefault$z(boltProtocolV1)),packstream_1$2=__importDefault$z(packstream),neo4j_driver_core_1$r=lib$1,bolt_protocol_v2_transformer_1$1=__importDefault$z(boltProtocolV2_transformer),transformer_1$e=__importDefault$z(transformer),BOLT_PROTOCOL_V2=neo4j_driver_core_1$r.internal.constants.BOLT_PROTOCOL_V2,BoltProtocol$e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends$l(t,e),t.prototype._createPacker=function(e){return new packstream_1$2.default.Packer(e)},t.prototype._createUnpacker=function(e,t){return new packstream_1$2.default.Unpacker(e,t)},Object.defineProperty(t.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new transformer_1$e.default(Object.values(bolt_protocol_v2_transformer_1$1.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"version",{get:function(){return BOLT_PROTOCOL_V2},enumerable:!1,configurable:!0}),t}(bolt_protocol_v1_1$1.default),boltProtocolV3=(boltProtocolV2.default=BoltProtocol$e,{}),boltProtocolV3_transformer={},__assign$m=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$m=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__importDefault$y=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},bolt_protocol_v2_transformer_1=(Object.defineProperty(boltProtocolV3_transformer,"__esModule",{value:!0}),__importDefault$y(boltProtocolV2_transformer)),__extends$k=(boltProtocolV3_transformer.default=__assign$m({},bolt_protocol_v2_transformer_1.default),commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}()),__assign$l=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$l=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__importDefault$x=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},bolt_protocol_v2_1$1=(Object.defineProperty(boltProtocolV3,"__esModule",{value:!0}),__importDefault$x(boltProtocolV2)),request_message_1$a=__importDefault$x(requestMessage),bolt_protocol_util_1$6=boltProtocolUtil,stream_observers_1$a=streamObservers,bolt_protocol_v3_transformer_1$1=__importDefault$x(boltProtocolV3_transformer),transformer_1$d=__importDefault$x(transformer),neo4j_driver_core_1$q=lib$1,BOLT_PROTOCOL_V3$2=(neo4j_driver_core_1$q.internal.bookmarks.Bookmarks,neo4j_driver_core_1$q.internal.constants.BOLT_PROTOCOL_V3),TxConfig$1=neo4j_driver_core_1$q.internal.txConfig.TxConfig,CONTEXT$1="context",CALL_GET_ROUTING_TABLE="CALL dbms.cluster.routing.getRoutingTable($".concat(CONTEXT$1,")"),noOpObserver=new stream_observers_1$a.StreamObserver,BoltProtocol$d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends$k(t,e),Object.defineProperty(t.prototype,"version",{get:function(){return BOLT_PROTOCOL_V3$2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new transformer_1$d.default(Object.values(bolt_protocol_v3_transformer_1$1.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),t.prototype.transformMetadata=function(e){return"t_first"in e&&(e.result_available_after=e.t_first,delete e.t_first),"t_last"in e&&(e.result_consumed_after=e.t_last,delete e.t_last),e},t.prototype.initialize=function(e){var t=this,e=void 0===e?{}:e,r=e.userAgent,o=(e.boltAgent,e.authToken),n=e.notificationFilter,i=e.onError,a=e.onComplete,e=new stream_observers_1$a.LoginObserver({onError:function(e){return t._onLoginError(e,i)},onCompleted:function(e){return t._onLoginCompleted(e,o,a)}});return(0,bolt_protocol_util_1$6.assertNotificationFilterIsEmpty)(n,this._onProtocolError,e),this.write(request_message_1$a.default.hello(r,o),e,!0),e},t.prototype.prepareToClose=function(){this.write(request_message_1$a.default.goodbye(),noOpObserver,!0)},t.prototype.beginTransaction=function(e){var e=void 0===e?{}:e,t=e.bookmarks,r=e.txConfig,o=e.database,n=e.impersonatedUser,i=e.notificationFilter,a=e.mode,s=e.beforeError,u=e.afterError,c=e.beforeComplete,e=e.afterComplete,s=new stream_observers_1$a.ResultStreamObserver({server:this._server,beforeError:s,afterError:u,beforeComplete:c,afterComplete:e});return s.prepareToHandleSingleResponse(),(0,bolt_protocol_util_1$6.assertDatabaseIsEmpty)(o,this._onProtocolError,s),(0,bolt_protocol_util_1$6.assertImpersonatedUserIsEmpty)(n,this._onProtocolError,s),(0,bolt_protocol_util_1$6.assertNotificationFilterIsEmpty)(i,this._onProtocolError,s),this.write(request_message_1$a.default.begin({bookmarks:t,txConfig:r,mode:a}),s,!0),s},t.prototype.commitTransaction=function(e){var e=void 0===e?{}:e,t=e.beforeError,r=e.afterError,o=e.beforeComplete,e=e.afterComplete,t=new stream_observers_1$a.ResultStreamObserver({server:this._server,beforeError:t,afterError:r,beforeComplete:o,afterComplete:e});return t.prepareToHandleSingleResponse(),this.write(request_message_1$a.default.commit(),t,!0),t},t.prototype.rollbackTransaction=function(e){var e=void 0===e?{}:e,t=e.beforeError,r=e.afterError,o=e.beforeComplete,e=e.afterComplete,t=new stream_observers_1$a.ResultStreamObserver({server:this._server,beforeError:t,afterError:r,beforeComplete:o,afterComplete:e});return t.prepareToHandleSingleResponse(),this.write(request_message_1$a.default.rollback(),t,!0),t},t.prototype.run=function(e,t,r){var r=void 0===r?{}:r,o=r.bookmarks,n=r.txConfig,i=r.database,a=r.impersonatedUser,s=r.notificationFilter,u=r.mode,c=r.beforeKeys,l=r.afterKeys,_=r.beforeError,f=r.afterError,d=r.beforeComplete,p=r.afterComplete,h=r.flush,h=void 0===h||h,m=r.highRecordWatermark,m=void 0===m?Number.MAX_VALUE:m,r=r.lowRecordWatermark,r=void 0===r?Number.MAX_VALUE:r,c=new stream_observers_1$a.ResultStreamObserver({server:this._server,beforeKeys:c,afterKeys:l,beforeError:_,afterError:f,beforeComplete:d,afterComplete:p,highRecordWatermark:m,lowRecordWatermark:r});return(0,bolt_protocol_util_1$6.assertDatabaseIsEmpty)(i,this._onProtocolError,c),(0,bolt_protocol_util_1$6.assertImpersonatedUserIsEmpty)(a,this._onProtocolError,c),(0,bolt_protocol_util_1$6.assertNotificationFilterIsEmpty)(s,this._onProtocolError,c),this.write(request_message_1$a.default.runWithMetadata(e,t,{bookmarks:o,txConfig:n,mode:u}),c,!1),this.write(request_message_1$a.default.pullAll(),c,h),c},t.prototype.requestRoutingInformation=function(e){var t,r=e.routingContext,o=e.sessionContext,o=void 0===o?{}:o,n=e.onError,e=e.onCompleted,r=this.run(CALL_GET_ROUTING_TABLE,((t={})[CONTEXT$1]=void 0===r?{}:r,t),__assign$l(__assign$l({},o),{txConfig:TxConfig$1.empty()}));return new stream_observers_1$a.ProcedureRouteObserver({resultObserver:r,onProtocolError:this._onProtocolError,onError:n,onCompleted:e})},t}(bolt_protocol_v2_1$1.default),boltProtocolV4x0=(boltProtocolV3.default=BoltProtocol$d,{}),boltProtocolV4x0_transformer={},__assign$k=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$k=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__importDefault$w=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},bolt_protocol_v3_transformer_1=(Object.defineProperty(boltProtocolV4x0_transformer,"__esModule",{value:!0}),__importDefault$w(boltProtocolV3_transformer)),__extends$j=(boltProtocolV4x0_transformer.default=__assign$k({},bolt_protocol_v3_transformer_1.default),commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}()),__assign$j=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$j=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__importDefault$v=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},bolt_protocol_v3_1$1=(Object.defineProperty(boltProtocolV4x0,"__esModule",{value:!0}),__importDefault$v(boltProtocolV3)),request_message_1$9=__importDefault$v(requestMessage),bolt_protocol_util_1$5=boltProtocolUtil,stream_observers_1$9=streamObservers,bolt_protocol_v4x0_transformer_1$1=__importDefault$v(boltProtocolV4x0_transformer),transformer_1$c=__importDefault$v(transformer),neo4j_driver_core_1$p=lib$1,_a$7=(neo4j_driver_core_1$p.internal.bookmarks.Bookmarks,neo4j_driver_core_1$p.internal.constants),BOLT_PROTOCOL_V4_0$2=_a$7.BOLT_PROTOCOL_V4_0,FETCH_ALL$3=_a$7.FETCH_ALL,TxConfig=neo4j_driver_core_1$p.internal.txConfig.TxConfig,CONTEXT="context",DATABASE="database",CALL_GET_ROUTING_TABLE_MULTI_DB="CALL dbms.routing.getRoutingTable($".concat(CONTEXT,", $").concat(DATABASE,")"),BoltProtocol$c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends$j(t,e),Object.defineProperty(t.prototype,"version",{get:function(){return BOLT_PROTOCOL_V4_0$2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new transformer_1$c.default(Object.values(bolt_protocol_v4x0_transformer_1$1.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),t.prototype.beginTransaction=function(e){var e=void 0===e?{}:e,t=e.bookmarks,r=e.txConfig,o=e.database,n=e.impersonatedUser,i=e.notificationFilter,a=e.mode,s=e.beforeError,u=e.afterError,c=e.beforeComplete,e=e.afterComplete,s=new stream_observers_1$9.ResultStreamObserver({server:this._server,beforeError:s,afterError:u,beforeComplete:c,afterComplete:e});return s.prepareToHandleSingleResponse(),(0,bolt_protocol_util_1$5.assertImpersonatedUserIsEmpty)(n,this._onProtocolError,s),(0,bolt_protocol_util_1$5.assertNotificationFilterIsEmpty)(i,this._onProtocolError,s),this.write(request_message_1$9.default.begin({bookmarks:t,txConfig:r,database:o,mode:a}),s,!0),s},t.prototype.run=function(e,t,r){var r=void 0===r?{}:r,o=r.bookmarks,n=r.txConfig,i=r.database,a=r.impersonatedUser,s=r.notificationFilter,u=r.mode,c=r.beforeKeys,l=r.afterKeys,_=r.beforeError,f=r.afterError,d=r.beforeComplete,p=r.afterComplete,h=r.flush,h=void 0===h||h,m=r.reactive,m=void 0!==m&&m,b=r.fetchSize,b=void 0===b?FETCH_ALL$3:b,g=r.highRecordWatermark,g=void 0===g?Number.MAX_VALUE:g,r=r.lowRecordWatermark,r=void 0===r?Number.MAX_VALUE:r,c=new stream_observers_1$9.ResultStreamObserver({server:this._server,reactive:m,fetchSize:b,moreFunction:this._requestMore.bind(this),discardFunction:this._requestDiscard.bind(this),beforeKeys:c,afterKeys:l,beforeError:_,afterError:f,beforeComplete:d,afterComplete:p,highRecordWatermark:g,lowRecordWatermark:r}),l=((0,bolt_protocol_util_1$5.assertImpersonatedUserIsEmpty)(a,this._onProtocolError,c),(0,bolt_protocol_util_1$5.assertNotificationFilterIsEmpty)(s,this._onProtocolError,c),m);return this.write(request_message_1$9.default.runWithMetadata(e,t,{bookmarks:o,txConfig:n,database:i,mode:u}),c,l&&h),m||this.write(request_message_1$9.default.pull({n:b}),c,h),c},t.prototype._requestMore=function(e,t,r){this.write(request_message_1$9.default.pull({stmtId:e,n:t}),r,!0)},t.prototype._requestDiscard=function(e,t){this.write(request_message_1$9.default.discard({stmtId:e}),t,!0)},t.prototype._noOp=function(){},t.prototype.requestRoutingInformation=function(e){var t,r=e.routingContext,o=e.databaseName,o=void 0===o?null:o,n=e.sessionContext,n=void 0===n?{}:n,i=e.onError,e=e.onCompleted,r=this.run(CALL_GET_ROUTING_TABLE_MULTI_DB,((t={})[CONTEXT]=void 0===r?{}:r,t[DATABASE]=o,t),__assign$j(__assign$j({},n),{txConfig:TxConfig.empty()}));return new stream_observers_1$9.ProcedureRouteObserver({resultObserver:r,onProtocolError:this._onProtocolError,onError:i,onCompleted:e})},t}(bolt_protocol_v3_1$1.default),boltProtocolV4x1=(boltProtocolV4x0.default=BoltProtocol$c,{}),boltProtocolV4x1_transformer={},__assign$i=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$i=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__importDefault$u=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},bolt_protocol_v4x0_transformer_1=(Object.defineProperty(boltProtocolV4x1_transformer,"__esModule",{value:!0}),__importDefault$u(boltProtocolV4x0_transformer)),__extends$i=(boltProtocolV4x1_transformer.default=__assign$i({},bolt_protocol_v4x0_transformer_1.default),commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}()),__importDefault$t=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},bolt_protocol_v4x0_1$1=(Object.defineProperty(boltProtocolV4x1,"__esModule",{value:!0}),__importDefault$t(boltProtocolV4x0)),request_message_1$8=__importDefault$t(requestMessage),stream_observers_1$8=streamObservers,neo4j_driver_core_1$o=lib$1,bolt_protocol_util_1$4=boltProtocolUtil,bolt_protocol_v4x1_transformer_1$1=__importDefault$t(boltProtocolV4x1_transformer),transformer_1$b=__importDefault$t(transformer),BOLT_PROTOCOL_V4_1=neo4j_driver_core_1$o.internal.constants.BOLT_PROTOCOL_V4_1,BoltProtocol$b=function(s){function e(e,t,r,o,n,i,a){e=s.call(this,e,t,r,o=void 0===o?function(){return null}:o,n,i)||this;return e._serversideRouting=a,e}return __extends$i(e,s),Object.defineProperty(e.prototype,"version",{get:function(){return BOLT_PROTOCOL_V4_1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new transformer_1$b.default(Object.values(bolt_protocol_v4x1_transformer_1$1.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),e.prototype.initialize=function(e){var t=this,e=void 0===e?{}:e,r=e.userAgent,o=(e.boltAgent,e.authToken),n=e.notificationFilter,i=e.onError,a=e.onComplete,e=new stream_observers_1$8.LoginObserver({onError:function(e){return t._onLoginError(e,i)},onCompleted:function(e){return t._onLoginCompleted(e,o,a)}});return(0,bolt_protocol_util_1$4.assertNotificationFilterIsEmpty)(n,this._onProtocolError,e),this.write(request_message_1$8.default.hello(r,o,this._serversideRouting),e,!0),e},e}(bolt_protocol_v4x0_1$1.default),boltProtocolV4x2=(boltProtocolV4x1.default=BoltProtocol$b,{}),boltProtocolV4x2_transformer={},__assign$h=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$h=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__importDefault$s=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},bolt_protocol_v4x1_transformer_1=(Object.defineProperty(boltProtocolV4x2_transformer,"__esModule",{value:!0}),__importDefault$s(boltProtocolV4x1_transformer)),__extends$h=(boltProtocolV4x2_transformer.default=__assign$h({},bolt_protocol_v4x1_transformer_1.default),commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}()),__importDefault$r=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},bolt_protocol_v4x1_1$1=(Object.defineProperty(boltProtocolV4x2,"__esModule",{value:!0}),__importDefault$r(boltProtocolV4x1)),neo4j_driver_core_1$n=lib$1,bolt_protocol_v4x2_transformer_1$1=__importDefault$r(boltProtocolV4x2_transformer),transformer_1$a=__importDefault$r(transformer),BOLT_PROTOCOL_V4_2=neo4j_driver_core_1$n.internal.constants.BOLT_PROTOCOL_V4_2,BoltProtocol$a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends$h(t,e),Object.defineProperty(t.prototype,"version",{get:function(){return BOLT_PROTOCOL_V4_2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new transformer_1$a.default(Object.values(bolt_protocol_v4x2_transformer_1$1.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),t}(bolt_protocol_v4x1_1$1.default),boltProtocolV4x3=(boltProtocolV4x2.default=BoltProtocol$a,{}),boltProtocolV4x3_transformer={},__assign$g=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$g=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__importDefault$q=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},bolt_protocol_v4x2_transformer_1=(Object.defineProperty(boltProtocolV4x3_transformer,"__esModule",{value:!0}),__importDefault$q(boltProtocolV4x2_transformer)),boltProtocolV5x0_utc_transformer=(boltProtocolV4x3_transformer.default=__assign$g({},bolt_protocol_v4x2_transformer_1.default),{}),boltProtocolV4x4_transformer={},__assign$f=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$f=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__importDefault$p=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},bolt_protocol_v4x3_transformer_1$1=(Object.defineProperty(boltProtocolV4x4_transformer,"__esModule",{value:!0}),__importDefault$p(boltProtocolV4x3_transformer)),__read$4=(boltProtocolV4x4_transformer.default=__assign$f({},bolt_protocol_v4x3_transformer_1$1.default),commonjsGlobal&&commonjsGlobal.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(o=i.next()).done;)a.push(o.value)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a}),__importDefault$o=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},packstream_1$1=(Object.defineProperty(boltProtocolV5x0_utc_transformer,"__esModule",{value:!0}),packstream),neo4j_driver_core_1$m=lib$1,bolt_protocol_v4x4_transformer_1$2=__importDefault$o(boltProtocolV4x4_transformer),temporal_factory_1=temporalFactory,functional_1=functional,localDateTimeToEpochSecond=neo4j_driver_core_1$m.internal.temporalUtil.localDateTimeToEpochSecond,DATE_TIME_WITH_ZONE_OFFSET=73,DATE_TIME_WITH_ZONE_OFFSET_STRUCT_SIZE=3,DATE_TIME_WITH_ZONE_ID=105,DATE_TIME_WITH_ZONE_ID_STRUCT_SIZE=3;function createDateTimeWithZoneIdTransformer(e,o){var n=e.disableLosslessIntegers,i=e.useBigInt;return bolt_protocol_v4x4_transformer_1$2.default.createDateTimeWithZoneIdTransformer(e).extendsWith({signature:DATE_TIME_WITH_ZONE_ID,fromStructure:function(e){packstream_1$1.structure.verifyStructSize("DateTimeWithZoneId",DATE_TIME_WITH_ZONE_ID_STRUCT_SIZE,e.size);var e=__read$4(e.fields,3),t=e[0],r=e[1],e=e[2],t=getTimeInZoneId(e,t,r);return convertIntegerPropsIfNeeded(new neo4j_driver_core_1$m.DateTime(t.year,t.month,t.day,t.hour,t.minute,t.second,(0,neo4j_driver_core_1$m.int)(r),t.timeZoneOffsetSeconds,e),n,i)},toStructure:function(e){var t=localDateTimeToEpochSecond(e.year,e.month,e.day,e.hour,e.minute,e.second,e.nanosecond),r=null!=e.timeZoneOffsetSeconds?e.timeZoneOffsetSeconds:getOffsetFromZoneId(e.timeZoneId,t,e.nanosecond),t=(null==e.timeZoneOffsetSeconds&&o.warn('DateTime objects without "timeZoneOffsetSeconds" property are prune to bugs related to ambiguous times. For instance, 2022-10-30T2:30:00[Europe/Berlin] could be GMT+1 or GMT+2.'),t.subtract(r)),r=(0,neo4j_driver_core_1$m.int)(e.nanosecond),e=e.timeZoneId;return new packstream_1$1.structure.Structure(DATE_TIME_WITH_ZONE_ID,[t,r,e])}})}function getOffsetFromZoneId(e,t,r){var o=getTimeInZoneId(e,t,r),o=localDateTimeToEpochSecond(o.year,o.month,o.day,o.hour,o.minute,o.second,r).subtract(t),t=t.subtract(o),o=getTimeInZoneId(e,t,r);return localDateTimeToEpochSecond(o.year,o.month,o.day,o.hour,o.minute,o.second,r).subtract(t)}var dateTimeFormatCache=new Map;function getDateTimeFormatForZoneId(e){var t;return dateTimeFormatCache.has(e)||(t=new Intl.DateTimeFormat("en-US",{timeZone:e,year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!1,era:"narrow"}),dateTimeFormatCache.set(e,t)),dateTimeFormatCache.get(e)}function getTimeInZoneId(e,t,r){e=getDateTimeFormatForZoneId(e),r=(0,neo4j_driver_core_1$m.int)(t).multiply(1e3).add((0,neo4j_driver_core_1$m.int)(r).div(1e6)).toNumber(),e=e.formatToParts(r).reduce(function(e,t){return"era"===t.type?e.adjustEra="B"===t.value.toUpperCase()?function(e){return e.subtract(1).negate()}:functional_1.identity:"hour"===t.type?e.hour=(0,neo4j_driver_core_1$m.int)(t.value).modulo(24):"literal"!==t.type&&(e[t.type]=(0,neo4j_driver_core_1$m.int)(t.value)),e},{}),e.year=e.adjustEra(e.year),r=localDateTimeToEpochSecond(e.year,e.month,e.day,e.hour,e.minute,e.second,e.nanosecond);return e.timeZoneOffsetSeconds=r.subtract(t),e.hour=e.hour.modulo(24),e}function createDateTimeWithOffsetTransformer(e){var o=e.disableLosslessIntegers,n=e.useBigInt;return bolt_protocol_v4x4_transformer_1$2.default.createDateTimeWithOffsetTransformer(e).extendsWith({signature:DATE_TIME_WITH_ZONE_OFFSET,toStructure:function(e){var t=localDateTimeToEpochSecond(e.year,e.month,e.day,e.hour,e.minute,e.second,e.nanosecond),r=(0,neo4j_driver_core_1$m.int)(e.nanosecond),e=(0,neo4j_driver_core_1$m.int)(e.timeZoneOffsetSeconds),t=t.subtract(e);return new packstream_1$1.structure.Structure(DATE_TIME_WITH_ZONE_OFFSET,[t,r,e])},fromStructure:function(e){packstream_1$1.structure.verifyStructSize("DateTimeWithZoneOffset",DATE_TIME_WITH_ZONE_OFFSET_STRUCT_SIZE,e.size);var e=__read$4(e.fields,3),t=e[0],r=e[1],e=e[2],t=(0,neo4j_driver_core_1$m.int)(t).add(e),t=(0,temporal_factory_1.epochSecondAndNanoToLocalDateTime)(t,r);return convertIntegerPropsIfNeeded(new neo4j_driver_core_1$m.DateTime(t.year,t.month,t.day,t.hour,t.minute,t.second,t.nanosecond,e,null),o,n)}})}function convertIntegerPropsIfNeeded(e,t,r){if(!t&&!r)return e;var o,n,i,a=Object.create(Object.getPrototypeOf(e));for(o in e)!0===Object.prototype.hasOwnProperty.call(e,o)&&(n=e[o],a[o]=(0,neo4j_driver_core_1$m.isInt)(n)?(i=n,r?i.toBigInt():i.toNumberOrInfinity()):n);return Object.freeze(a),a}boltProtocolV5x0_utc_transformer.default={createDateTimeWithZoneIdTransformer:createDateTimeWithZoneIdTransformer,createDateTimeWithOffsetTransformer:createDateTimeWithOffsetTransformer};var __extends$g=commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),__assign$e=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$e=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__importDefault$n=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},bolt_protocol_v4x2_1$1=(Object.defineProperty(boltProtocolV4x3,"__esModule",{value:!0}),__importDefault$n(boltProtocolV4x2)),request_message_1$7=__importDefault$n(requestMessage),stream_observers_1$7=streamObservers,bolt_protocol_util_1$3=boltProtocolUtil,bolt_protocol_v4x3_transformer_1=__importDefault$n(boltProtocolV4x3_transformer),bolt_protocol_v5x0_utc_transformer_1$2=__importDefault$n(boltProtocolV5x0_utc_transformer),transformer_1$9=__importDefault$n(transformer),neo4j_driver_core_1$l=lib$1,Bookmarks$2=neo4j_driver_core_1$l.internal.bookmarks.Bookmarks,BOLT_PROTOCOL_V4_3=neo4j_driver_core_1$l.internal.constants.BOLT_PROTOCOL_V4_3,BoltProtocol$9=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends$g(t,e),Object.defineProperty(t.prototype,"version",{get:function(){return BOLT_PROTOCOL_V4_3},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new transformer_1$9.default(Object.values(bolt_protocol_v4x3_transformer_1.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),t.prototype.requestRoutingInformation=function(e){var t=e.routingContext,t=void 0===t?{}:t,r=e.databaseName,r=void 0===r?null:r,o=e.sessionContext,o=void 0===o?{}:o,n=e.onError,e=e.onCompleted,n=new stream_observers_1$7.RouteObserver({onProtocolError:this._onProtocolError,onError:n,onCompleted:e}),e=o.bookmarks||Bookmarks$2.empty();return this.write(request_message_1$7.default.route(t,e.values(),r),n,!0),n},t.prototype.initialize=function(e){var t=this,e=void 0===e?{}:e,r=e.userAgent,o=(e.boltAgent,e.authToken),n=e.notificationFilter,i=e.onError,a=e.onComplete,e=new stream_observers_1$7.LoginObserver({onError:function(e){return t._onLoginError(e,i)},onCompleted:function(e){return void 0!==e.patch_bolt&&t._applyPatches(e.patch_bolt),t._onLoginCompleted(e,o,a)}});return(0,bolt_protocol_util_1$3.assertNotificationFilterIsEmpty)(n,this._onProtocolError,e),this.write(request_message_1$7.default.hello(r,o,this._serversideRouting,["utc"]),e,!0),e},t.prototype._applyPatches=function(e){e.includes("utc")&&this._applyUtcPatch()},t.prototype._applyUtcPatch=function(){var t=this;this._transformer=new transformer_1$9.default(Object.values(__assign$e(__assign$e({},bolt_protocol_v4x3_transformer_1.default),bolt_protocol_v5x0_utc_transformer_1$2.default)).map(function(e){return e(t._config,t._log)}))},t}(bolt_protocol_v4x2_1$1.default),boltProtocolV4x4=(boltProtocolV4x3.default=BoltProtocol$9,{}),__extends$f=commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),__assign$d=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$d=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__importDefault$m=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},bolt_protocol_v4x3_1$1=(Object.defineProperty(boltProtocolV4x4,"__esModule",{value:!0}),__importDefault$m(boltProtocolV4x3)),neo4j_driver_core_1$k=lib$1,request_message_1$6=__importDefault$m(requestMessage),stream_observers_1$6=streamObservers,bolt_protocol_util_1$2=boltProtocolUtil,bolt_protocol_v4x4_transformer_1$1=__importDefault$m(boltProtocolV4x4_transformer),bolt_protocol_v5x0_utc_transformer_1$1=__importDefault$m(boltProtocolV5x0_utc_transformer),transformer_1$8=__importDefault$m(transformer),_a$6=neo4j_driver_core_1$k.internal.constants,BOLT_PROTOCOL_V4_4$2=_a$6.BOLT_PROTOCOL_V4_4,FETCH_ALL$2=_a$6.FETCH_ALL,Bookmarks$1=neo4j_driver_core_1$k.internal.bookmarks.Bookmarks,BoltProtocol$8=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends$f(t,e),Object.defineProperty(t.prototype,"version",{get:function(){return BOLT_PROTOCOL_V4_4$2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new transformer_1$8.default(Object.values(bolt_protocol_v4x4_transformer_1$1.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),t.prototype.requestRoutingInformation=function(e){var t=e.routingContext,t=void 0===t?{}:t,r=e.databaseName,r=void 0===r?null:r,o=e.impersonatedUser,o=void 0===o?null:o,n=e.sessionContext,n=void 0===n?{}:n,i=e.onError,e=e.onCompleted,i=new stream_observers_1$6.RouteObserver({onProtocolError:this._onProtocolError,onError:i,onCompleted:e}),e=n.bookmarks||Bookmarks$1.empty();return this.write(request_message_1$6.default.routeV4x4(t,e.values(),{databaseName:r,impersonatedUser:o}),i,!0),i},t.prototype.run=function(e,t,r){var r=void 0===r?{}:r,o=r.bookmarks,n=r.txConfig,i=r.database,a=r.mode,s=r.impersonatedUser,u=r.notificationFilter,c=r.beforeKeys,l=r.afterKeys,_=r.beforeError,f=r.afterError,d=r.beforeComplete,p=r.afterComplete,h=r.flush,h=void 0===h||h,m=r.reactive,m=void 0!==m&&m,b=r.fetchSize,b=void 0===b?FETCH_ALL$2:b,g=r.highRecordWatermark,g=void 0===g?Number.MAX_VALUE:g,r=r.lowRecordWatermark,r=void 0===r?Number.MAX_VALUE:r,c=new stream_observers_1$6.ResultStreamObserver({server:this._server,reactive:m,fetchSize:b,moreFunction:this._requestMore.bind(this),discardFunction:this._requestDiscard.bind(this),beforeKeys:c,afterKeys:l,beforeError:_,afterError:f,beforeComplete:d,afterComplete:p,highRecordWatermark:g,lowRecordWatermark:r}),l=((0,bolt_protocol_util_1$2.assertNotificationFilterIsEmpty)(u,this._onProtocolError,c),m);return this.write(request_message_1$6.default.runWithMetadata(e,t,{bookmarks:o,txConfig:n,database:i,mode:a,impersonatedUser:s}),c,l&&h),m||this.write(request_message_1$6.default.pull({n:b}),c,h),c},t.prototype.beginTransaction=function(e){var e=void 0===e?{}:e,t=e.bookmarks,r=e.txConfig,o=e.database,n=e.mode,i=e.impersonatedUser,a=e.notificationFilter,s=e.beforeError,u=e.afterError,c=e.beforeComplete,e=e.afterComplete,s=new stream_observers_1$6.ResultStreamObserver({server:this._server,beforeError:s,afterError:u,beforeComplete:c,afterComplete:e});return s.prepareToHandleSingleResponse(),(0,bolt_protocol_util_1$2.assertNotificationFilterIsEmpty)(a,this._onProtocolError,s),this.write(request_message_1$6.default.begin({bookmarks:t,txConfig:r,database:o,mode:n,impersonatedUser:i}),s,!0),s},t.prototype._applyUtcPatch=function(){var t=this;this._transformer=new transformer_1$8.default(Object.values(__assign$d(__assign$d({},bolt_protocol_v4x4_transformer_1$1.default),bolt_protocol_v5x0_utc_transformer_1$1.default)).map(function(e){return e(t._config,t._log)}))},t}(bolt_protocol_v4x3_1$1.default),boltProtocolV5x0=(boltProtocolV4x4.default=BoltProtocol$8,{}),boltProtocolV5x0_transformer={},__assign$c=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$c=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__read$3=commonjsGlobal&&commonjsGlobal.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(o=i.next()).done;)a.push(o.value)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},__importDefault$l=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},packstream_1=(Object.defineProperty(boltProtocolV5x0_transformer,"__esModule",{value:!0}),packstream),neo4j_driver_core_1$j=lib$1,bolt_protocol_v4x4_transformer_1=__importDefault$l(boltProtocolV4x4_transformer),bolt_protocol_v5x0_utc_transformer_1=__importDefault$l(boltProtocolV5x0_utc_transformer),NODE_STRUCT_SIZE=4,RELATIONSHIP_STRUCT_SIZE=8,UNBOUND_RELATIONSHIP_STRUCT_SIZE=4;function createNodeTransformer(e){return bolt_protocol_v4x4_transformer_1.default.createNodeTransformer(e).extendsWith({fromStructure:function(e){packstream_1.structure.verifyStructSize("Node",NODE_STRUCT_SIZE,e.size);var e=__read$3(e.fields,4),t=e[0],r=e[1],o=e[2],e=e[3];return new neo4j_driver_core_1$j.Node(t,r,o,e)}})}function createRelationshipTransformer(e){return bolt_protocol_v4x4_transformer_1.default.createRelationshipTransformer(e).extendsWith({fromStructure:function(e){packstream_1.structure.verifyStructSize("Relationship",RELATIONSHIP_STRUCT_SIZE,e.size);var e=__read$3(e.fields,8),t=e[0],r=e[1],o=e[2],n=e[3],i=e[4],a=e[5],s=e[6],e=e[7];return new neo4j_driver_core_1$j.Relationship(t,r,o,n,i,a,s,e)}})}function createUnboundRelationshipTransformer(e){return bolt_protocol_v4x4_transformer_1.default.createUnboundRelationshipTransformer(e).extendsWith({fromStructure:function(e){packstream_1.structure.verifyStructSize("UnboundRelationship",UNBOUND_RELATIONSHIP_STRUCT_SIZE,e.size);var e=__read$3(e.fields,4),t=e[0],r=e[1],o=e[2],e=e[3];return new neo4j_driver_core_1$j.UnboundRelationship(t,r,o,e)}})}boltProtocolV5x0_transformer.default=__assign$c(__assign$c(__assign$c({},bolt_protocol_v4x4_transformer_1.default),bolt_protocol_v5x0_utc_transformer_1.default),{createNodeTransformer:createNodeTransformer,createRelationshipTransformer:createRelationshipTransformer,createUnboundRelationshipTransformer:createUnboundRelationshipTransformer});var __extends$e=commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),__importDefault$k=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},bolt_protocol_v4x4_1$1=(Object.defineProperty(boltProtocolV5x0,"__esModule",{value:!0}),__importDefault$k(boltProtocolV4x4)),bolt_protocol_util_1$1=boltProtocolUtil,bolt_protocol_v5x0_transformer_1$1=__importDefault$k(boltProtocolV5x0_transformer),transformer_1$7=__importDefault$k(transformer),request_message_1$5=__importDefault$k(requestMessage),stream_observers_1$5=streamObservers,neo4j_driver_core_1$i=lib$1,BOLT_PROTOCOL_V5_0=lib$1.internal.constants.BOLT_PROTOCOL_V5_0,BoltProtocol$7=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends$e(t,e),Object.defineProperty(t.prototype,"version",{get:function(){return BOLT_PROTOCOL_V5_0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new transformer_1$7.default(Object.values(bolt_protocol_v5x0_transformer_1$1.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),t.prototype.initialize=function(e){var t=this,e=void 0===e?{}:e,r=e.userAgent,o=(e.boltAgent,e.authToken),n=e.notificationFilter,i=e.onError,a=e.onComplete,e=new stream_observers_1$5.LoginObserver({onError:function(e){return t._onLoginError(e,i)},onCompleted:function(e){return t._onLoginCompleted(e,o,a)}});return(0,bolt_protocol_util_1$1.assertNotificationFilterIsEmpty)(n,this._onProtocolError,e),this.write(request_message_1$5.default.hello(r,o,this._serversideRouting),e,!0),e},t}(bolt_protocol_v4x4_1$1.default),boltProtocolV5x1=(boltProtocolV5x0.default=BoltProtocol$7,{}),boltProtocolV5x1_transformer={},__assign$b=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$b=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__importDefault$j=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},bolt_protocol_v5x0_transformer_1=(Object.defineProperty(boltProtocolV5x1_transformer,"__esModule",{value:!0}),__importDefault$j(boltProtocolV5x0_transformer)),__extends$d=(boltProtocolV5x1_transformer.default=__assign$b({},bolt_protocol_v5x0_transformer_1.default),commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}()),__assign$a=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$a=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__importDefault$i=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},bolt_protocol_v5x0_1$1=(Object.defineProperty(boltProtocolV5x1,"__esModule",{value:!0}),__importDefault$i(boltProtocolV5x0)),bolt_protocol_util_1=boltProtocolUtil,bolt_protocol_v5x1_transformer_1$1=__importDefault$i(boltProtocolV5x1_transformer),transformer_1$6=__importDefault$i(transformer),request_message_1$4=__importDefault$i(requestMessage),stream_observers_1$4=streamObservers,neo4j_driver_core_1$h=lib$1,BOLT_PROTOCOL_V5_1$2=lib$1.internal.constants.BOLT_PROTOCOL_V5_1,BoltProtocol$6=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends$d(t,e),Object.defineProperty(t.prototype,"version",{get:function(){return BOLT_PROTOCOL_V5_1$2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new transformer_1$6.default(Object.values(bolt_protocol_v5x1_transformer_1$1.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportsReAuth",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.initialize=function(e){var t=this,e=void 0===e?{}:e,r=e.userAgent,o=(e.boltAgent,e.authToken),n=e.notificationFilter,i=e.onError,a=e.onComplete,s={},e=new stream_observers_1$4.LoginObserver({onError:function(e){return t._onLoginError(e,i)},onCompleted:function(e){return s.metadata=e,t._onLoginCompleted(e)}});return(0,bolt_protocol_util_1.assertNotificationFilterIsEmpty)(n,this._onProtocolError,e),this.write(request_message_1$4.default.hello5x1(r,this._serversideRouting),e,!1),this.logon({authToken:o,onComplete:function(e){return a(__assign$a(__assign$a({},e),s.metadata))},onError:i,flush:!0})},t.prototype.logon=function(e){var t=this,e=void 0===e?{}:e,r=e.authToken,o=e.onComplete,n=e.onError,e=e.flush,i=new stream_observers_1$4.LoginObserver({onCompleted:function(){return t._onLoginCompleted(null,r,o)},onError:function(e){return t._onLoginError(e,n)}});return this.write(request_message_1$4.default.logon(r),i,e),i},t.prototype.logoff=function(e){var e=void 0===e?{}:e,t=e.onComplete,r=e.onError,e=e.flush,t=new stream_observers_1$4.LogoffObserver({onCompleted:t,onError:r});return this.write(request_message_1$4.default.logoff(),t,e),t},t}(bolt_protocol_v5x0_1$1.default),boltProtocolV5x2=(boltProtocolV5x1.default=BoltProtocol$6,{}),boltProtocolV5x2_transformer={},__assign$9=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$9=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__importDefault$h=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},bolt_protocol_v5x1_transformer_1=(Object.defineProperty(boltProtocolV5x2_transformer,"__esModule",{value:!0}),__importDefault$h(boltProtocolV5x1_transformer)),__extends$c=(boltProtocolV5x2_transformer.default=__assign$9({},bolt_protocol_v5x1_transformer_1.default),commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}()),__assign$8=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$8=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__importDefault$g=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},bolt_protocol_v5x1_1$1=(Object.defineProperty(boltProtocolV5x2,"__esModule",{value:!0}),__importDefault$g(boltProtocolV5x1)),bolt_protocol_v5x2_transformer_1$1=__importDefault$g(boltProtocolV5x2_transformer),transformer_1$5=__importDefault$g(transformer),request_message_1$3=__importDefault$g(requestMessage),stream_observers_1$3=streamObservers,neo4j_driver_core_1$g=lib$1,_a$5=lib$1.internal.constants,BOLT_PROTOCOL_V5_2=_a$5.BOLT_PROTOCOL_V5_2,FETCH_ALL$1=_a$5.FETCH_ALL,BoltProtocol$5=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends$c(t,e),Object.defineProperty(t.prototype,"version",{get:function(){return BOLT_PROTOCOL_V5_2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new transformer_1$5.default(Object.values(bolt_protocol_v5x2_transformer_1$1.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportsReAuth",{get:function(){return!0},enumerable:!1,configurable:!0}),t.prototype.initialize=function(e){var t=this,e=void 0===e?{}:e,r=e.userAgent,o=(e.boltAgent,e.authToken),n=e.notificationFilter,i=e.onError,a=e.onComplete,s={},e=new stream_observers_1$3.LoginObserver({onError:function(e){return t._onLoginError(e,i)},onCompleted:function(e){return s.metadata=e,t._onLoginCompleted(e)}});return this.write(request_message_1$3.default.hello5x2(r,n,this._serversideRouting),e,!1),this.logon({authToken:o,onComplete:function(e){return a(__assign$8(__assign$8({},e),s.metadata))},onError:i,flush:!0})},t.prototype.beginTransaction=function(e){var e=void 0===e?{}:e,t=e.bookmarks,r=e.txConfig,o=e.database,n=e.mode,i=e.impersonatedUser,a=e.notificationFilter,s=e.beforeError,u=e.afterError,c=e.beforeComplete,e=e.afterComplete,s=new stream_observers_1$3.ResultStreamObserver({server:this._server,beforeError:s,afterError:u,beforeComplete:c,afterComplete:e});return s.prepareToHandleSingleResponse(),this.write(request_message_1$3.default.begin({bookmarks:t,txConfig:r,database:o,mode:n,impersonatedUser:i,notificationFilter:a}),s,!0),s},t.prototype.run=function(e,t,r){var r=void 0===r?{}:r,o=r.bookmarks,n=r.txConfig,i=r.database,a=r.mode,s=r.impersonatedUser,u=r.notificationFilter,c=r.beforeKeys,l=r.afterKeys,_=r.beforeError,f=r.afterError,d=r.beforeComplete,p=r.afterComplete,h=r.flush,h=void 0===h||h,m=r.reactive,m=void 0!==m&&m,b=r.fetchSize,b=void 0===b?FETCH_ALL$1:b,g=r.highRecordWatermark,g=void 0===g?Number.MAX_VALUE:g,r=r.lowRecordWatermark,r=void 0===r?Number.MAX_VALUE:r,c=new stream_observers_1$3.ResultStreamObserver({server:this._server,reactive:m,fetchSize:b,moreFunction:this._requestMore.bind(this),discardFunction:this._requestDiscard.bind(this),beforeKeys:c,afterKeys:l,beforeError:_,afterError:f,beforeComplete:d,afterComplete:p,highRecordWatermark:g,lowRecordWatermark:r}),l=m;return this.write(request_message_1$3.default.runWithMetadata(e,t,{bookmarks:o,txConfig:n,database:i,mode:a,impersonatedUser:s,notificationFilter:u}),c,l&&h),m||this.write(request_message_1$3.default.pull({n:b}),c,h),c},t}(bolt_protocol_v5x1_1$1.default),boltProtocolV5x3=(boltProtocolV5x2.default=BoltProtocol$5,{}),boltProtocolV5x3_transformer={},__assign$7=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$7=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__importDefault$f=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},bolt_protocol_v5x2_transformer_1=(Object.defineProperty(boltProtocolV5x3_transformer,"__esModule",{value:!0}),__importDefault$f(boltProtocolV5x2_transformer)),__extends$b=(boltProtocolV5x3_transformer.default=__assign$7({},bolt_protocol_v5x2_transformer_1.default),commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}()),__assign$6=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$6=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__importDefault$e=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},bolt_protocol_v5x2_1$1=(Object.defineProperty(boltProtocolV5x3,"__esModule",{value:!0}),__importDefault$e(boltProtocolV5x2)),bolt_protocol_v5x3_transformer_1$1=__importDefault$e(boltProtocolV5x3_transformer),transformer_1$4=__importDefault$e(transformer),request_message_1$2=__importDefault$e(requestMessage),stream_observers_1$2=streamObservers,neo4j_driver_core_1$f=lib$1,BOLT_PROTOCOL_V5_3=lib$1.internal.constants.BOLT_PROTOCOL_V5_3,BoltProtocol$4=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends$b(t,e),Object.defineProperty(t.prototype,"version",{get:function(){return BOLT_PROTOCOL_V5_3},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new transformer_1$4.default(Object.values(bolt_protocol_v5x3_transformer_1$1.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),t.prototype.initialize=function(e){var t=this,e=void 0===e?{}:e,r=e.userAgent,o=e.boltAgent,n=e.authToken,i=e.notificationFilter,a=e.onError,s=e.onComplete,u={},e=new stream_observers_1$2.LoginObserver({onError:function(e){return t._onLoginError(e,a)},onCompleted:function(e){return u.metadata=e,t._onLoginCompleted(e)}});return this.write(request_message_1$2.default.hello5x3(r,o,i,this._serversideRouting),e,!1),this.logon({authToken:n,onComplete:function(e){return s(__assign$6(__assign$6({},e),u.metadata))},onError:a,flush:!0})},t}(bolt_protocol_v5x2_1$1.default),boltProtocolV5x4=(boltProtocolV5x3.default=BoltProtocol$4,{}),boltProtocolV5x4_transformer={},__assign$5=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$5=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__importDefault$d=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},bolt_protocol_v5x3_transformer_1=(Object.defineProperty(boltProtocolV5x4_transformer,"__esModule",{value:!0}),__importDefault$d(boltProtocolV5x3_transformer)),__extends$a=(boltProtocolV5x4_transformer.default=__assign$5({},bolt_protocol_v5x3_transformer_1.default),commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}()),__importDefault$c=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},bolt_protocol_v5x3_1$1=(Object.defineProperty(boltProtocolV5x4,"__esModule",{value:!0}),__importDefault$c(boltProtocolV5x3)),bolt_protocol_v5x4_transformer_1$1=__importDefault$c(boltProtocolV5x4_transformer),request_message_1$1=__importDefault$c(requestMessage),stream_observers_1$1=streamObservers,transformer_1$3=__importDefault$c(transformer),neo4j_driver_core_1$e=lib$1,BOLT_PROTOCOL_V5_4=lib$1.internal.constants.BOLT_PROTOCOL_V5_4,BoltProtocol$3=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends$a(t,e),Object.defineProperty(t.prototype,"version",{get:function(){return BOLT_PROTOCOL_V5_4},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new transformer_1$3.default(Object.values(bolt_protocol_v5x4_transformer_1$1.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),t.prototype.telemetry=function(e,t){var e=e.api,t=void 0===t?{}:t,r=t.onError,t=t.onCompleted,t=new stream_observers_1$1.TelemetryObserver({onCompleted:t,onError:r});return this.write(request_message_1$1.default.telemetry({api:e}),t,!1),t},t}(bolt_protocol_v5x3_1$1.default),boltProtocolV5x5=(boltProtocolV5x4.default=BoltProtocol$3,{}),boltProtocolV5x5_transformer={},__assign$4=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$4=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__importDefault$b=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},bolt_protocol_v5x4_transformer_1=(Object.defineProperty(boltProtocolV5x5_transformer,"__esModule",{value:!0}),__importDefault$b(boltProtocolV5x4_transformer)),__extends$9=(boltProtocolV5x5_transformer.default=__assign$4({},bolt_protocol_v5x4_transformer_1.default),commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}()),__assign$3=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$3=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__importDefault$a=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},bolt_protocol_v5x4_1$1=(Object.defineProperty(boltProtocolV5x5,"__esModule",{value:!0}),__importDefault$a(boltProtocolV5x4)),bolt_protocol_v5x5_transformer_1$2=__importDefault$a(boltProtocolV5x5_transformer),transformer_1$2=__importDefault$a(transformer),request_message_1=__importDefault$a(requestMessage),stream_observers_1=streamObservers,neo4j_driver_core_1$d=lib$1,_a$4=lib$1.internal.constants,BOLT_PROTOCOL_V5_5=_a$4.BOLT_PROTOCOL_V5_5,FETCH_ALL=_a$4.FETCH_ALL,DEFAULT_DIAGNOSTIC_RECORD$2=Object.freeze({OPERATION:"",OPERATION_CODE:"0",CURRENT_SCHEMA:"/"}),BoltProtocol$2=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends$9(t,e),Object.defineProperty(t.prototype,"version",{get:function(){return BOLT_PROTOCOL_V5_5},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new transformer_1$2.default(Object.values(bolt_protocol_v5x5_transformer_1$2.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),t.prototype.initialize=function(e){var t=this,e=void 0===e?{}:e,r=e.userAgent,o=e.boltAgent,n=e.authToken,i=e.notificationFilter,a=e.onError,s=e.onComplete,u={},e=new stream_observers_1.LoginObserver({onError:function(e){return t._onLoginError(e,a)},onCompleted:function(e){return u.metadata=e,t._onLoginCompleted(e)}});return this.write(request_message_1.default.hello5x5(r,o,i,this._serversideRouting),e,!1),this.logon({authToken:n,onComplete:function(e){return s(__assign$3(__assign$3({},e),u.metadata))},onError:a,flush:!0})},t.prototype.beginTransaction=function(e){var e=void 0===e?{}:e,t=e.bookmarks,r=e.txConfig,o=e.database,n=e.mode,i=e.impersonatedUser,a=e.notificationFilter,s=e.beforeError,u=e.afterError,c=e.beforeComplete,e=e.afterComplete,s=new stream_observers_1.ResultStreamObserver({server:this._server,beforeError:s,afterError:u,beforeComplete:c,afterComplete:e});return s.prepareToHandleSingleResponse(),this.write(request_message_1.default.begin5x5({bookmarks:t,txConfig:r,database:o,mode:n,impersonatedUser:i,notificationFilter:a}),s,!0),s},t.prototype.run=function(e,t,r){var r=void 0===r?{}:r,o=r.bookmarks,n=r.txConfig,i=r.database,a=r.mode,s=r.impersonatedUser,u=r.notificationFilter,c=r.beforeKeys,l=r.afterKeys,_=r.beforeError,f=r.afterError,d=r.beforeComplete,p=r.afterComplete,h=r.flush,h=void 0===h||h,m=r.reactive,m=void 0!==m&&m,b=r.fetchSize,b=void 0===b?FETCH_ALL:b,g=r.highRecordWatermark,g=void 0===g?Number.MAX_VALUE:g,r=r.lowRecordWatermark,r=void 0===r?Number.MAX_VALUE:r,c=new stream_observers_1.ResultStreamObserver({server:this._server,reactive:m,fetchSize:b,moreFunction:this._requestMore.bind(this),discardFunction:this._requestDiscard.bind(this),beforeKeys:c,afterKeys:l,beforeError:_,afterError:f,beforeComplete:d,afterComplete:p,highRecordWatermark:g,lowRecordWatermark:r,enrichMetadata:this._enrichMetadata}),l=m;return this.write(request_message_1.default.runWithMetadata5x5(e,t,{bookmarks:o,txConfig:n,database:i,mode:a,impersonatedUser:s,notificationFilter:u}),c,l&&h),m||this.write(request_message_1.default.pull({n:b}),c,h),c},t.prototype._enrichMetadata=function(e){return Array.isArray(e.statuses)&&(e.statuses=e.statuses.map(function(e){return __assign$3(__assign$3({},e),{description:null!=e.neo4j_code?e.status_description:e.description,diagnostic_record:null!==e.diagnostic_record?__assign$3(__assign$3({},DEFAULT_DIAGNOSTIC_RECORD$2),e.diagnostic_record):null})})),e},t}(bolt_protocol_v5x4_1$1.default),boltProtocolV5x6=(boltProtocolV5x5.default=BoltProtocol$2,{}),__extends$8=commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),__assign$2=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$2=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__importDefault$9=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},bolt_protocol_v5x5_1$1=(Object.defineProperty(boltProtocolV5x6,"__esModule",{value:!0}),__importDefault$9(boltProtocolV5x5)),bolt_protocol_v5x5_transformer_1$1=__importDefault$9(boltProtocolV5x5_transformer),transformer_1$1=__importDefault$9(transformer),neo4j_driver_core_1$c=lib$1,BOLT_PROTOCOL_V5_6=lib$1.internal.constants.BOLT_PROTOCOL_V5_6,DEFAULT_DIAGNOSTIC_RECORD$1=Object.freeze({OPERATION:"",OPERATION_CODE:"0",CURRENT_SCHEMA:"/"}),BoltProtocol$1=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends$8(t,e),Object.defineProperty(t.prototype,"version",{get:function(){return BOLT_PROTOCOL_V5_6},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new transformer_1$1.default(Object.values(bolt_protocol_v5x5_transformer_1$1.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),t.prototype._enrichMetadata=function(e){return Array.isArray(e.statuses)&&(e.statuses=e.statuses.map(function(e){return __assign$2(__assign$2({},e),{diagnostic_record:null!==e.diagnostic_record?__assign$2(__assign$2({},DEFAULT_DIAGNOSTIC_RECORD$1),e.diagnostic_record):null})})),e},t}(bolt_protocol_v5x5_1$1.default),boltProtocolV5x7=(boltProtocolV5x6.default=BoltProtocol$1,{}),__extends$7=commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),__assign$1=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign$1=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__importDefault$8=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},bolt_protocol_v5x6_1$1=(Object.defineProperty(boltProtocolV5x7,"__esModule",{value:!0}),__importDefault$8(boltProtocolV5x6)),bolt_protocol_v5x5_transformer_1=__importDefault$8(boltProtocolV5x5_transformer),transformer_1=__importDefault$8(transformer),neo4j_driver_core_1$b=lib$1,BOLT_PROTOCOL_V5_7=lib$1.internal.constants.BOLT_PROTOCOL_V5_7,DEFAULT_DIAGNOSTIC_RECORD=Object.freeze({OPERATION:"",OPERATION_CODE:"0",CURRENT_SCHEMA:"/"}),BoltProtocol=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends$7(t,e),Object.defineProperty(t.prototype,"version",{get:function(){return BOLT_PROTOCOL_V5_7},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transformer",{get:function(){var t=this;return void 0===this._transformer&&(this._transformer=new transformer_1.default(Object.values(bolt_protocol_v5x5_transformer_1.default).map(function(e){return e(t._config,t._log)}))),this._transformer},enumerable:!1,configurable:!0}),t.prototype.enrichErrorMetadata=function(e){return __assign$1(__assign$1({},e),{cause:null!==e.cause&&void 0!==e.cause?this.enrichErrorMetadata(e.cause):null,code:e.neo4j_code,diagnostic_record:null!==e.diagnostic_record?__assign$1(__assign$1({},DEFAULT_DIAGNOSTIC_RECORD),e.diagnostic_record):null})},t}(bolt_protocol_v5x6_1$1.default),responseHandler=(boltProtocolV5x7.default=BoltProtocol,{}),neo4j_driver_core_1$a=(Object.defineProperty(responseHandler,"__esModule",{value:!0}),lib$1),SUCCESS=112,RECORD=113,IGNORED=126,FAILURE=127;function NO_OP(){}function NO_OP_IDENTITY(e){return e}var NO_OP_OBSERVER={onNext:NO_OP,onCompleted:NO_OP,onError:NO_OP},ResponseHandler=function(){function e(e){var e=void 0===e?{}:e,t=e.transformMetadata,r=e.enrichErrorMetadata,o=e.log,e=e.observer;this._pendingObservers=[],this._log=o,this._transformMetadata=t||NO_OP_IDENTITY,this._enrichErrorMetadata=r||NO_OP_IDENTITY,this._observer=Object.assign({onObserversCountChange:NO_OP,onError:NO_OP,onFailure:NO_OP,onErrorApplyTransformation:NO_OP_IDENTITY},e)}return Object.defineProperty(e.prototype,"currentFailure",{get:function(){return this._currentFailure},enumerable:!1,configurable:!0}),e.prototype.handleResponse=function(e){var t=e.fields[0];switch(e.signature){case RECORD:this._log.isDebugEnabled()&&this._log.debug("S: RECORD ".concat(neo4j_driver_core_1$a.json.stringify(e))),this._currentObserver.onNext(t);break;case SUCCESS:this._log.isDebugEnabled()&&this._log.debug("S: SUCCESS ".concat(neo4j_driver_core_1$a.json.stringify(e)));try{var r=this._transformMetadata(t);this._currentObserver.onCompleted(r)}finally{this._updateCurrentObserver()}break;case FAILURE:this._log.isDebugEnabled()&&this._log.debug("S: FAILURE ".concat(neo4j_driver_core_1$a.json.stringify(e)));try{this._currentFailure=this._handleErrorPayload(this._enrichErrorMetadata(t)),this._currentObserver.onError(this._currentFailure)}finally{this._updateCurrentObserver(),this._observer.onFailure(this._currentFailure)}break;case IGNORED:this._log.isDebugEnabled()&&this._log.debug("S: IGNORED ".concat(neo4j_driver_core_1$a.json.stringify(e)));try{this._currentFailure&&this._currentObserver.onError?this._currentObserver.onError(this._currentFailure):this._currentObserver.onError&&this._currentObserver.onError((0,neo4j_driver_core_1$a.newError)("Ignored either because of an error or RESET"))}finally{this._updateCurrentObserver()}break;default:this._observer.onError((0,neo4j_driver_core_1$a.newError)("Unknown Bolt protocol message: "+e))}},e.prototype._updateCurrentObserver=function(){this._currentObserver=this._pendingObservers.shift(),this._observer.onObserversCountChange(this._observersCount)},Object.defineProperty(e.prototype,"_observersCount",{get:function(){return null==this._currentObserver?this._pendingObservers.length:this._pendingObservers.length+1},enumerable:!1,configurable:!0}),e.prototype._queueObserver=function(e){return(e=e||NO_OP_OBSERVER).onCompleted=e.onCompleted||NO_OP,e.onError=e.onError||NO_OP,e.onNext=e.onNext||NO_OP,void 0===this._currentObserver?this._currentObserver=e:this._pendingObservers.push(e),this._observer.onObserversCountChange(this._observersCount),!0},e.prototype._notifyErrorToObservers=function(e){for(this._currentObserver&&this._currentObserver.onError&&this._currentObserver.onError(e);0<this._pendingObservers.length;){var t=this._pendingObservers.shift();t&&t.onError&&t.onError(e)}},e.prototype.hasOngoingObservableRequests=function(){return null!=this._currentObserver||0<this._pendingObservers.length},e.prototype._resetFailure=function(){this._currentFailure=null},e.prototype._handleErrorPayload=function(e){var t=_standardizeCode(e.code),r=null!=e.cause?this._handleErrorCause(e.cause):void 0,t=(0,neo4j_driver_core_1$a.newError)(e.message,t,r,e.gql_status,e.description,e.diagnostic_record);return this._observer.onErrorApplyTransformation(t)},e.prototype._handleErrorCause=function(e){var t=null!=e.cause?this._handleErrorCause(e.cause):void 0,t=(0,neo4j_driver_core_1$a.newGQLError)(e.message,t,e.gql_status,e.description,e.diagnostic_record);return this._observer.onErrorApplyTransformation(t)},e}();function _standardizeCode(e){return"Neo.TransientError.Transaction.Terminated"===e?"Neo.ClientError.Transaction.Terminated":"Neo.TransientError.Transaction.LockClientStopped"===e?"Neo.ClientError.Transaction.LockClientStopped":e}responseHandler.default=ResponseHandler;var __importDefault$7=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},neo4j_driver_core_1$9=(Object.defineProperty(create$1,"__esModule",{value:!0}),lib$1),bolt_protocol_v1_1=__importDefault$7(boltProtocolV1),bolt_protocol_v2_1=__importDefault$7(boltProtocolV2),bolt_protocol_v3_1=__importDefault$7(boltProtocolV3),bolt_protocol_v4x0_1=__importDefault$7(boltProtocolV4x0),bolt_protocol_v4x1_1=__importDefault$7(boltProtocolV4x1),bolt_protocol_v4x2_1=__importDefault$7(boltProtocolV4x2),bolt_protocol_v4x3_1=__importDefault$7(boltProtocolV4x3),bolt_protocol_v4x4_1=__importDefault$7(boltProtocolV4x4),bolt_protocol_v5x0_1=__importDefault$7(boltProtocolV5x0),bolt_protocol_v5x1_1=__importDefault$7(boltProtocolV5x1),bolt_protocol_v5x2_1=__importDefault$7(boltProtocolV5x2),bolt_protocol_v5x3_1=__importDefault$7(boltProtocolV5x3),bolt_protocol_v5x4_1=__importDefault$7(boltProtocolV5x4),bolt_protocol_v5x5_1=__importDefault$7(boltProtocolV5x5),bolt_protocol_v5x6_1=__importDefault$7(boltProtocolV5x6),bolt_protocol_v5x7_1=__importDefault$7(boltProtocolV5x7),response_handler_1=__importDefault$7(responseHandler);function create(e){var e=void 0===e?{}:e,t=e.version,r=e.chunker,o=e.dechunker,n=e.channel,i=e.disableLosslessIntegers,a=e.useBigInt,s=e.serversideRouting,u=e.server,c=e.log,l=e.observer;return createProtocol(t,u,r,{disableLosslessIntegers:i,useBigInt:a},s,function(t){var r=new response_handler_1.default({transformMetadata:t.transformMetadata.bind(t),enrichErrorMetadata:t.enrichErrorMetadata.bind(t),log:c,observer:l});return n.onerror=l.onError.bind(l),n.onmessage=function(e){return o.write(e)},o.onmessage=function(e){try{r.handleResponse(t.unpack(e))}catch(e){return l.onError(e)}},r},l.onProtocolError.bind(l),c)}function createProtocol(e,t,r,o,n,i,a,s){switch(e){case 1:return new bolt_protocol_v1_1.default(t,r,o,i,s,a);case 2:return new bolt_protocol_v2_1.default(t,r,o,i,s,a);case 3:return new bolt_protocol_v3_1.default(t,r,o,i,s,a);case 4:return new bolt_protocol_v4x0_1.default(t,r,o,i,s,a);case 4.1:return new bolt_protocol_v4x1_1.default(t,r,o,i,s,a,n);case 4.2:return new bolt_protocol_v4x2_1.default(t,r,o,i,s,a,n);case 4.3:return new bolt_protocol_v4x3_1.default(t,r,o,i,s,a,n);case 4.4:return new bolt_protocol_v4x4_1.default(t,r,o,i,s,a,n);case 5:return new bolt_protocol_v5x0_1.default(t,r,o,i,s,a,n);case 5.1:return new bolt_protocol_v5x1_1.default(t,r,o,i,s,a,n);case 5.2:return new bolt_protocol_v5x2_1.default(t,r,o,i,s,a,n);case 5.3:return new bolt_protocol_v5x3_1.default(t,r,o,i,s,a,n);case 5.4:return new bolt_protocol_v5x4_1.default(t,r,o,i,s,a,n);case 5.5:return new bolt_protocol_v5x5_1.default(t,r,o,i,s,a,n);case 5.6:return new bolt_protocol_v5x6_1.default(t,r,o,i,s,a,n);case 5.7:return new bolt_protocol_v5x7_1.default(t,r,o,i,s,a,n);default:throw(0,neo4j_driver_core_1$9.newError)("Unknown Bolt protocol version: "+e)}}create$1.default=create,function(e){var o=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&("get"in n?t.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){e[o=void 0===o?r:o]=t[r]}),t=commonjsGlobal&&commonjsGlobal.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)},r=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},n=(Object.defineProperty(e,"__esModule",{value:!0}),e.RawRoutingTable=e.BoltProtocol=void 0,r(handshake$1)),i=r(create$1),a=r(boltProtocolV4x3),r=r(routingTableRaw);t(streamObservers,e),e.BoltProtocol=a.default,e.RawRoutingTable=r.default,e.default={handshake:n.default,create:i.default}}(bolt);var connectionProvider={},connectionProviderSingle={},__extends$6=commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),neo4j_driver_core_1$8=(Object.defineProperty(connectionProviderSingle,"__esModule",{value:!0}),lib$1),SingleConnectionProvider=function(r){function e(e){var t=r.call(this)||this;return t._connection=e,t}return __extends$6(e,r),e.prototype.acquireConnection=function(e){e=void 0===e?{}:e,e.accessMode,e.database,e.bookmarks,e=this._connection;return this._connection=null,Promise.resolve(e)},e}(lib$1.ConnectionProvider),connectionProviderPooled=(connectionProviderSingle.default=SingleConnectionProvider,{}),connection$1={},connection={},__extends$5=commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),neo4j_driver_core_1$7=(Object.defineProperty(connection,"__esModule",{value:!0}),lib$1),Connection=function(r){function e(e){var t=r.call(this)||this;return t._errorHandler=e,t}return __extends$5(e,r),Object.defineProperty(e.prototype,"id",{get:function(){throw new Error("not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"databaseId",{get:function(){throw new Error("not implemented")},set:function(e){throw new Error("not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"authToken",{get:function(){throw new Error("not implemented")},set:function(e){throw new Error("not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"supportsReAuth",{get:function(){throw new Error("not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"creationTimestamp",{get:function(){throw new Error("not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"idleTimestamp",{get:function(){throw new Error("not implemented")},set:function(e){throw new Error("not implemented")},enumerable:!1,configurable:!0}),e.prototype.protocol=function(){throw new Error("not implemented")},Object.defineProperty(e.prototype,"address",{get:function(){throw new Error("not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){throw new Error("not implemented")},set:function(e){throw new Error("not implemented")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"server",{get:function(){throw new Error("not implemented")},enumerable:!1,configurable:!0}),e.prototype.connect=function(e,t,r,o){throw new Error("not implemented")},e.prototype.write=function(e,t,r){throw new Error("not implemented")},e.prototype.close=function(){throw new Error("not implemented")},e.prototype.handleAndTransformError=function(e,t){return this._errorHandler?this._errorHandler.handleAndTransformError(e,t,this):e},e}(lib$1.Connection),connectionChannel=(connection.default=Connection,{}),__extends$4=commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),__awaiter$6=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function o(e){try{i(u.next(e))}catch(e){t(e)}}function n(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(o,n)}i((u=u.apply(e,a||[])).next())})},__generator$6=commonjsGlobal&&commonjsGlobal.__generator||function(o,n){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=n.call(o,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__importDefault$6=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},channel_1$2=(Object.defineProperty(connectionChannel,"__esModule",{value:!0}),connectionChannel.createChannelConnection=void 0,channel),neo4j_driver_core_1$6=lib$1,connection_1$4=__importDefault$6(connection),bolt_1=__importDefault$6(bolt),PROTOCOL_ERROR$1=neo4j_driver_core_1$6.error.PROTOCOL_ERROR,Logger=neo4j_driver_core_1$6.internal.logger.Logger,idGenerator=0;function createChannelConnection(i,a,s,u,e,c,t){void 0===c&&(c=null);var l=(t=void 0===t?function(e){return new channel_1$2.Channel(e)}:t)(new channel_1$2.ChannelConfig(i,a,s.errorCode(),e));return bolt_1.default.handshake(l,u).then(function(e){var r=e.protocolVersion,e=e.consumeRemainingBuffer,o=new channel_1$2.Chunker(l),n=new channel_1$2.Dechunker,t=new ChannelConnection(l,s,i,u,a.disableLosslessIntegers,c,o,a.notificationFilter,function(t){return bolt_1.default.create({version:r,channel:l,chunker:o,dechunker:n,disableLosslessIntegers:a.disableLosslessIntegers,useBigInt:a.useBigInt,serversideRouting:c,server:t.server,log:t.logger,observer:{onObserversCountChange:t._handleOngoingRequestsNumberChange.bind(t),onError:t._handleFatalError.bind(t),onFailure:t._resetOnFailure.bind(t),onProtocolError:t._handleProtocolError.bind(t),onErrorApplyTransformation:function(e){return t.handleAndTransformError(e,t._address)}}})},a.telemetryDisabled);return e(function(e){return n.write(e)}),t}).catch(function(e){return l.close().then(function(){throw e})})}connectionChannel.createChannelConnection=createChannelConnection;var ChannelConnection=function(l){function e(e,t,r,o,n,i,a,s,u,c){void 0===n&&(n=!1),void 0===i&&(i=null);t=l.call(this,t)||this;return t._authToken=null,t._idle=!1,t._reseting=!1,t._resetObservers=[],t._id=idGenerator++,t._address=r,t._server={address:r.asHostPort()},t._creationTimestamp=Date.now(),t._disableLosslessIntegers=n,t._ch=e,t._chunker=a,t._log=createConnectionLogger(t,o),t._serversideRouting=i,t._notificationFilter=s,t._telemetryDisabledDriverConfig=!0===c,t._telemetryDisabledConnection=!0,t._dbConnectionId=null,t._protocol=u(t),t._isBroken=!1,t._log.isDebugEnabled()&&t._log.debug("created towards ".concat(r)),t}return __extends$4(e,l),e.prototype.beginTransaction=function(e){return this._sendTelemetryIfEnabled(e),this._protocol.beginTransaction(e)},e.prototype.run=function(e,t,r){return this._sendTelemetryIfEnabled(r),this._protocol.run(e,t,r)},e.prototype._sendTelemetryIfEnabled=function(e){this._telemetryDisabledConnection||this._telemetryDisabledDriverConfig||null==e||null==e.apiTelemetryConfig||this._protocol.telemetry({api:e.apiTelemetryConfig.api},{onCompleted:e.apiTelemetryConfig.onTelemetrySuccess,onError:e.beforeError})},e.prototype.commitTransaction=function(e){return this._protocol.commitTransaction(e)},e.prototype.rollbackTransaction=function(e){return this._protocol.rollbackTransaction(e)},e.prototype.getProtocolVersion=function(){return this._protocol.version},Object.defineProperty(e.prototype,"authToken",{get:function(){return this._authToken},set:function(e){this._authToken=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"supportsReAuth",{get:function(){return this._protocol.supportsReAuth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"databaseId",{get:function(){return this._dbConnectionId},set:function(e){this._dbConnectionId=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"idleTimestamp",{get:function(){return this._idleTimestamp},set:function(e){this._idleTimestamp=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"creationTimestamp",{get:function(){return this._creationTimestamp},enumerable:!1,configurable:!0}),e.prototype.connect=function(t,o,n,i){return __awaiter$6(this,void 0,void 0,function(){var r=this;return __generator$6(this,function(e){switch(e.label){case 0:if(this._protocol.initialized&&!this._protocol.supportsReAuth)throw(0,neo4j_driver_core_1$6.newError)("Connection does not support re-auth");return this._authToken=n,this._protocol.initialized?[3,2]:[4,this._initialize(t,o,n)];case 1:return[2,e.sent()];case 2:return i?[4,new Promise(function(e,t){r._protocol.logoff({onError:t}),r._protocol.logon({authToken:n,onError:t,onComplete:function(){return e(r)},flush:!0})})]:[3,4];case 3:return[2,e.sent()];case 4:return this._protocol.logoff(),this._protocol.logon({authToken:n,flush:!0}),[2,this]}})})},e.prototype._initialize=function(e,o,n){var i=this,a=this;return new Promise(function(r,t){i._protocol.initialize({userAgent:e,boltAgent:o,authToken:n,notificationFilter:i._notificationFilter,onError:function(e){return t(e)},onComplete:function(e){var t;e&&(t=e.server,i.version&&!t||(i.version=t),t=e.connection_id,i.databaseId||(i.databaseId=t),e.hints)&&(null!=(t=e.hints["connection.recv_timeout_seconds"])&&(t=(0,neo4j_driver_core_1$6.toNumber)(t),Number.isInteger(t)&&0<t?i._ch.setupReceiveTimeout(1e3*t):i._log.info("Server located at ".concat(i._address," supplied an invalid connection receive timeout value (").concat(t,"). ")+"Please, verify the server configuration and status because this can be the symptom of a bigger issue.")),!0===e.hints["telemetry.enabled"])&&(i._telemetryDisabledConnection=!1),r(a)}})})},e.prototype.protocol=function(){return this._protocol},Object.defineProperty(e.prototype,"address",{get:function(){return this._address},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this._server.version},set:function(e){this._server.version=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"server",{get:function(){return this._server},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"logger",{get:function(){return this._log},enumerable:!1,configurable:!0}),e.prototype._handleFatalError=function(e){this._isBroken=!0,this._error=this.handleAndTransformError(this._protocol.currentFailure||e,this._address),this._log.isErrorEnabled()&&this._log.error("experienced a fatal error caused by ".concat(this._error," (").concat(neo4j_driver_core_1$6.json.stringify(this._error),")")),this._protocol.notifyFatalError(this._error)},e.prototype._setIdle=function(e){this._idle=!0,this._ch.stopReceiveTimeout(),this._protocol.queueObserverIfProtocolIsNotBroken(e)},e.prototype._unsetIdle=function(){this._idle=!1,this._updateCurrentObserver()},e.prototype._queueObserver=function(e){return this._protocol.queueObserverIfProtocolIsNotBroken(e)},e.prototype.hasOngoingObservableRequests=function(){return!this._idle&&this._protocol.hasOngoingObservableRequests()},e.prototype.resetAndFlush=function(){var r=this;return new Promise(function(e,t){r._reset({onError:function(e){r._isBroken?t(e):(e=r._handleProtocolError("Received FAILURE as a response for RESET: ".concat(e)),t(e))},onComplete:function(){e()}})})},e.prototype._resetOnFailure=function(){var e=this;this.isOpen()&&this._reset({onError:function(){e._protocol.resetFailure()},onComplete:function(){e._protocol.resetFailure()}})},e.prototype._reset=function(t){var e,r=this;this._reseting?this._protocol.isLastMessageReset()?this._resetObservers.push(t):this._protocol.reset({onError:function(e){t.onError(e)},onComplete:function(){t.onComplete()}}):(this._resetObservers.push(t),this._reseting=!0,e=function(e){r._reseting=!1;var t=r._resetObservers;r._resetObservers=[],t.forEach(e)},this._protocol.reset({onError:function(t){e(function(e){return e.onError(t)})},onComplete:function(){e(function(e){return e.onComplete()})}}))},e.prototype._updateCurrentObserver=function(){this._protocol.updateCurrentObserver()},e.prototype.isOpen=function(){return!this._isBroken&&this._ch._open},e.prototype._handleOngoingRequestsNumberChange=function(e){this._idle||(0===e?this._ch.stopReceiveTimeout():this._ch.startReceiveTimeout())},e.prototype.close=function(){return __awaiter$6(this,void 0,void 0,function(){return __generator$6(this,function(e){switch(e.label){case 0:return this._log.isDebugEnabled()&&this._log.debug("closing"),this._protocol&&this.isOpen()&&this._protocol.prepareToClose(),[4,this._ch.close()];case 1:return e.sent(),this._log.isDebugEnabled()&&this._log.debug("closed"),[2]}})})},e.prototype.toString=function(){return"Connection [".concat(this.id,"][").concat(this.databaseId||"","]")},e.prototype._handleProtocolError=function(e){this._protocol.resetFailure(),this._updateCurrentObserver();e=(0,neo4j_driver_core_1$6.newError)(e,PROTOCOL_ERROR$1);return this._handleFatalError(e),e},e}(connection_1$4.default);function createConnectionLogger(r,o){return new Logger(o._level,function(e,t){return o._loggerFunction(e,"".concat(r," ").concat(t))})}connectionChannel.default=ChannelConnection;var connectionDelegate={},__extends$3=commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),__importDefault$5=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},connection_1$3=(Object.defineProperty(connectionDelegate,"__esModule",{value:!0}),__importDefault$5(connection)),DelegateConnection=function(o){function e(e,t){var r=o.call(this,t)||this;return t&&(r._originalErrorHandler=e._errorHandler,e._errorHandler=r._errorHandler),r._delegate=e,r}return __extends$3(e,o),e.prototype.beginTransaction=function(e){return this._delegate.beginTransaction(e)},e.prototype.run=function(e,t,r){return this._delegate.run(e,t,r)},e.prototype.commitTransaction=function(e){return this._delegate.commitTransaction(e)},e.prototype.rollbackTransaction=function(e){return this._delegate.rollbackTransaction(e)},e.prototype.getProtocolVersion=function(){return this._delegate.getProtocolVersion()},Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"databaseId",{get:function(){return this._delegate.databaseId},set:function(e){this._delegate.databaseId=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"server",{get:function(){return this._delegate.server},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"authToken",{get:function(){return this._delegate.authToken},set:function(e){this._delegate.authToken=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"supportsReAuth",{get:function(){return this._delegate.supportsReAuth},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"address",{get:function(){return this._delegate.address},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this._delegate.version},set:function(e){this._delegate.version=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"creationTimestamp",{get:function(){return this._delegate.creationTimestamp},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"idleTimestamp",{get:function(){return this._delegate.idleTimestamp},set:function(e){this._delegate.idleTimestamp=e},enumerable:!1,configurable:!0}),e.prototype.isOpen=function(){return this._delegate.isOpen()},e.prototype.protocol=function(){return this._delegate.protocol()},e.prototype.connect=function(e,t,r,o){return this._delegate.connect(e,t,r,o)},e.prototype.write=function(e,t,r){return this._delegate.write(e,t,r)},e.prototype.resetAndFlush=function(){return this._delegate.resetAndFlush()},e.prototype.hasOngoingObservableRequests=function(){return this._delegate.hasOngoingObservableRequests()},e.prototype.close=function(){return this._delegate.close()},e.prototype.release=function(){return this._originalErrorHandler&&(this._delegate._errorHandler=this._originalErrorHandler),this._delegate.release()},e}(connection_1$3.default),connectionErrorHandler=(connectionDelegate.default=DelegateConnection,{}),neo4j_driver_core_1$5=(Object.defineProperty(connectionErrorHandler,"__esModule",{value:!0}),lib$1),SERVICE_UNAVAILABLE$3=neo4j_driver_core_1$5.error.SERVICE_UNAVAILABLE,SESSION_EXPIRED$1=neo4j_driver_core_1$5.error.SESSION_EXPIRED,ConnectionErrorHandler=function(){function t(e,t,r,o){this._errorCode=e,this._handleUnavailability=t||noOpHandler,this._handleWriteFailure=r||noOpHandler,this._handleSecurityError=o||noOpHandler}return t.create=function(e){return new t(e.errorCode,e.handleUnavailability,e.handleWriteFailure,e.handleSecurityError)},t.prototype.errorCode=function(){return this._errorCode},t.prototype.handleAndTransformError=function(e,t,r){return isSecurityError(e)?this._handleSecurityError(e,t,r):isAvailabilityError(e)?this._handleUnavailability(e,t,r):isFailureToWrite(e)?this._handleWriteFailure(e,t,r):e},t}();function isSecurityError(e){return null!=e&&null!=e.code&&e.code.startsWith("Neo.ClientError.Security.")}function isAvailabilityError(e){return!!e&&(e.code===SESSION_EXPIRED$1||e.code===SERVICE_UNAVAILABLE$3||"Neo.TransientError.General.DatabaseUnavailable"===e.code)}function isFailureToWrite(e){return!!e&&("Neo.ClientError.Cluster.NotALeader"===e.code||"Neo.ClientError.General.ForbiddenOnReadOnlyDatabase"===e.code)}function noOpHandler(e){return e}connectionErrorHandler.default=ConnectionErrorHandler,function(e){var o=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&("get"in n?t.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){e[o=void 0===o?r:o]=t[r]}),n=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),t=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&o(t,e,r);return n(t,e),t},r=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},i=(Object.defineProperty(e,"__esModule",{value:!0}),e.createChannelConnection=e.ConnectionErrorHandler=e.DelegateConnection=e.ChannelConnection=e.Connection=void 0,r(connection)),a=(e.Connection=i.default,t(connectionChannel)),t=(e.ChannelConnection=a.default,Object.defineProperty(e,"createChannelConnection",{enumerable:!0,get:function(){return a.createChannelConnection}}),r(connectionDelegate)),t=(e.DelegateConnection=t.default,r(connectionErrorHandler));e.ConnectionErrorHandler=t.default,e.default=i.default}(connection$1);var authenticationProvider={},__awaiter$5=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function o(e){try{i(u.next(e))}catch(e){t(e)}}function n(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(o,n)}i((u=u.apply(e,a||[])).next())})},__generator$5=commonjsGlobal&&commonjsGlobal.__generator||function(o,n){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=n.call(o,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},neo4j_driver_core_1$4=(Object.defineProperty(authenticationProvider,"__esModule",{value:!0}),lib$1),lang_1$2=lang,AuthenticationProvider=function(){function e(e){var t=e.authTokenManager,r=e.userAgent,e=e.boltAgent;this._authTokenManager=t||(0,neo4j_driver_core_1$4.staticAuthTokenManager)({}),this._userAgent=r,this._boltAgent=e}return e.prototype.authenticate=function(e){var r=e.connection,o=e.auth,n=e.skipReAuth,i=e.waitReAuth,a=e.forceReAuth;return __awaiter$5(this,void 0,void 0,function(){var t;return __generator$5(this,function(e){switch(e.label){case 0:return null==o?[3,3]:(t=!0===r.supportsReAuth&&(!lang_1$2.object.equals(r.authToken,o)&&!0!==n||!0===a),null==r.authToken||t?[4,r.connect(this._userAgent,this._boltAgent,o,i||!1)]:[3,2]);case 1:return[2,e.sent()];case 2:return[2,r];case 3:return[4,this._authTokenManager.getToken()];case 4:return t=e.sent(),lang_1$2.object.equals(t,r.authToken)?[3,6]:[4,r.connect(this._userAgent,this._boltAgent,t,!1)];case 5:return[2,e.sent()];case 6:return[2,r]}})})},e.prototype.handleError=function(e){var t=e.connection,e=e.code;return!(!t||!e.startsWith("Neo.ClientError.Security."))&&this._authTokenManager.handleSecurityException(t.authToken,e)},e}(),livenessCheckProvider=(authenticationProvider.default=AuthenticationProvider,{}),__awaiter$4=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function o(e){try{i(u.next(e))}catch(e){t(e)}}function n(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(o,n)}i((u=u.apply(e,a||[])).next())})},__generator$4=commonjsGlobal&&commonjsGlobal.__generator||function(o,n){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=n.call(o,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},LivenessCheckProvider=(Object.defineProperty(livenessCheckProvider,"__esModule",{value:!0}),function(){function e(e){e=e.connectionLivenessCheckTimeout;this._connectionLivenessCheckTimeout=e}return e.prototype.check=function(r){return __awaiter$4(this,void 0,void 0,function(){var t;return __generator$4(this,function(e){switch(e.label){case 0:return this._isCheckDisabled||this._isNewlyCreatedConnection(r)?[2,!0]:(t=Date.now()-r.idleTimestamp,0===this._connectionLivenessCheckTimeout||t>this._connectionLivenessCheckTimeout?[4,r.resetAndFlush().then(function(){return!0})]:[3,2]);case 1:return[2,e.sent()];case 2:return[2,!0]}})})},Object.defineProperty(e.prototype,"_isCheckDisabled",{get:function(){return null==this._connectionLivenessCheckTimeout||this._connectionLivenessCheckTimeout<0},enumerable:!1,configurable:!0}),e.prototype._isNewlyCreatedConnection=function(e){return null==e.authToken},e}()),clientCertificateHolder=(livenessCheckProvider.default=LivenessCheckProvider,{}),__awaiter$3=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function o(e){try{i(u.next(e))}catch(e){t(e)}}function n(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(o,n)}i((u=u.apply(e,a||[])).next())})},__generator$3=commonjsGlobal&&commonjsGlobal.__generator||function(o,n){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=n.call(o,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},channel_1$1=(Object.defineProperty(clientCertificateHolder,"__esModule",{value:!0}),channel),ClientCertificateHolder=function(){function e(e){var t=e.clientCertificateProvider,e=e.loader;this._clientCertificateProvider=t,this._loader=e||channel_1$1.ClientCertificatesLoader,this._clientCertificate=null}return e.prototype.getClientCertificate=function(){return __awaiter$3(this,void 0,void 0,function(){var t,r,o=this;return __generator$3(this,function(e){switch(e.label){case 0:return(t=null!=this._clientCertificateProvider)?(r=null==this._clientCertificate)?[3,2]:[4,this._clientCertificateProvider.hasUpdate()]:[3,3];case 1:r=e.sent(),e.label=2;case 2:t=r,e.label=3;case 3:return t&&(this._clientCertificate=Promise.resolve(this._clientCertificateProvider.getClientCertificate()).then(this._loader.load).then(function(e){return o._clientCertificate=e,o._clientCertificate}).catch(function(e){throw o._clientCertificate=null,e})),[2,this._clientCertificate]}})})},e}(),__extends$2=(clientCertificateHolder.default=ClientCertificateHolder,commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}()),__awaiter$2=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function o(e){try{i(u.next(e))}catch(e){t(e)}}function n(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(o,n)}i((u=u.apply(e,a||[])).next())})},__generator$2=commonjsGlobal&&commonjsGlobal.__generator||function(o,n){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=n.call(o,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__read$2=commonjsGlobal&&commonjsGlobal.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(o=i.next()).done;)a.push(o.value)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},__spreadArray$1=commonjsGlobal&&commonjsGlobal.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var o,n=0,i=t.length;n<i;n++)!o&&n in t||((o=o||Array.prototype.slice.call(t,0,n))[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))},__importDefault$4=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},connection_1$2=(Object.defineProperty(connectionProviderPooled,"__esModule",{value:!0}),connection$1),neo4j_driver_core_1$3=lib$1,authentication_provider_1=__importDefault$4(authenticationProvider),lang_1$1=lang,liveness_check_provider_1=__importDefault$4(livenessCheckProvider),client_certificate_holder_1=__importDefault$4(clientCertificateHolder),SERVICE_UNAVAILABLE$2=neo4j_driver_core_1$3.error.SERVICE_UNAVAILABLE,AUTHENTICATION_ERRORS=["Neo.ClientError.Security.CredentialsExpired","Neo.ClientError.Security.Forbidden","Neo.ClientError.Security.TokenExpired","Neo.ClientError.Security.Unauthorized"],_a$3=neo4j_driver_core_1$3.internal.pool,Pool=_a$3.Pool,PoolConfig=_a$3.PoolConfig,PooledConnectionProvider=function(c){function l(e,t){var r=e.id,o=e.config,n=e.log,i=e.userAgent,a=e.boltAgent,s=e.authTokenManager,e=e.newPool,e=void 0===e?function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new(Pool.bind.apply(Pool,__spreadArray$1([void 0],__read$2(e),!1)))}:e,u=(void 0===t&&(t=null),c.call(this)||this);return u._id=r,u._config=o,u._log=n,u._clientCertificateHolder=new client_certificate_holder_1.default({clientCertificateProvider:u._config.clientCertificate}),u._authenticationProvider=new authentication_provider_1.default({authTokenManager:s,userAgent:i,boltAgent:a}),u._livenessCheckProvider=new liveness_check_provider_1.default({connectionLivenessCheckTimeout:o.connectionLivenessCheckTimeout}),u._userAgent=i,u._boltAgent=a,u._createChannelConnection=t||function(o){return __awaiter$2(u,void 0,void 0,function(){var t,r;return __generator$2(this,function(e){switch(e.label){case 0:return t=connection_1$2.createChannelConnection,r=[o,this._config,this._createConnectionErrorHandler(),this._log],[4,this._clientCertificateHolder.getClientCertificate()];case 1:return[2,t.apply(void 0,r.concat([e.sent()]))]}})})},u._connectionPool=e({create:u._createConnection.bind(u),destroy:u._destroyConnection.bind(u),validateOnAcquire:u._validateConnectionOnAcquire.bind(u),validateOnRelease:u._validateConnectionOnRelease.bind(u),installIdleObserver:l._installIdleObserverOnConnection.bind(u),removeIdleObserver:l._removeIdleObserverOnConnection.bind(u),config:PoolConfig.fromDriverConfig(o),log:u._log}),u._openConnections={},u}return __extends$2(l,c),l.prototype._createConnectionErrorHandler=function(){return new connection_1$2.ConnectionErrorHandler(SERVICE_UNAVAILABLE$2)},l.prototype._getClientCertificate=function(){return __awaiter$2(this,void 0,void 0,function(){return __generator$2(this,function(e){return[2,this._config.clientCertificate.getClientCertificate()]})})},l.prototype._createConnection=function(e,r,o){var n=this,i=e.auth;return this._createChannelConnection(r).then(function(t){return t.release=function(){return t.idleTimestamp=Date.now(),o(r,t)},n._openConnections[t.id]=t,n._authenticationProvider.authenticate({connection:t,auth:i}).catch(function(e){throw n._destroyConnection(t),e})})},l.prototype._validateConnectionOnAcquire=function(e,r){var o=e.auth,n=e.skipReAuth;return __awaiter$2(this,void 0,void 0,function(){var t;return __generator$2(this,function(e){switch(e.label){case 0:if(!this._validateConnection(r))return[2,!1];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this._livenessCheckProvider.check(r)];case 2:return e.sent(),[3,4];case 3:return t=e.sent(),this._log.debug("The connection ".concat(r.id," is not alive because of an error ").concat(t.code," '").concat(t.message,"'")),[2,!1];case 4:return e.trys.push([4,6,,7]),[4,this._authenticationProvider.authenticate({connection:r,auth:o,skipReAuth:n})];case 5:return e.sent(),[2,!0];case 6:return t=e.sent(),this._log.debug("The connection ".concat(r.id," is not valid because of an error ").concat(t.code," '").concat(t.message,"'")),[2,!1];case 7:return[2]}})})},l.prototype._validateConnectionOnRelease=function(e){return!0!==e._sticky&&this._validateConnection(e)},l.prototype._validateConnection=function(e){return!(!e.isOpen()||this._config.maxConnectionLifetime<Date.now()-e.creationTimestamp)},l.prototype._destroyConnection=function(e){return delete this._openConnections[e.id],e.close()},l.prototype._verifyConnectivityAndGetServerVersion=function(e){var o=e.address;return __awaiter$2(this,void 0,void 0,function(){var t,r;return __generator$2(this,function(e){switch(e.label){case 0:return[4,this._connectionPool.acquire({},o)];case 1:t=e.sent(),r=new neo4j_driver_core_1$3.ServerInfo(t.server,t.protocol().version),e.label=2;case 2:return e.trys.push([2,,5,7]),t.protocol().isLastMessageLogon()?[3,4]:[4,t.resetAndFlush()];case 3:e.sent(),e.label=4;case 4:return[3,7];case 5:return[4,t.release()];case 6:return e.sent(),[7];case 7:return[2,r]}})})},l.prototype._verifyAuthentication=function(e){var a=e.getAddress,s=e.auth;return __awaiter$2(this,void 0,void 0,function(){var t,r,o,n,i;return __generator$2(this,function(e){switch(e.label){case 0:t=[],e.label=1;case 1:return e.trys.push([1,8,9,11]),[4,a()];case 2:return r=e.sent(),[4,this._connectionPool.acquire({auth:s,skipReAuth:!0},r)];case 3:if(o=e.sent(),t.push(o),n=!o.protocol().isLastMessageLogon(),o.supportsReAuth)return n&&o.supportsReAuth?[4,this._authenticationProvider.authenticate({connection:o,auth:s,waitReAuth:!0,forceReAuth:!0})]:[3,5];throw(0,neo4j_driver_core_1$3.newError)("Driver is connected to a database that does not support user switch.");case 4:return e.sent(),[3,7];case 5:return!n||o.supportsReAuth?[3,7]:[4,this._connectionPool.acquire({auth:s},r,{requireNew:!0})];case 6:(i=e.sent())._sticky=!0,t.push(i),e.label=7;case 7:return[2,!0];case 8:if(i=e.sent(),AUTHENTICATION_ERRORS.includes(i.code))return[2,!1];throw i;case 9:return[4,Promise.all(t.map(function(e){return e.release()}))];case 10:return e.sent(),[7];case 11:return[2]}})})},l.prototype._verifyStickyConnection=function(e){var o=e.auth,n=e.connection;return e.address,__awaiter$2(this,void 0,void 0,function(){var t,r;return __generator$2(this,function(e){switch(e.label){case 0:return(t=lang_1$1.object.equals(o,n.authToken),r=!t,n._sticky=t&&!n.supportsReAuth,r||n._sticky)?[4,n.release()]:[3,2];case 1:throw e.sent(),(0,neo4j_driver_core_1$3.newError)("Driver is connected to a database that does not support user switch.");case 2:return[2]}})})},l.prototype.close=function(){return __awaiter$2(this,void 0,void 0,function(){return __generator$2(this,function(e){switch(e.label){case 0:return[4,this._connectionPool.close()];case 1:return e.sent(),[4,Promise.all(Object.values(this._openConnections).map(function(e){return e.close()}))];case 2:return e.sent(),[2]}})})},l._installIdleObserverOnConnection=function(e,t){e._setIdle(t)},l._removeIdleObserverOnConnection=function(e){e._unsetIdle()},l.prototype._handleSecurityError=function(e,t,r){return this._authenticationProvider.handleError({connection:r,code:e.code})&&(e.retriable=!0),"Neo.ClientError.Security.AuthorizationExpired"===e.code&&this._connectionPool.apply(t,function(e){e.authToken=null}),r&&r.close().catch(function(){}),e},l}(neo4j_driver_core_1$3.ConnectionProvider),connectionProviderDirect=(connectionProviderPooled.default=PooledConnectionProvider,{}),__extends$1=commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}(),__awaiter$1=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function o(e){try{i(u.next(e))}catch(e){t(e)}}function n(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(o,n)}i((u=u.apply(e,a||[])).next())})},__generator$1=commonjsGlobal&&commonjsGlobal.__generator||function(o,n){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=n.call(o,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__importDefault$3=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},connection_provider_pooled_1$1=(Object.defineProperty(connectionProviderDirect,"__esModule",{value:!0}),__importDefault$3(connectionProviderPooled)),connection_1$1=connection$1,neo4j_driver_core_1$2=lib$1,_a$2=neo4j_driver_core_1$2.internal.constants,BOLT_PROTOCOL_V3$1=_a$2.BOLT_PROTOCOL_V3,BOLT_PROTOCOL_V4_0$1=_a$2.BOLT_PROTOCOL_V4_0,BOLT_PROTOCOL_V4_4$1=_a$2.BOLT_PROTOCOL_V4_4,BOLT_PROTOCOL_V5_1$1=_a$2.BOLT_PROTOCOL_V5_1,SERVICE_UNAVAILABLE$1=neo4j_driver_core_1$2.error.SERVICE_UNAVAILABLE,DirectConnectionProvider=function(u){function e(e){var t=e.id,r=e.config,o=e.log,n=e.address,i=e.userAgent,a=e.boltAgent,s=e.authTokenManager,e=e.newPool,t=u.call(this,{id:t,config:r,log:o,userAgent:i,boltAgent:a,authTokenManager:s,newPool:e})||this;return t._address=n,t}return __extends$1(e,u),e.prototype.acquireConnection=function(e){var e=void 0===e?{}:e,n=(e.accessMode,e.database),i=(e.bookmarks,e.auth),a=e.forceReAuth;return __awaiter$1(this,void 0,void 0,function(){var t,r,o=this;return __generator$1(this,function(e){switch(e.label){case 0:return t=connection_1$1.ConnectionErrorHandler.create({errorCode:SERVICE_UNAVAILABLE$1,handleSecurityError:function(e,t,r){return o._handleSecurityError(e,t,r,n)}}),[4,this._connectionPool.acquire({auth:i,forceReAuth:a},this._address)];case 1:return(r=e.sent(),i)?[4,this._verifyStickyConnection({auth:i,connection:r,address:this._address})]:[3,3];case 2:return e.sent(),[2,r];case 3:return[2,new connection_1$1.DelegateConnection(r,t)]}})})},e.prototype._handleSecurityError=function(e,t,r,o){return this._log.warn("Direct driver ".concat(this._id," will close connection to ").concat(t," for database '").concat(o,"' because of an error ").concat(e.code," '").concat(e.message,"'")),u.prototype._handleSecurityError.call(this,e,t,r)},e.prototype._hasProtocolVersion=function(o){return __awaiter$1(this,void 0,void 0,function(){var t,r;return __generator$1(this,function(e){switch(e.label){case 0:return[4,this._createChannelConnection(this._address)];case 1:return t=e.sent(),r=t.protocol()?t.protocol().version:null,[4,t.close()];case 2:return e.sent(),r?[2,o(r)]:[2,!1]}})})},e.prototype.supportsMultiDb=function(){return __awaiter$1(this,void 0,void 0,function(){return __generator$1(this,function(e){switch(e.label){case 0:return[4,this._hasProtocolVersion(function(e){return BOLT_PROTOCOL_V4_0$1<=e})];case 1:return[2,e.sent()]}})})},e.prototype.getNegotiatedProtocolVersion=function(){var r=this;return new Promise(function(e,t){r._hasProtocolVersion(e).catch(t)})},e.prototype.supportsTransactionConfig=function(){return __awaiter$1(this,void 0,void 0,function(){return __generator$1(this,function(e){switch(e.label){case 0:return[4,this._hasProtocolVersion(function(e){return BOLT_PROTOCOL_V3$1<=e})];case 1:return[2,e.sent()]}})})},e.prototype.supportsUserImpersonation=function(){return __awaiter$1(this,void 0,void 0,function(){return __generator$1(this,function(e){switch(e.label){case 0:return[4,this._hasProtocolVersion(function(e){return BOLT_PROTOCOL_V4_4$1<=e})];case 1:return[2,e.sent()]}})})},e.prototype.supportsSessionAuth=function(){return __awaiter$1(this,void 0,void 0,function(){return __generator$1(this,function(e){switch(e.label){case 0:return[4,this._hasProtocolVersion(function(e){return BOLT_PROTOCOL_V5_1$1<=e})];case 1:return[2,e.sent()]}})})},e.prototype.verifyAuthentication=function(e){var r=e.auth;return __awaiter$1(this,void 0,void 0,function(){var t=this;return __generator$1(this,function(e){return[2,this._verifyAuthentication({auth:r,getAddress:function(){return t._address}})]})})},e.prototype.verifyConnectivityAndGetServerInfo=function(){return __awaiter$1(this,void 0,void 0,function(){return __generator$1(this,function(e){switch(e.label){case 0:return[4,this._verifyConnectivityAndGetServerVersion({address:this._address})];case 1:return[2,e.sent()]}})})},e}(connection_provider_pooled_1$1.default),connectionProviderRouting=(connectionProviderDirect.default=DirectConnectionProvider,{}),rediscovery$1={},rediscovery={},routingTable={},__read$1=commonjsGlobal&&commonjsGlobal.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(o=i.next()).done;)a.push(o.value)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},__spreadArray=commonjsGlobal&&commonjsGlobal.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var o,n=0,i=t.length;n<i;n++)!o&&n in t||((o=o||Array.prototype.slice.call(t,0,n))[n]=t[n]);return e.concat(o||Array.prototype.slice.call(t))},neo4j_driver_core_1$1=(Object.defineProperty(routingTable,"__esModule",{value:!0}),routingTable.createValidRoutingTable=void 0,lib$1),_a$1=neo4j_driver_core_1$1.internal.constants,WRITE$1=_a$1.ACCESS_MODE_WRITE,READ$1=_a$1.ACCESS_MODE_READ,ServerAddress=neo4j_driver_core_1$1.internal.serverAddress.ServerAddress,PROTOCOL_ERROR=neo4j_driver_core_1$1.error.PROTOCOL_ERROR,MIN_ROUTERS=1,RoutingTable=function(){function e(e){var e=void 0===e?{}:e,t=e.database,r=e.routers,o=e.readers,n=e.writers,i=e.expirationTime,e=e.ttl;this.database=t||null,this.databaseName=t||"default database",this.routers=r||[],this.readers=o||[],this.writers=n||[],this.expirationTime=i||(0,neo4j_driver_core_1$1.int)(0),this.ttl=e}return e.fromRawRoutingTable=function(e,t,r){return createValidRoutingTable(e,t,r)},e.prototype.forget=function(e){this.readers=removeFromArray(this.readers,e),this.writers=removeFromArray(this.writers,e)},e.prototype.forgetRouter=function(e){this.routers=removeFromArray(this.routers,e)},e.prototype.forgetWriter=function(e){this.writers=removeFromArray(this.writers,e)},e.prototype.isStaleFor=function(e){return this.expirationTime.lessThan(Date.now())||this.routers.length<MIN_ROUTERS||e===READ$1&&0===this.readers.length||e===WRITE$1&&0===this.writers.length},e.prototype.isExpiredFor=function(e){return this.expirationTime.add(e).lessThan(Date.now())},e.prototype.allServers=function(){return __spreadArray(__spreadArray(__spreadArray([],__read$1(this.routers),!1),__read$1(this.readers),!1),__read$1(this.writers),!1)},e.prototype.toString=function(){return"RoutingTable["+"database=".concat(this.databaseName,", ")+"expirationTime=".concat(this.expirationTime,", ")+"currentTime=".concat(Date.now(),", ")+"routers=[".concat(this.routers,"], ")+"readers=[".concat(this.readers,"], ")+"writers=[".concat(this.writers,"]]")},e}();function removeFromArray(e,t){return e.filter(function(e){return e.asKey()!==t.asKey()})}function createValidRoutingTable(e,t,r){var o=r.ttl,n=calculateExpirationTime(r,t),i=parseServers(r,t),a=i.routers,s=i.readers,i=i.writers;return assertNonEmpty(a,"routers",t),assertNonEmpty(s,"readers",t),new RoutingTable({database:e||r.db,routers:a,readers:s,writers:i,expirationTime:n,ttl:o})}function parseServers(t,r){try{var o=[],n=[],i=[];return t.servers.forEach(function(e){var t=e.role,e=e.addresses;"ROUTE"===t?o=parseArray(e).map(function(e){return ServerAddress.fromUrl(e)}):"WRITE"===t?i=parseArray(e).map(function(e){return ServerAddress.fromUrl(e)}):"READ"===t&&(n=parseArray(e).map(function(e){return ServerAddress.fromUrl(e)}))}),{routers:o,readers:n,writers:i}}catch(e){throw(0,neo4j_driver_core_1$1.newError)("Unable to parse servers entry from router ".concat(r," from addresses:\n").concat(neo4j_driver_core_1$1.json.stringify(t.servers),"\nError message: ").concat(e.message),PROTOCOL_ERROR)}}function calculateExpirationTime(t,r){try{var e=(0,neo4j_driver_core_1$1.int)(Date.now()),o=(0,neo4j_driver_core_1$1.int)(t.ttl).multiply(1e3).add(e);return o.lessThan(e)?neo4j_driver_core_1$1.Integer.MAX_VALUE:o}catch(e){throw(0,neo4j_driver_core_1$1.newError)("Unable to parse TTL entry from router ".concat(r," from raw routing table:\n").concat(neo4j_driver_core_1$1.json.stringify(t),"\nError message: ").concat(e.message),PROTOCOL_ERROR)}}function assertNonEmpty(e,t,r){if(0===e.length)throw(0,neo4j_driver_core_1$1.newError)("Received no "+t+" from router "+r,PROTOCOL_ERROR)}function parseArray(e){if(Array.isArray(e))return Array.from(e);throw new TypeError("Array expected but got: "+e)}routingTable.default=RoutingTable,routingTable.createValidRoutingTable=createValidRoutingTable;var __importDefault$2=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},routing_table_1$1=(Object.defineProperty(rediscovery,"__esModule",{value:!0}),__importDefault$2(routingTable)),Rediscovery=function(){function e(e){this._routingContext=e}return e.prototype.lookupRoutingTableOnRouter=function(t,r,o,n){var i=this;return t._acquireConnection(function(e){return i._requestRawRoutingTable(e,t,r,o,n).then(function(e){return e.isNull?null:routing_table_1$1.default.fromRawRoutingTable(r,o,e)})})},e.prototype._requestRawRoutingTable=function(r,o,n,e,i){var a=this;return new Promise(function(e,t){r.protocol().requestRoutingInformation({routingContext:a._routingContext,databaseName:n,impersonatedUser:i,sessionContext:{bookmarks:o._lastBookmarks,mode:o._mode,database:o._database,afterComplete:o._onComplete},onCompleted:e,onError:t})})},e}(),__importDefault$1=(rediscovery.default=Rediscovery,commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}}),rediscovery_1$1=(Object.defineProperty(rediscovery$1,"__esModule",{value:!0}),rediscovery$1.RoutingTable=rediscovery$1.Rediscovery=void 0,__importDefault$1(rediscovery)),routing_table_1=(rediscovery$1.Rediscovery=rediscovery_1$1.default,__importDefault$1(routingTable)),__extends=(rediscovery$1.RoutingTable=routing_table_1.default,rediscovery$1.default=rediscovery_1$1.default,commonjsGlobal&&commonjsGlobal.__extends||function(){var o=function(e,t){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}))(e,t)};return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}()),__assign=commonjsGlobal&&commonjsGlobal.__assign||function(){return(__assign=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},__createBinding=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&("get"in n?t.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){e[o=void 0===o?r:o]=t[r]}),__setModuleDefault=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),__importStar=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&__createBinding(t,e,r);return __setModuleDefault(t,e),t},__awaiter=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function o(e){try{i(u.next(e))}catch(e){t(e)}}function n(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(o,n)}i((u=u.apply(e,a||[])).next())})},__generator=commonjsGlobal&&commonjsGlobal.__generator||function(o,n){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=n.call(o,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},__values=commonjsGlobal&&commonjsGlobal.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],o=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return{value:(e=e&&o>=e.length?void 0:e)&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},__read=commonjsGlobal&&commonjsGlobal.__read||function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var o,n,i=r.call(e),a=[];try{for(;(void 0===t||0<t--)&&!(o=i.next()).done;)a.push(o.value)}catch(e){n={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return a},__importDefault=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},neo4j_driver_core_1=(Object.defineProperty(connectionProviderRouting,"__esModule",{value:!0}),lib$1),rediscovery_1=__importStar(rediscovery$1),channel_1=channel,connection_provider_single_1=__importDefault(connectionProviderSingle),connection_provider_pooled_1=__importDefault(connectionProviderPooled),load_balancing_1=loadBalancing,connection_1=connection$1,lang_1=lang,SERVICE_UNAVAILABLE=neo4j_driver_core_1.error.SERVICE_UNAVAILABLE,SESSION_EXPIRED=neo4j_driver_core_1.error.SESSION_EXPIRED,Bookmarks=neo4j_driver_core_1.internal.bookmarks.Bookmarks,_a=neo4j_driver_core_1.internal.constants,READ=_a.ACCESS_MODE_READ,WRITE=_a.ACCESS_MODE_WRITE,BOLT_PROTOCOL_V3=_a.BOLT_PROTOCOL_V3,BOLT_PROTOCOL_V4_0=_a.BOLT_PROTOCOL_V4_0,BOLT_PROTOCOL_V4_4=_a.BOLT_PROTOCOL_V4_4,BOLT_PROTOCOL_V5_1=_a.BOLT_PROTOCOL_V5_1,PROCEDURE_NOT_FOUND_CODE="Neo.ClientError.Procedure.ProcedureNotFound",DATABASE_NOT_FOUND_CODE="Neo.ClientError.Database.DatabaseNotFound",INVALID_BOOKMARK_CODE="Neo.ClientError.Transaction.InvalidBookmark",INVALID_BOOKMARK_MIXTURE_CODE="Neo.ClientError.Transaction.InvalidBookmarkMixture",AUTHORIZATION_EXPIRED_CODE="Neo.ClientError.Security.AuthorizationExpired",INVALID_ARGUMENT_ERROR="Neo.ClientError.Statement.ArgumentError",INVALID_REQUEST_ERROR="Neo.ClientError.Request.Invalid",STATEMENT_TYPE_ERROR="Neo.ClientError.Statement.TypeError",NOT_AVAILABLE="N/A",SYSTEM_DB_NAME="system",DEFAULT_DB_NAME=null,DEFAULT_ROUTING_TABLE_PURGE_DELAY=(0,neo4j_driver_core_1.int)(3e4),RoutingConnectionProvider=function(f){function d(e){var t=e.id,r=e.address,o=e.routingContext,n=e.hostNameResolver,i=e.config,a=e.log,s=e.userAgent,u=e.boltAgent,c=e.authTokenManager,l=e.routingTablePurgeDelay,e=e.newPool,_=f.call(this,{id:t,config:i,log:a,userAgent:s,boltAgent:u,authTokenManager:c,newPool:e},function(o){return __awaiter(_,void 0,void 0,function(){var t,r;return __generator(this,function(e){switch(e.label){case 0:return t=connection_1.createChannelConnection,r=[o,this._config,this._createConnectionErrorHandler(),this._log],[4,this._clientCertificateHolder.getClientCertificate()];case 1:return[2,t.apply(void 0,r.concat([e.sent(),this._routingContext]))]}})})})||this;return _._routingContext=__assign(__assign({},o),{address:r.toString()}),_._seedRouter=r,_._rediscovery=new rediscovery_1.default(_._routingContext),_._loadBalancingStrategy=new load_balancing_1.LeastConnectedLoadBalancingStrategy(_._connectionPool),_._hostNameResolver=n,_._dnsResolver=new channel_1.HostNameResolver,_._log=a,_._useSeedRouter=!0,_._routingTableRegistry=new RoutingTableRegistry(l?(0,neo4j_driver_core_1.int)(l):DEFAULT_ROUTING_TABLE_PURGE_DELAY),_._refreshRoutingTable=lang_1.functional.reuseOngoingRequest(_._refreshRoutingTable,_),_}return __extends(d,f),d.prototype._createConnectionErrorHandler=function(){return new connection_1.ConnectionErrorHandler(SESSION_EXPIRED)},d.prototype._handleUnavailability=function(e,t,r){return this._log.warn("Routing driver ".concat(this._id," will forget ").concat(t," for database '").concat(r,"' because of an error ").concat(e.code," '").concat(e.message,"'")),this.forget(t,r||DEFAULT_DB_NAME),e},d.prototype._handleSecurityError=function(e,t,r,o){return this._log.warn("Routing driver ".concat(this._id," will close connections to ").concat(t," for database '").concat(o,"' because of an error ").concat(e.code," '").concat(e.message,"'")),f.prototype._handleSecurityError.call(this,e,t,r,o)},d.prototype._handleWriteFailure=function(e,t,r){return this._log.warn("Routing driver ".concat(this._id," will forget writer ").concat(t," for database '").concat(r,"' because of an error ").concat(e.code," '").concat(e.message,"'")),this.forgetWriter(t,r||DEFAULT_DB_NAME),(0,neo4j_driver_core_1.newError)("No longer possible to write to server at "+t,SESSION_EXPIRED,e)},d.prototype.acquireConnection=function(e){var e=void 0===e?{}:e,u=e.accessMode,c=e.database,l=e.bookmarks,_=e.impersonatedUser,f=e.onDatabaseNameResolved,d=e.auth;return __awaiter(this,void 0,void 0,function(){var t,r,o,n,i,a,s=this;return __generator(this,function(e){switch(e.label){case 0:return o={database:c||DEFAULT_DB_NAME},n=new connection_1.ConnectionErrorHandler(SESSION_EXPIRED,function(e,t){return s._handleUnavailability(e,t,o.database)},function(e,t){return s._handleWriteFailure(e,t,o.database)},function(e,t,r){return s._handleSecurityError(e,t,r,o.database)}),[4,this._freshRoutingTable({accessMode:u,database:o.database,bookmarks:l,impersonatedUser:_,auth:d,onDatabaseNameResolved:function(e){o.database=o.database||e,f&&f(e)}})];case 1:if(a=e.sent(),u===READ)r=this._loadBalancingStrategy.selectReader(a.readers),t="read";else{if(u!==WRITE)throw(0,neo4j_driver_core_1.newError)("Illegal mode "+u);r=this._loadBalancingStrategy.selectWriter(a.writers),t="write"}if(!r)throw(0,neo4j_driver_core_1.newError)("Failed to obtain connection towards ".concat(t," server. Known routing table is: ").concat(a),SESSION_EXPIRED);e.label=2;case 2:return e.trys.push([2,6,,7]),[4,this._connectionPool.acquire({auth:d},r)];case 3:return(i=e.sent(),d)?[4,this._verifyStickyConnection({auth:d,connection:i,address:r})]:[3,5];case 4:return e.sent(),[2,i];case 5:return[2,new connection_1.DelegateConnection(i,n)];case 6:throw a=e.sent(),n.handleAndTransformError(a,r);case 7:return[2]}})})},d.prototype._hasProtocolVersion=function(a){return __awaiter(this,void 0,void 0,function(){var t,r,o,n,i;return __generator(this,function(e){switch(e.label){case 0:return[4,this._resolveSeedRouter(this._seedRouter)];case 1:t=e.sent(),o=0,e.label=2;case 2:if(!(o<t.length))return[3,8];e.label=3;case 3:return e.trys.push([3,6,,7]),[4,this._createChannelConnection(t[o])];case 4:return i=e.sent(),n=i.protocol()?i.protocol().version:null,[4,i.close()];case 5:return e.sent(),n?[2,a(n)]:[2,!1];case 6:return i=e.sent(),r=i,[3,7];case 7:return o++,[3,2];case 8:if(r)throw r;return[2,!1]}})})},d.prototype.supportsMultiDb=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this._hasProtocolVersion(function(e){return BOLT_PROTOCOL_V4_0<=e})];case 1:return[2,e.sent()]}})})},d.prototype.supportsTransactionConfig=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this._hasProtocolVersion(function(e){return BOLT_PROTOCOL_V3<=e})];case 1:return[2,e.sent()]}})})},d.prototype.supportsUserImpersonation=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this._hasProtocolVersion(function(e){return BOLT_PROTOCOL_V4_4<=e})];case 1:return[2,e.sent()]}})})},d.prototype.supportsSessionAuth=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this._hasProtocolVersion(function(e){return BOLT_PROTOCOL_V5_1<=e})];case 1:return[2,e.sent()]}})})},d.prototype.getNegotiatedProtocolVersion=function(){var r=this;return new Promise(function(e,t){r._hasProtocolVersion(e).catch(t)})},d.prototype.verifyAuthentication=function(e){var o=e.database,n=e.accessMode,i=e.auth;return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(e){return[2,this._verifyAuthentication({auth:i,getAddress:function(){return __awaiter(t,void 0,void 0,function(){var t,r;return __generator(this,function(e){switch(e.label){case 0:return t={database:o||DEFAULT_DB_NAME},[4,this._freshRoutingTable({accessMode:n,database:t.database,auth:i,onDatabaseNameResolved:function(e){t.database=t.database||e}})];case 1:if(r=e.sent(),0===(r=n===WRITE?r.writers:r.readers).length)throw(0,neo4j_driver_core_1.newError)("No servers available for database '".concat(t.database,"' with access mode '").concat(n,"'"),SERVICE_UNAVAILABLE);return[2,r[0]]}})})}})]})})},d.prototype.verifyConnectivityAndGetServerInfo=function(e){var l=e.database,_=e.accessMode;return __awaiter(this,void 0,void 0,function(){var t,r,o,n,i,a,s,u,c;return __generator(this,function(e){switch(e.label){case 0:return t={database:l||DEFAULT_DB_NAME},[4,this._freshRoutingTable({accessMode:_,database:t.database,onDatabaseNameResolved:function(e){t.database=t.database||e}})];case 1:r=e.sent(),r=_===WRITE?r.writers:r.readers,o=(0,neo4j_driver_core_1.newError)("No servers available for database '".concat(t.database,"' with access mode '").concat(_,"'"),SERVICE_UNAVAILABLE),e.label=2;case 2:e.trys.push([2,9,10,11]),n=__values(r),i=n.next(),e.label=3;case 3:if(i.done)return[3,8];a=i.value,e.label=4;case 4:return e.trys.push([4,6,,7]),[4,this._verifyConnectivityAndGetServerVersion({address:a})];case 5:return[2,e.sent()];case 6:return s=e.sent(),o=s,[3,7];case 7:return i=n.next(),[3,3];case 8:return[3,11];case 9:return s=e.sent(),u={error:s},[3,11];case 10:try{i&&!i.done&&(c=n.return)&&c.call(n)}finally{if(u)throw u.error}return[7];case 11:throw o}})})},d.prototype.forget=function(t,e){this._routingTableRegistry.apply(e,{applyWhenExists:function(e){return e.forget(t)}}),this._connectionPool.purge(t).catch(function(){})},d.prototype.forgetWriter=function(t,e){this._routingTableRegistry.apply(e,{applyWhenExists:function(e){return e.forgetWriter(t)}})},d.prototype._freshRoutingTable=function(e){var e=void 0===e?{}:e,t=e.accessMode,r=e.database,o=e.bookmarks,n=e.impersonatedUser,i=e.onDatabaseNameResolved,e=e.auth,a=this._routingTableRegistry.get(r,function(){return new rediscovery_1.RoutingTable({database:r})});return a.isStaleFor(t)?(this._log.info('Routing table is stale for database: "'.concat(r,'" and access mode: "').concat(t,'": ').concat(a)),this._refreshRoutingTable(a,o,n,e).then(function(e){return i(e.database),e})):a},d.prototype._refreshRoutingTable=function(e,t,r,o){var n=e.routers;return this._useSeedRouter?this._fetchRoutingTableFromSeedRouterFallbackToKnownRouters(n,e,t,r,o):this._fetchRoutingTableFromKnownRoutersFallbackToSeedRouter(n,e,t,r,o)},d.prototype._fetchRoutingTableFromSeedRouterFallbackToKnownRouters=function(a,s,u,c,l){return __awaiter(this,void 0,void 0,function(){var t,r,o,n,i;return __generator(this,function(e){switch(e.label){case 0:return t=[],[4,this._fetchRoutingTableUsingSeedRouter(t,this._seedRouter,s,u,c,l)];case 1:return(t=__read.apply(void 0,[e.sent(),2]),r=t[0],o=t[1],r)?(this._useSeedRouter=!1,[3,4]):[3,2];case 2:return[4,this._fetchRoutingTableUsingKnownRouters(a,s,u,c,l)];case 3:i=__read.apply(void 0,[e.sent(),2]),n=i[0],i=i[1],r=n,o=i||o,e.label=4;case 4:return[4,this._applyRoutingTableIfPossible(s,r,o)];case 5:return[2,e.sent()]}})})},d.prototype._fetchRoutingTableFromKnownRoutersFallbackToSeedRouter=function(n,i,a,s,u){return __awaiter(this,void 0,void 0,function(){var t,r,o;return __generator(this,function(e){switch(e.label){case 0:return[4,this._fetchRoutingTableUsingKnownRouters(n,i,a,s,u)];case 1:return r=__read.apply(void 0,[e.sent(),2]),t=r[0],r=r[1],t?[3,3]:[4,this._fetchRoutingTableUsingSeedRouter(n,this._seedRouter,i,a,s,u)];case 2:o=__read.apply(void 0,[e.sent(),2]),t=o[0],r=o[1],e.label=3;case 3:return[4,this._applyRoutingTableIfPossible(i,t,r)];case 4:return[2,e.sent()]}})})},d.prototype._fetchRoutingTableUsingKnownRouters=function(o,n,i,a,s){return __awaiter(this,void 0,void 0,function(){var t,r;return __generator(this,function(e){switch(e.label){case 0:return[4,this._fetchRoutingTable(o,n,i,a,s)];case 1:return(t=__read.apply(void 0,[e.sent(),2]),r=t[0],t=t[1],r)?[2,[r,null]]:(r=o.length-1,d._forgetRouter(n,o,r),[2,[null,t]])}})})},d.prototype._fetchRoutingTableUsingSeedRouter=function(r,o,n,i,a,s){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,this._resolveSeedRouter(o)];case 1:return t=e.sent(),t=t.filter(function(e){return r.indexOf(e)<0}),[4,this._fetchRoutingTable(t,n,i,a,s)];case 2:return[2,e.sent()]}})})},d.prototype._resolveSeedRouter=function(o){return __awaiter(this,void 0,void 0,function(){var t,r=this;return __generator(this,function(e){switch(e.label){case 0:return[4,this._hostNameResolver.resolve(o)];case 1:return t=e.sent(),[4,Promise.all(t.map(function(e){return r._dnsResolver.resolve(e)}))];case 2:return t=e.sent(),[2,[].concat.apply([],t)]}})})},d.prototype._fetchRoutingTable=function(u,c,l,_,f){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(e){return[2,u.reduce(function(i,a,s){return __awaiter(t,void 0,void 0,function(){var t,r,o,n;return __generator(this,function(e){switch(e.label){case 0:return[4,i];case 1:return(t=__read.apply(void 0,[e.sent(),1]),t=t[0])?[2,[t,null]]:(d._forgetRouter(c,u,s-1),[4,this._createSessionForRediscovery(a,l,_,f)]);case 2:if(t=__read.apply(void 0,[e.sent(),2]),r=t[0],o=t[1],!r)return[3,8];e.label=3;case 3:return e.trys.push([3,5,6,7]),[4,this._rediscovery.lookupRoutingTableOnRouter(r,c.database,a,_)];case 4:return[2,[e.sent(),null]];case 5:return n=e.sent(),[2,this._handleRediscoveryError(n,a)];case 6:return r.close(),[7];case 7:return[3,9];case 8:return[2,[null,o]];case 9:return[2]}})})},Promise.resolve([null,null]))]})})},d.prototype._createSessionForRediscovery=function(n,i,a,s){return __awaiter(this,void 0,void 0,function(){var t,r,o=this;return __generator(this,function(e){switch(e.label){case 0:return e.trys.push([0,4,,5]),[4,this._connectionPool.acquire({auth:s},n)];case 1:return(t=e.sent(),s)?[4,this._verifyStickyConnection({auth:s,connection:t,address:n})]:[3,3];case 2:e.sent(),e.label=3;case 3:return r=connection_1.ConnectionErrorHandler.create({errorCode:SESSION_EXPIRED,handleSecurityError:function(e,t,r){return o._handleSecurityError(e,t,r)}}),r=t._sticky?new connection_1.DelegateConnection(t):new connection_1.DelegateConnection(t,r),r=new connection_provider_single_1.default(r),t.protocol().version<4?[2,[new neo4j_driver_core_1.Session({mode:WRITE,bookmarks:Bookmarks.empty(),connectionProvider:r}),null]]:[2,[new neo4j_driver_core_1.Session({mode:READ,database:SYSTEM_DB_NAME,bookmarks:i,connectionProvider:r,impersonatedUser:a}),null]];case 4:return r=e.sent(),[2,this._handleRediscoveryError(r,n)];case 5:return[2]}})})},d.prototype._handleRediscoveryError=function(e,t){if(_isFailFastError(e)||_isFailFastSecurityError(e))throw e;if(e.code===PROCEDURE_NOT_FOUND_CODE)throw(0,neo4j_driver_core_1.newError)("Server at ".concat(t.asHostPort()," can't perform routing. Make sure you are connecting to a causal cluster"),SERVICE_UNAVAILABLE,e);return this._log.warn("unable to fetch routing table because of an error ".concat(e)),[null,e]},d.prototype._applyRoutingTableIfPossible=function(t,r,o){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:if(r)return 0===r.writers.length&&(this._useSeedRouter=!0),[4,this._updateRoutingTable(r)];throw(0,neo4j_driver_core_1.newError)("Could not perform discovery. No routing servers available. Known routing table: ".concat(t),SERVICE_UNAVAILABLE,o);case 1:return e.sent(),[2,r]}})})},d.prototype._updateRoutingTable=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this._connectionPool.keepAll(t.allServers())];case 1:return e.sent(),this._routingTableRegistry.removeExpired(),this._routingTableRegistry.register(t),this._log.info("Updated routing table ".concat(t)),[2]}})})},d._forgetRouter=function(e,t,r){t=t[r];e&&t&&e.forgetRouter(t)},d}(connection_provider_pooled_1.default),RoutingTableRegistry=(connectionProviderRouting.default=RoutingConnectionProvider,function(){function e(e){this._tables=new Map,this._routingTablePurgeDelay=e}return e.prototype.register=function(e){return this._tables.set(e.database,e),this},e.prototype.apply=function(e,t){var t=void 0===t?{}:t,r=t.applyWhenExists,t=t.applyWhenDontExists,t=void 0===t?function(){}:t;return this._tables.has(e)?r(this._tables.get(e)):"string"==typeof e||null===e?t():this._forEach(r),this},e.prototype.get=function(e,t){return this._tables.has(e)?this._tables.get(e):"function"==typeof t?t():t},e.prototype.removeExpired=function(){var t=this;return this._removeIf(function(e){return e.isExpiredFor(t._routingTablePurgeDelay)})},e.prototype._forEach=function(e){var t,r;try{for(var o=__values(this._tables),n=o.next();!n.done;n=o.next())e(__read(n.value,2)[1])}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return this},e.prototype._remove=function(e){return this._tables.delete(e),this},e.prototype._removeIf=function(e){var t,r;try{for(var o=__values(this._tables),n=o.next();!n.done;n=o.next()){var i=__read(n.value,2),a=i[0];e(i[1])&&this._remove(a)}}catch(e){t={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}return this},e}());function _isFailFastError(e){return[DATABASE_NOT_FOUND_CODE,INVALID_BOOKMARK_CODE,INVALID_BOOKMARK_MIXTURE_CODE,INVALID_ARGUMENT_ERROR,INVALID_REQUEST_ERROR,STATEMENT_TYPE_ERROR,NOT_AVAILABLE].includes(e.code)}function _isFailFastSecurityError(e){return e.code.startsWith("Neo.ClientError.Security.")&&![AUTHORIZATION_EXPIRED_CODE].includes(e.code)}!function(e){var t=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},r=(Object.defineProperty(e,"__esModule",{value:!0}),e.RoutingConnectionProvider=e.DirectConnectionProvider=e.PooledConnectionProvider=e.SingleConnectionProvider=void 0,connectionProviderSingle),o=(Object.defineProperty(e,"SingleConnectionProvider",{enumerable:!0,get:function(){return t(r).default}}),connectionProviderPooled),n=(Object.defineProperty(e,"PooledConnectionProvider",{enumerable:!0,get:function(){return t(o).default}}),connectionProviderDirect),i=(Object.defineProperty(e,"DirectConnectionProvider",{enumerable:!0,get:function(){return t(n).default}}),connectionProviderRouting);Object.defineProperty(e,"RoutingConnectionProvider",{enumerable:!0,get:function(){return t(i).default}})}(connectionProvider),function(e){var o=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(e,t,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(t,r);n&&("get"in n?t.__esModule:!n.writable&&!n.configurable)||(n={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,o,n)}:function(e,t,r,o){e[o=void 0===o?r:o]=t[r]}),n=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),t=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&o(t,e,r);return n(t,e),t},r=commonjsGlobal&&commonjsGlobal.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||o(t,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),e.packstream=e.channel=e.buf=e.bolt=e.loadBalancing=void 0,e.loadBalancing=t(loadBalancing),e.bolt=t(bolt),e.buf=t(buf),e.channel=t(channel),e.packstream=t(packstream),r(connectionProvider,e)}(lib),function(e){var t=commonjsGlobal&&commonjsGlobal.__awaiter||function(e,a,s,u){return new(s=s||Promise)(function(r,t){function o(e){try{i(u.next(e))}catch(e){t(e)}}function n(e){try{i(u.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?r(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(o,n)}i((u=u.apply(e,a||[])).next())})},n=commonjsGlobal&&commonjsGlobal.__generator||function(o,n){var i,a,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},c={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function e(r){return function(e){var t=[r,e];if(i)throw new TypeError("Generator is already executing.");for(;u=c&&t[c=0]?0:u;)try{if(i=1,a&&(s=2&t[0]?a.return:t[0]?a.throw||((s=a.return)&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,(t=s?[2&t[0],s.value]:t)[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3]))u.label=t[1];else if(6===t[0]&&u.label<s[1])u.label=s[1],s=t;else{if(!(s&&u.label<s[2])){s[2]&&u.ops.pop(),u.trys.pop();continue}u.label=s[2],u.ops.push(t)}}t=n.call(o,u)}catch(e){t=[6,e],a=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}}},r=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},_=(Object.defineProperty(e,"__esModule",{value:!0}),e.TransactionPromise=e.ManagedTransaction=e.Transaction=e.Session=e.ServerInfo=e.GqlStatusObject=e.Notification=e.QueryStatistics=e.ProfiledPlan=e.Plan=e.Integer=e.Path=e.PathSegment=e.UnboundRelationship=e.Relationship=e.Node=e.ResultSummary=e.Record=e.EagerResult=e.Result=e.Driver=e.temporal=e.spatial=e.graph=e.error=e.routing=e.session=e.types=e.logging=e.auth=e.isRetriableError=e.Neo4jError=e.integer=e.isUnboundRelationship=e.isRelationship=e.isPathSegment=e.isPath=e.isNode=e.isDateTime=e.isLocalDateTime=e.isDate=e.isTime=e.isLocalTime=e.isDuration=e.isPoint=e.isInt=e.int=e.hasReachableServer=e.driver=e.authTokenManagers=void 0,e.clientCertificateProviders=e.notificationFilterMinimumSeverityLevel=e.notificationFilterDisabledClassification=e.notificationFilterDisabledCategory=e.notificationSeverityLevel=e.notificationClassification=e.notificationCategory=e.resultTransformers=e.bookmarkManager=e.Connection=e.ConnectionProvider=e.DateTime=e.LocalDateTime=e.Date=e.Time=e.LocalTime=e.Duration=e.Point=void 0,r(version$1)),o=logging,f=(Object.defineProperty(e,"logging",{enumerable:!0,get:function(){return o.logging}}),lib$1),d=(Object.defineProperty(e,"auth",{enumerable:!0,get:function(){return f.auth}}),Object.defineProperty(e,"authTokenManagers",{enumerable:!0,get:function(){return f.authTokenManagers}}),Object.defineProperty(e,"bookmarkManager",{enumerable:!0,get:function(){return f.bookmarkManager}}),Object.defineProperty(e,"Connection",{enumerable:!0,get:function(){return f.Connection}}),Object.defineProperty(e,"ConnectionProvider",{enumerable:!0,get:function(){return f.ConnectionProvider}}),Object.defineProperty(e,"Date",{enumerable:!0,get:function(){return f.Date}}),Object.defineProperty(e,"DateTime",{enumerable:!0,get:function(){return f.DateTime}}),Object.defineProperty(e,"Driver",{enumerable:!0,get:function(){return f.Driver}}),Object.defineProperty(e,"Duration",{enumerable:!0,get:function(){return f.Duration}}),Object.defineProperty(e,"EagerResult",{enumerable:!0,get:function(){return f.EagerResult}}),Object.defineProperty(e,"error",{enumerable:!0,get:function(){return f.error}}),Object.defineProperty(e,"int",{enumerable:!0,get:function(){return f.int}}),Object.defineProperty(e,"Integer",{enumerable:!0,get:function(){return f.Integer}}),Object.defineProperty(e,"isDate",{enumerable:!0,get:function(){return f.isDate}}),Object.defineProperty(e,"isDateTime",{enumerable:!0,get:function(){return f.isDateTime}}),Object.defineProperty(e,"isDuration",{enumerable:!0,get:function(){return f.isDuration}}),Object.defineProperty(e,"isInt",{enumerable:!0,get:function(){return f.isInt}}),Object.defineProperty(e,"isLocalDateTime",{enumerable:!0,get:function(){return f.isLocalDateTime}}),Object.defineProperty(e,"isLocalTime",{enumerable:!0,get:function(){return f.isLocalTime}}),Object.defineProperty(e,"isNode",{enumerable:!0,get:function(){return f.isNode}}),Object.defineProperty(e,"isPath",{enumerable:!0,get:function(){return f.isPath}}),Object.defineProperty(e,"isPathSegment",{enumerable:!0,get:function(){return f.isPathSegment}}),Object.defineProperty(e,"isPoint",{enumerable:!0,get:function(){return f.isPoint}}),Object.defineProperty(e,"isRelationship",{enumerable:!0,get:function(){return f.isRelationship}}),Object.defineProperty(e,"isRetriableError",{enumerable:!0,get:function(){return f.isRetriableError}}),Object.defineProperty(e,"isTime",{enumerable:!0,get:function(){return f.isTime}}),Object.defineProperty(e,"isUnboundRelationship",{enumerable:!0,get:function(){return f.isUnboundRelationship}}),Object.defineProperty(e,"LocalDateTime",{enumerable:!0,get:function(){return f.LocalDateTime}}),Object.defineProperty(e,"LocalTime",{enumerable:!0,get:function(){return f.LocalTime}}),Object.defineProperty(e,"ManagedTransaction",{enumerable:!0,get:function(){return f.ManagedTransaction}}),Object.defineProperty(e,"Neo4jError",{enumerable:!0,get:function(){return f.Neo4jError}}),Object.defineProperty(e,"Node",{enumerable:!0,get:function(){return f.Node}}),Object.defineProperty(e,"Notification",{enumerable:!0,get:function(){return f.Notification}}),Object.defineProperty(e,"GqlStatusObject",{enumerable:!0,get:function(){return f.GqlStatusObject}}),Object.defineProperty(e,"notificationCategory",{enumerable:!0,get:function(){return f.notificationCategory}}),Object.defineProperty(e,"notificationClassification",{enumerable:!0,get:function(){return f.notificationClassification}}),Object.defineProperty(e,"notificationFilterDisabledCategory",{enumerable:!0,get:function(){return f.notificationFilterDisabledCategory}}),Object.defineProperty(e,"notificationFilterDisabledClassification",{enumerable:!0,get:function(){return f.notificationFilterDisabledClassification}}),Object.defineProperty(e,"notificationFilterMinimumSeverityLevel",{enumerable:!0,get:function(){return f.notificationFilterMinimumSeverityLevel}}),Object.defineProperty(e,"notificationSeverityLevel",{enumerable:!0,get:function(){return f.notificationSeverityLevel}}),Object.defineProperty(e,"Path",{enumerable:!0,get:function(){return f.Path}}),Object.defineProperty(e,"PathSegment",{enumerable:!0,get:function(){return f.PathSegment}}),Object.defineProperty(e,"Plan",{enumerable:!0,get:function(){return f.Plan}}),Object.defineProperty(e,"Point",{enumerable:!0,get:function(){return f.Point}}),Object.defineProperty(e,"ProfiledPlan",{enumerable:!0,get:function(){return f.ProfiledPlan}}),Object.defineProperty(e,"QueryStatistics",{enumerable:!0,get:function(){return f.QueryStatistics}}),Object.defineProperty(e,"Record",{enumerable:!0,get:function(){return f.Record}}),Object.defineProperty(e,"Relationship",{enumerable:!0,get:function(){return f.Relationship}}),Object.defineProperty(e,"Result",{enumerable:!0,get:function(){return f.Result}}),Object.defineProperty(e,"ResultSummary",{enumerable:!0,get:function(){return f.ResultSummary}}),Object.defineProperty(e,"resultTransformers",{enumerable:!0,get:function(){return f.resultTransformers}}),Object.defineProperty(e,"routing",{enumerable:!0,get:function(){return f.routing}}),Object.defineProperty(e,"ServerInfo",{enumerable:!0,get:function(){return f.ServerInfo}}),Object.defineProperty(e,"Session",{enumerable:!0,get:function(){return f.Session}}),Object.defineProperty(e,"Time",{enumerable:!0,get:function(){return f.Time}}),Object.defineProperty(e,"Transaction",{enumerable:!0,get:function(){return f.Transaction}}),Object.defineProperty(e,"TransactionPromise",{enumerable:!0,get:function(){return f.TransactionPromise}}),Object.defineProperty(e,"UnboundRelationship",{enumerable:!0,get:function(){return f.UnboundRelationship}}),Object.defineProperty(e,"clientCertificateProviders",{enumerable:!0,get:function(){return f.clientCertificateProviders}}),lib),r=f.driver.READ,i=f.driver.WRITE,a=f.internal.util,p=a.ENCRYPTION_ON,h=a.assertString,m=a.isEmptyObjectOrNull,b=f.internal.serverAddress.ServerAddress,g=f.internal.urlUtil,y="neo4j-javascript/"+_.default;function s(e,t,r){void 0===r&&(r={}),h(e,"Bolt URL");var o,n,i=g.parseDatabaseUrl(e),a=r,s=!1,u=!1;switch(i.scheme){case"bolt":break;case"bolt+s":u=!0,n="TRUST_SYSTEM_CA_SIGNED_CERTIFICATES";break;case"bolt+ssc":u=!0,n="TRUST_ALL_CERTIFICATES";break;case"neo4j":s=!0;break;case"neo4j+s":n="TRUST_SYSTEM_CA_SIGNED_CERTIFICATES",s=u=!0;break;case"neo4j+ssc":n="TRUST_ALL_CERTIFICATES",s=u=!0;break;default:throw new Error("Unknown scheme: ".concat(null!=(o=i.scheme)?o:"null"))}if(u){if("encrypted"in a||"trust"in a)throw new Error("Encryption/trust can only be configured either through URL or config, not both");a.encrypted=p,a.trust=n,a.clientCertificate=(0,f.resolveCertificateProvider)(r.clientCertificate)}var c="object"==typeof(t=r=t)&&null!=t&&"getToken"in t&&"handleSecurityException"in t&&"function"==typeof t.getToken&&"function"==typeof t.handleSecurityException?r:((t=null!=(t=r)?t:{}).scheme=null!=(r=t.scheme)?r:"none",(0,f.staticAuthTokenManager)({authToken:t})),l=(a.userAgent=null!=(r=a.userAgent)?r:y,a.boltAgent=f.internal.boltAgent.fromVersion(_.default),b.fromUrl(i.hostAndPort)),t={address:l,typename:s?"Routing":"Direct",routing:s};return new f.Driver(t,a,function(){{if(s)return function(e,t,r,o){return new d.RoutingConnectionProvider({id:e,config:t,log:r,hostNameResolver:o,authTokenManager:c,address:l,userAgent:t.userAgent,boltAgent:t.boltAgent,routingContext:i.query})};if(m(i.query))return function(e,t,r){return new d.DirectConnectionProvider({id:e,config:t,log:r,authTokenManager:c,address:l,userAgent:t.userAgent,boltAgent:t.boltAgent})};throw new Error("Parameters are not supported with none routed scheme. Given URL: '".concat(e,"'"))}}())}function u(r,o){return t(this,void 0,void 0,function(){var t;return n(this,function(e){switch(e.label){case 0:t=s(r,{scheme:"none",principal:"",credentials:""},o),e.label=1;case 1:return e.trys.push([1,,3,5]),[4,t.getNegotiatedProtocolVersion()];case 2:return e.sent(),[2,!0];case 3:return[4,t.close()];case 4:return e.sent(),[7];case 5:return[2]}})})}e.driver=s,e.hasReachableServer=u;var a={Node:f.Node,Relationship:f.Relationship,UnboundRelationship:f.UnboundRelationship,PathSegment:f.PathSegment,Path:f.Path,Result:f.Result,EagerResult:f.EagerResult,ResultSummary:f.ResultSummary,Record:f.Record,Point:f.Point,Date:f.Date,DateTime:f.DateTime,Duration:f.Duration,LocalDateTime:f.LocalDateTime,LocalTime:f.LocalTime,Time:f.Time,Integer:f.Integer},r=(e.types=a,{READ:r,WRITE:i}),i=(e.session=r,{toNumber:f.toNumber,toString:f.toString,inSafeRange:f.inSafeRange}),c=(e.integer=i,{isPoint:f.isPoint}),l=(e.spatial=c,{isDuration:f.isDuration,isLocalTime:f.isLocalTime,isTime:f.isTime,isDate:f.isDate,isLocalDateTime:f.isLocalDateTime,isDateTime:f.isDateTime}),v=(e.temporal=l,{isNode:f.isNode,isPath:f.isPath,isPathSegment:f.isPathSegment,isRelationship:f.isRelationship,isUnboundRelationship:f.isUnboundRelationship}),i=(e.graph=v,{authTokenManagers:f.authTokenManagers,driver:s,hasReachableServer:u,int:f.int,isInt:f.isInt,isPoint:f.isPoint,isDuration:f.isDuration,isLocalTime:f.isLocalTime,isTime:f.isTime,isDate:f.isDate,isLocalDateTime:f.isLocalDateTime,isDateTime:f.isDateTime,isNode:f.isNode,isPath:f.isPath,isPathSegment:f.isPathSegment,isRelationship:f.isRelationship,isUnboundRelationship:f.isUnboundRelationship,integer:i,Neo4jError:f.Neo4jError,isRetriableError:f.isRetriableError,auth:f.auth,logging:o.logging,types:a,session:r,routing:f.routing,error:f.error,graph:v,spatial:c,temporal:l,Driver:f.Driver,Result:f.Result,EagerResult:f.EagerResult,Record:f.Record,ResultSummary:f.ResultSummary,Node:f.Node,Relationship:f.Relationship,UnboundRelationship:f.UnboundRelationship,PathSegment:f.PathSegment,Path:f.Path,Integer:f.Integer,Plan:f.Plan,ProfiledPlan:f.ProfiledPlan,QueryStatistics:f.QueryStatistics,Notification:f.Notification,GqlStatusObject:f.GqlStatusObject,ServerInfo:f.ServerInfo,Session:f.Session,Transaction:f.Transaction,ManagedTransaction:f.ManagedTransaction,TransactionPromise:f.TransactionPromise,Point:f.Point,Duration:f.Duration,LocalTime:f.LocalTime,Time:f.Time,Date:f.Date,LocalDateTime:f.LocalDateTime,DateTime:f.DateTime,ConnectionProvider:f.ConnectionProvider,Connection:f.Connection,bookmarkManager:f.bookmarkManager,resultTransformers:f.resultTransformers,notificationCategory:f.notificationCategory,notificationClassification:f.notificationClassification,notificationSeverityLevel:f.notificationSeverityLevel,notificationFilterDisabledCategory:f.notificationFilterDisabledCategory,notificationFilterDisabledClassification:f.notificationFilterDisabledClassification,notificationFilterMinimumSeverityLevel:f.notificationFilterMinimumSeverityLevel,clientCertificateProviders:f.clientCertificateProviders});e.default=i}(lib$2);var index=getDefaultExportFromCjs(lib$2);export{index as default};